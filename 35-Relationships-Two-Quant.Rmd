# (PART) Connection RQs: Regression and Correlation {-}


```{r echo=FALSE}
RD <- structure(list(Age = c(4.4, 4.4, 4.4, 4.4, 4.4, 4.4, 4.4, 4.8, 
4.8, 5.4, 5.4, 5.4, 5.4, 5.4, 5.4, 5.4, 5.4, 5.4, 5.4, 5.4, 5.4, 
5.8, 6.4, 6.4, 6.4, 6.4, 6.4, 6.4, 6.4, 6.4, 6.4, 6.4, 6.4, 7.4, 
7.4, 7.4, 7.4, 7.4, 7.4, 7.4, 7.4, 7.8, 7.8, 8.4, 8.4, 8.4, 8.4, 
8.4, 8.4, 8.4, 8.4, 8.4, 8.4, 8.4, 8.4, 8.4, 9.4, 9.4, 9.4, 9.4, 
9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.8, 10.4, 10.4, 10.4, 10.4, 
11.4, 12.4, 12.8, 13.4, 13.4, 14.4), Weight = c(2.42, 4.45, 5.24, 
3.19, 3.9, 3.26, 3.07, 4.48, 3.18, 3.36, 3.61, 3.71, 3.57, 3.33, 
2.72, 3.64, 2.61, 3.89, 3.3, 2.62, 3.1, 4.03, 3.36, 3.19, 3.32, 
2.78, 3.38, 3.07, 3.22, 3.05, 3.79, 3.15, 2.69, 3.92, 3.07, 2.54, 
3.82, 3.1, 3.56, 2.6, 3.56, 3.8, 3.49, 3.25, 1.84, 2.41, 2.86, 
2.88, 2.35, 2.94, 2.99, 2.76, 2.4, 2.67, 2.97, 2.61, 1.89, 1.8, 
2.62, 1.92, 3.75, 4.6, 2.31, 2.26, 3.48, 2.86, 2.38, 2.82, 1.09, 
2.69, 2.48, 2.72, 2.1, 2.72, 1.71, 2.14, 2.76, 1.57)), .Names = c("Age", 
"Weight"), class = "data.frame", row.names = c(NA, -78L))
```


# Relationships between two quantitative variables {#TwoQuant}

::: {.objectivesBox .objectives data-latex="{iconmonstr-target-4-240.png}"}
So far, you have learnt to ask a RQ, design a study, describe and summarise the data, understand the decision-making process and to work with probabilities.
You have been introduced to the construction of confidence intervals, and to hypothesis testing.
\smallskip

**In this chapter**, you will learn about relationships between two quantitative variables.
You will learn to:

* describe the relationships between two quantitative variables.
:::


```{r echo=FALSE, fig.cap="", fig.align="center", fig.width=3, out.width="35%"}
SixSteps(4, "Connection RQs: Scatterplots")
```


## Introduction: The red deer data {#Chap33-Intro}


`r if (knitr::is_html_output()) '<!--'`
\begin{wrapfigure}{R}{.20\textwidth}
  \begin{center}
    \includegraphics[width=.15\textwidth]{Illustrations/diana-parkhouse-Qf4eZXC3t2Y-unsplash.jpg}
  \end{center}
\end{wrapfigure}
`r if (knitr::is_html_output()) '-->'`


Consider a study [@data:Holgate1965:StraightLine] that examined the relationship between the age of $n = 78$ male red deer and the weight of their
`r if( knitr::is_latex_output() ) {
  'molars (Table \\@ref(tab:deerData)).'
} else {
  'molars; the data are shown below.'
}
`


```{r deerData, echo=FALSE}
if( knitr::is_latex_output() ) {
  knitr::kable( head(RD, 10),
         format = "latex",
         booktabs = TRUE,
         longtable = FALSE,
         col.names = c( "Age (in years)", 
	                      "Molar weight (in g)"),
         caption = "The first 10 observations of the male red deer data") %>%
   row_spec(0, bold=TRUE)
}
```

```{r deerDataDT, echo=FALSE, fig.cap="The male red deer data", fig.align="center"}
if( knitr::is_html_output(exclude = "epub") ) {
  DT::datatable(RD,
              list(scrollX = TRUE, 
	            scrollY = TRUE, 
		          ordering = FALSE),
              caption = "The male red deer data")
}
if( knitr::is_html_output() & knitr::pandoc_to("epub")) {
  knitr::kable( head(RD, 10),
         format = "html",
         booktabs = TRUE,
         longtable = FALSE,
         col.names = c( "Age (in years)", 
	                      "Molar weight (in g)"),
         caption = "The first 10 observations of the male red deer data")
}
```

## Two quantitative variables: Graphical summaries {#RedDeerData}

<div style="float:right; width: 222x; border: 1px; padding:10px">
<img src="Illustrations/diana-parkhouse-Qf4eZXC3t2Y-unsplash.jpg" width="200px"/>
</div>


For the red deer data, both variables are *quantitative*, so the appropriate graphical summary (Sect. \@ref(Scatterplots)) is a *scatterplot* (Fig. \@ref(fig:RedDeerScatter)).

In the graph, the *response* variable is graphed on the *vertical* axis, and denoted $y$; the *explanatory* variable is graphed on the *horizontal* axis,
and denoted $x$.
The *explanatory* variable (potentially) *influences* the response variable, so in this example:

* The *explanatory variable* ($x$) is the age of the deer (in years), and
* The *response variable* ($y$) is the weight of molars (in grams).

In other words, the age of the deer would seem likely to influence the weight of the molars.
(In some cases,  it doesn't matter which is $x$ and which is $y$, such as exploring the relationship between height and weight of red deer.)

Each row in the data set (and each point on the scatterplot) correspond to a single deer (that is, the individual deer are the units of analysis), and two different variables (age; molar weight) are measured on each deer.


```{r RedDeerScatter, echo=FALSE, fig.cap="Molar weight verses age for the red deer data", fig.align="center", fig.width=4.5, fig.height=3.5}
plot(Weight ~ Age, 
     data = RD,
     las = 1,
     pch = 19, 
     ylim = c(0, 5.5),
     xlim = c(4, 15),
     cex = 0.8,
     xlab = "Age (in years)",
     ylab = "Molar weight (in g)")
```


## Understanding scatterplots {#UnderstandingScatterplots}

The purpose of a graph is to help us *understand* the data  (Sect. \@ref(GraphsIntro)).
To understand the data displayed in a scatterplot, the *form*, *direction*, and *variation* (or the *strength*) are described:

1. *Form*: Identify the overall *form* or structure of the relationship (e.g., linear; curved upwards; etc.).
2. *Direction*: Identify the *direction* of the relationship (sometimes not relevant if the relationship is non-linear):
    - The variables are *positively* associated if high values of one variable accompany *high* values of the other variable, in general.
    - The variables are *negatively* associated if high values of one variable accompany *low* values of the other variable, in general.
3. *Variation*: The amount of *variation* in the relationship.
   A small amount of variation in the response variable for given values of the explanatory variable means the relationship is strong; a lot of variation in the response variable for given values of the explanatory variable means the relationship is less strong.

Anything unusual or noteworthy should also be discussed.
These three features help us understand the type of relationship (*form* and *direction*), and the strength of that relationship (*variation*).

To demonstrate the use of these descriptions, see the example scatterplots in
`r if (knitr::is_html_output()) {
  'the carousel below (click to move through the scatterplots).'
} else {
  'Fig. \\@ref(fig:ScatterplotDescriptionExamples). (The online version has extra examples.)'
}`


```{r, child = if (knitr::is_html_output(exclude = "epub")) './children/ScatterExampleCarousel.Rmd'}
```


```{r, child = if (knitr::is_latex_output()) './children/ScatterExampleImages.Rmd'}
```


```{r, child = if (knitr::is_latex_output() & knitr::pandoc_to("epub")) './children/ScatterExampleImages.Rmd'}
```


::: {.example #DescribeScatterplots name="Describing scatterplots"}
A study [@data:Tager:FEV; @BIB:data:FEV] examined the lung capacity of children in Boston (measured using the forced expiratory volume (FEV)).
The scatterplot (Fig. \@ref(fig:FEVscatter)) could be described as curved (*form*), where older children have larger FEVs, in general (*direction*).
The *variation* gets larger for taller youth. 
:::


```{r FEVscatter, echo=FALSE, fig.cap="FEV plotted against height for children in Boston", fig.align="center", fig.width=5, fig.height=6.5}
data(lungcap)

par(mfrow = c(2, 1))


plot(FEV ~ Ht, 
     data = lungcap,
     las = 1,
     ylim = c(0, 6),
     cex = 0.7,
     xlab = "Height (inches)",
     ylab = "FEV (litres)",
     pch = 19)

scatter.smooth( lungcap$Ht, lungcap$FEV,
     las = 1,
     ylim = c(0, 6),
     cex = 0.7,
     col = "grey",
     lwd = 2,
     xlab = "Height (inches)",
     ylab = "FEV (litres)",
     pch = 19)
```


::: {.thinkBox .think data-latex="{iconmonstr-light-bulb-2-240.png}"}
Describe the scatterplot of *diastolic* BP against age (Fig. \@ref(fig:NHANESscatterDBPAge)), from the NHANES data.

`r if (knitr::is_latex_output()) '<!--'`
`r webexercises::hide()`
**Form**: curved. 

**Direction**: not relevant (up, then down). 

**Variation**: large.
`r webexercises::unhide()`
`r if (knitr::is_latex_output()) '-->'`
:::


```{r NHANESscatterDBPAge, echo=FALSE, fig.cap="Diastolic blood pressure plotted against age for the NHANES data", fig.align="center", fig.width=5, fig.height=4}
# Replace 0 DBP with NA
NHANES$BPDia1[ NHANES$BPDia1 == 0 ] <- NA

plot(BPDia1 ~ Age,
	las = 1,
	xlab = "Age (in years)",
	ylab = "Diastolic BP (mm Hg)", 
  cex = 0.5,
	ylim = c(0, 120),
	data = NHANES)
```

::: {.example #DescribeScatterplotsDeer name="Scatterplots"}
For the red deer data (Fig. \@ref(fig:RedDeerScatter)), the scatterplot could be described as approximately linear (form), with a negative direction (*older* deer generally have *less heavy* teeth); the *variation* is... perhaps moderate.
:::


<iframe src="https://learningapps.org/watch?v=pdxmdaf1522" style="border:0px;width:100%;height:500px" allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true"></iframe>



## Summary {#Chap33-Summary}

A **scatterplot** is used to show the relationship between two quantitative variables (the response denoted $y$; the explanatory denoted $x$).
The relationship can be described by the **form** (linear, or otherwise), the **direction** of the relationship (sometimes not relevant if the graph is not linear), and the **variation** in the relationship (or the **strength** of the relationship).


## Quick review questions {#Chap33-QuickReview}

A study of onion growth [@meadplant] produced the scatterplot shown in Fig. \@ref(fig:MeanScatter).


```{r MeanScatter, echo=FALSE, fig.cap="Onion yield plotted against planting density", fig.align="center", fig.width=5, fig.height=4}
data(yieldden)

plot(Yield ~ Dens,
	las = 1,
	xlab = "Planting density (plants/sq. ft)",
	ylab = "Yield/plant (g/plant)", 
  pch = 19,
	ylim = c(20, 140),
	data = yieldden)
```

1. The $x$-variable is
`r if( knitr::is_html_output(exclude = "epub") ) {longmcq( c(
  answer = "Planting density",
  "Yield per plant",
  "It doesn't matter"
) )} else {"________________"}`

1. The *form* is best described as
`r if( knitr::is_html_output(exclude = "epub") ) {longmcq( c(
  "Linear",
  answer = "Curved"
) )} else {"________________"}`
1. The *direction* is best described as
`r if( knitr::is_html_output(exclude = "epub") ) {longmcq( c(
  answer = "Negative",
  "Positive"
) )} else {"________________"}`
1. The *variation* is best described as
`r if( knitr::is_html_output(exclude = "epub") ) {longmcq( c(
  answer = "Small",
  "Large",
  "Strong"
) )} else {"________________"}`



`r if (!knitr::is_html_output()) '<!--'`
::: {.progressBox .progress}
**Progress:**  `r webexercises::total_correct()`
:::
`r if (!knitr::is_html_output()) '-->'`



## Exercises {#TwoQuantExercises}

Selected answers are available in Sect. \@ref(TwoQuantAnswer).


::: {.exercise #TwoQuantExercisesSheepFood}
A study evaluated various food mixtures for sheep [@data:Moir1961:RuminantDiet].
Describe the scatterplot (Fig. \@ref(fig:SheepScatter)) in terms of the *form* of the relationship, the *direction* of the relationship (if relevant), and the *variation* in the relationship.
:::


```{r SheepScatter, echo=FALSE, fig.cap="Scatterplots for the sheep-food data", fig.align="center", fig.width=5, fig.height=3.5}

data(ruminant)

plot(Energy ~ DryMatterDigest, 
     data = ruminant,
     las = 1,
     xlim = c(30, 80),
     ylim = c(1, 3.5),
     xlab = "Dry matter digestibility (%)",
     ylab = "Digestible energy (in Cal/gram)",
     pch = 19)
abline( lm( Energy ~ DryMatterDigest, 
            data = ruminant), 
        lwd = 2, 
	col = "grey")
```



::: {.exercise #TwoQuantExercisesWindmill}
A study examined the direct current generated by a windmill and its association with wind speed [@data:hand:handbook; @data:joglekar:lackoffit].
Describe the relationship (Fig. \@ref(fig:WindmillPlot)).
:::


```{r WindmillPlot, echo=FALSE, fig.cap="The relationship between DC output and wind speed", fig.align="center", fig.width=5, fig.height=3.5}
data(windmill)

plot(DC ~ Wind, 
     data = windmill,
     xlab = "Wind speed (in miles per hour)",
     ylab = "DC output",
     las = 1,
     xlim = c(2, 10),
     ylim = c(0, 2.5),
     pch = 19)
```

::: {.exercise #TwoQuantExercisesMandible}
A study examined the mandible length and gestational age for 167 foetuses from the 12th week of gestation onward [@data:royston:mandible].
How would you describe the relationship (Fig. \@ref(fig:MandiblePlot))?
:::



```{r MandiblePlot, echo=FALSE, fig.cap="The relationship between gestational age and mandible length", fig.align="center", fig.width=5, fig.height=3.5}
data(mandible)

plot(Length ~ Age, 
     data = mandible,
     xlab = "Gestational age (in weeks)",
     ylab = "Mandible length (in mm)",
     xlim = c(10, 40),
     ylim = c(0, 50),
     las = 1,
     pch = 19)
abline(coef(lm(Length ~ Age, 
            data = mandible)), 
       col = "grey")
```



::: {.exercise #TwoQuantExercisesSoftdrink}
A study examined the time taken to deliver soft drinks to vending machines [@others:Montgomery:regressionanalysis].
How would you describe the relationship (Fig. \@ref(fig:SoftdrinkPlot))?
:::


```{r SoftdrinkPlot, echo=FALSE, fig.cap="The time taken to deliver soft drinks to vending machines", fig.align="center", fig.width=5, fig.height=3.5}
data(sdrink)

plot(Time ~ Cases, 
     data = sdrink,
     xlab = "Number of cases of product stocked",
     ylab = "Time to service\nmachine (mins)",
     xlim = c(0, 30),
     ylim = c(0, 80),
     las = 1,
     pch = 19)
abline(coef(lm(Time ~ Cases, 
               data = sdrink)), 
       col = "grey")
```




<!-- QUICK REVIEW ANSWERS -->
`r if (knitr::is_html_output()) '<!--'`
::: {.QRanswerBox .QRanswer data-latex="{iconmonstr-check-mark-14-240.png}"}
\textbf{Answers to \textit{Quick Revision} questions:}
**1.** Planting density.
**2.** Curved.
**3.** Negative.
**4.** Small.
:::
`r if (knitr::is_html_output()) '-->'`

