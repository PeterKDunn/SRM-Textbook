# (PART) Connection RQs: regression and correlation {-}

# Relationships between two quantitative variables {#TwoQuant}


<!-- Introductions; easier to separate by format -->
```{r, child = if (knitr::is_html_output()) {'./introductions/35-Relationships-Two-Quant-HTML.Rmd'} else {'./introductions/35-Relationships-Two-Quant-LaTeX.Rmd'}}
```


```{r echo=FALSE}
RD <- read.csv("Data/RedDeer.csv")
```


## Introduction: red deer {#Chap33-Intro}

One study [@data:Holgate1965:StraightLine] examined the relationship between the age of $n = 78$ male red deer and the weight of their
`r if( knitr::is_latex_output() ) {
  'molars (Table \\@ref(tab:deerData)).'
} else {
  'molars; the data are shown below.'
}
`


<!-- ```{r deerData, echo=FALSE} -->
<!-- if( knitr::is_latex_output() ) { -->
<!--   knitr::kable( head(RD, 10), -->
<!--          format = "latex", -->
<!--          booktabs = TRUE, -->
<!--          longtable = FALSE, -->
<!--          col.names = c( "Age (in years)",  -->
<!-- 	                      "Molar weight (in g)"), -->
<!--          caption = "The first 10 observations of the male red deer data") %>% -->
<!--    row_spec(0, bold=TRUE) -->
<!-- } -->
<!-- ``` -->

```{r deerDataDT, echo=FALSE, fig.cap="The male red deer data", fig.align="center"}
if( knitr::is_html_output(exclude = "epub") ) {
  DT::datatable(RD,
              list(scrollX = TRUE, 
	            scrollY = TRUE, 
		          ordering = FALSE),
              caption = "The male red deer data")
}
if( knitr::is_html_output() & knitr::pandoc_to("epub")) {
  knitr::kable( head(RD, 10),
         format = "html",
         booktabs = TRUE,
         longtable = FALSE,
         col.names = c( "Age (in years)", 
	                      "Molar weight (in g)"),
         caption = "The first 10 observations of the male red deer data")
}
```







\begin{figure}
\begin{minipage}{0.32\textwidth}
\captionof{table}{The first 10 observations of the male red deer data\label{tab:deerData}}
```{r deerData, echo=FALSE}
knitr::kable( head(RD, 10),
         format = "latex",
         booktabs = TRUE,
         longtable = FALSE,
         table.env = "@empty",
         col.names = c( "Age (in years)", 
	                      "Molar weight (in g)")) %>%
#         caption = "The first 10 observations of the male red deer data") %>%
   row_spec(0, bold = TRUE) %>%
   #kable_styling(font_size = 10) %>% # CANNOT USE THIS IS THE MINIPAGE
   column_spec(1, width = "13mm") %>%
   column_spec(2, width = "22mm")
```
\end{minipage}
\hspace{0.05\textwidth}
\begin{minipage}{0.60\textwidth}%
\centering
```{r RedDeerScatter, echo=FALSE, fig.width=5.5, out.width='95%'}
plot(Weight ~ Age, 
     data = RD,
     las = 1,
     pch = 19, 
     ylim = c(0, 5.5),
     xlim = c(4, 15),
     cex = 0.8,
     xlab = "Age (in years)",
     ylab = "Molar weight (in g)")
```
\caption{Molar weight verses age for the red deer data}\label{fig:RedDeerScatter}
\end{minipage}
\end{figure}


## Two quantitative variables: graphical summaries {#RedDeerData}

<div style="float:right; width: 222x; border: 1px; padding:10px">
<img src="Illustrations/diana-parkhouse-Qf4eZXC3t2Y-unsplash.jpg" width="200px"/>
</div>


For the red deer data, both variables are *quantitative*, so the appropriate graphical summary (Sect. \@ref(Scatterplots)) is a *scatterplot* 
`r if( knitr::is_latex_output() ) {
  '(Fig. \\@ref(fig:RedDeerScatter)).'
} else {
  '(Fig. \\@ref(fig:RedDeerScatterHTML)).'
}
`
The *response* variable is graphed on the *vertical* axis, and denoted $y$; the *explanatory* variable is graphed on the *horizontal* axis,
and denoted $x$.
The *explanatory* variable (potentially) *influences* the response variable, so in this example:

* The *explanatory variable* ($x$) is the age of the deer (in years), and
* The *response variable* ($y$) is the weight of molars (in grams).

In other words, the age of the deer would seem likely to influence the weight of the molars.
(In some cases,  it doesn't matter which is $x$ and which is $y$, such as exploring the relationship between height and weight of red deer; for example, see Example \@ref(exm:CorTestDogs).)

Each row in the dataset (and each point on the scatterplot) corresponds to a single deer (the units of analysis); two variables (age; molar weight) are measured on each deer.


<!-- The figure for LaTeX is in the minipage (combined with data table), so only need show it for the HTML -->
`r if (knitr::is_latex_output()) '<!--'`
```{r RedDeerScatterHTML, echo=FALSE, fig.cap="Molar weight verses age for the red deer data", fig.align="center", fig.width=4.5, fig.height=3.5}
plot(Weight ~ Age,
     data = RD,
     las = 1,
     pch = 19,
     ylim = c(0, 5.5),
     xlim = c(4, 15),
     cex = 0.8,
     xlab = "Age (in years)",
     ylab = "Molar weight (in g)")
```
`r if (knitr::is_latex_output()) '-->'`


## Understanding scatterplots {#UnderstandingScatterplots}

The purpose of a graph is to help us *understand* the data  (Sect. \@ref(GraphsIntro)).
For a scatterplot, the *form*, *direction*, and *variation* (or the *strength*) are described:

1. *Form*: The overall *form* or structure of the relationship (e.g., linear; curved upwards; etc.).
2. *Direction*: The *direction* of the relationship (sometimes not relevant if the relationship is non-linear):
    - The variables are *positively* associated if high values of one variable accompany *high* values of the other variable, in general.
    - The variables are *negatively* associated if high values of one variable accompany *low* values of the other variable, in general.
3. *Variation*: The amount of *variation* in the relationship.
   A small amount of variation in the response variable for given values of the explanatory variable means the relationship is strong; a lot of variation in the response variable for given values of the explanatory variable means the relationship is less strong.

Anything unusual or noteworthy should also be discussed.
These three features explain the type of relationship (*form* and *direction*), and the strength of that relationship (*variation*).
Examples are shown in
`r if (knitr::is_html_output()) {
  'the carousel below (click to move through the scatterplots).'
} else {
  'Fig. \\@ref(fig:ScatterplotDescriptionExamples). (The online version has extra examples.)'
}`


```{r, child = if (knitr::is_html_output(exclude = "epub")) './children/ScatterExampleCarousel.Rmd'}
```


```{r, child = if (knitr::is_latex_output()) './children/ScatterExampleImages.Rmd'}
```


```{r, child = if (knitr::is_latex_output() & knitr::pandoc_to("epub")) './children/ScatterExampleImages.Rmd'}
```


::: {.example #DescribeScatterplots name="Describing scatterplots"}
A study [@data:Tager:FEV; @BIB:data:FEV] measured the lung capacity of children in Boston (using the forced expiratory volume (FEV)).
The scatterplot (Fig. \@ref(fig:FEVscatter)) is curved (*form*), where older children have larger FEVs, in general (*direction*).
The *variation* gets larger for taller youth. 
:::


```{r FEVscatter, echo=FALSE, fig.cap="FEV plotted against height for children in Boston", fig.align="center", fig.width=8, fig.height=3.25, out.width='90%'}
data(lungcap)

par(mfrow = c(1, 2))

plot(FEV ~ Ht, 
     data = lungcap,
     las = 1,
     ylim = c(0, 6),
     cex = 0.7,
     xlab = "Height (inches)",
     ylab = "FEV (litres)",
     pch = 19)

scatter.smooth( lungcap$Ht, lungcap$FEV,
     las = 1,
     ylim = c(0, 6),
     cex = 0.7,
     col = "grey",
     lwd = 2,
     xlab = "Height (inches)",
     ylab = "FEV (litres)",
     pch = 19)
```


::: {.thinkBox .think data-latex="{iconmonstr-light-bulb-2-240.png}"}
Describe the scatterplot of *diastolic* BP against age (Fig. \@ref(fig:NHANESscatterDBPAge)), from the NHANES data.\label{thinkBox:DescribeScatterNHANES}

`r if (knitr::is_latex_output()) '<!--'`
`r webexercises::hide()`
* **Form**: curved. 
* **Direction**: not relevant (up, then down). 
* **Variation**: large.
`r webexercises::unhide()`
`r if (knitr::is_latex_output()) '-->'`
:::


```{r NHANESscatterDBPAge, echo=FALSE, fig.cap="Diastolic blood pressure plotted against age for the NHANES data", fig.align="center", fig.width=5, fig.height=4}
# Replace 0 DBP with NA
NHANES$BPDia1[ NHANES$BPDia1 == 0 ] <- NA

plot(BPDia1 ~ Age,
	las = 1,
	xlab = "Age (in years)",
	ylab = "Diastolic BP (mm Hg)", 
  cex = 0.5,
	ylim = c(0, 120),
	data = NHANES)
```

::: {.example #DescribeScatterplotsDeer name="Scatterplots"}
For the red deer data (Fig. \@ref(fig:RedDeerScatter)), the relationship is approximately linear (form) with a negative direction (*older* deer generally have *lighter* teeth); the *variation* is... perhaps moderate.
:::


<iframe src="https://learningapps.org/watch?v=pdxmdaf1522" style="border:0px;width:100%;height:500px" allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true"></iframe>



## Summary {#Chap33-Summary}

A *scatterplot* displays the relationship between two quantitative variables (the response denoted $y$; the explanatory denoted $x$).
The relationship is described by the *form* (linear, or otherwise), the *direction* of the relationship (sometimes not relevant if the graph is not linear), and the *variation* in the relationship (or the *strength* of the relationship).


## Quick review questions {#Chap33-QuickReview}

::: {.webex-check .webex-box}
A study of onion growth [@meadplant] produced the scatterplot shown in Fig. \@ref(fig:MeanScatter).


```{r MeanScatter, echo=FALSE, fig.cap="Onion yield plotted against planting density", fig.align="center", fig.width=5, fig.height=4}
data(yieldden)

plot(Yield ~ Dens,
	las = 1,
	xlab = "Planting density (plants/sq. ft)",
	ylab = "Yield/plant (g/plant)", 
  pch = 19,
	ylim = c(20, 140),
	data = yieldden)
```

1. The $x$-variable is
`r if( knitr::is_html_output(exclude = "epub") ) {longmcq( c(
  answer = "Planting density",
  "Yield per plant",
  "It doesn't matter"
) )} else {"________________"}`

1. The *form* is best described as
`r if( knitr::is_html_output(exclude = "epub") ) {longmcq( c(
  "Linear",
  answer = "Curved"
) )} else {"________________"}`
1. The *direction* is best described as
`r if( knitr::is_html_output(exclude = "epub") ) {longmcq( c(
  answer = "Negative",
  "Positive"
) )} else {"________________"}`
1. The *variation* is best described as
`r if( knitr::is_html_output(exclude = "epub") ) {longmcq( c(
  answer = "Small",
  "Large",
  "Strong"
) )} else {"________________"}`
:::




## Exercises {#TwoQuantExercises}

Selected answers are available in Sect. \@ref(TwoQuantAnswer).


::: {.exercise #TwoQuantExercisesSheepFood}
A study evaluated various food mixtures for sheep [@data:Moir1961:RuminantDiet].
Describe the scatterplot (Fig. \@ref(fig:SheepScatter)) in terms of the *form*, *direction* and *variation* in the relationship.
:::


```{r SheepScatter, echo=FALSE, fig.cap="Scatterplots for the sheep-food data", fig.align="center", fig.width=5, fig.height=3.5}
data(ruminant)

plot(Energy ~ DryMatterDigest, 
     data = ruminant,
     las = 1,
     xlim = c(30, 80),
     ylim = c(1, 3.5),
     xlab = "Dry matter digestibility (%)",
     ylab = "Digestible energy (in Cal/gram)",
     pch = 19)
abline( lm( Energy ~ DryMatterDigest, 
            data = ruminant), 
        lwd = 2, 
	col = "grey")
```



::: {.exercise #TwoQuantExercisesWindmill}
A study examined the relationship between direct current generated by a windmill and wind speed [@data:hand:handbook; @data:joglekar:lackoffit].
Describe the relationship (Fig. \@ref(fig:WindmillPlot)).
:::


```{r WindmillPlot, echo=FALSE, fig.cap="The relationship between DC output and wind speed", fig.align="center", fig.width=5, fig.height=3.5}
data(windmill)

plot(DC ~ Wind, 
     data = windmill,
     xlab = "Wind speed (in miles per hour)",
     ylab = "DC output",
     las = 1,
     xlim = c(2, 10),
     ylim = c(0, 2.5),
     pch = 19)
```

::: {.exercise #TwoQuantExercisesMandible}
A study examined the mandible length and gestational age for 167 foetuses from the 12th week of gestation onward [@data:royston:mandible].
Describe the relationship (Fig. \@ref(fig:MandiblePlot)).
:::



```{r MandiblePlot, echo=FALSE, fig.cap="The relationship between gestational age and mandible length", fig.align="center", fig.width=5, fig.height=3.5}
data(mandible)

plot(Length ~ Age, 
     data = mandible,
     xlab = "Gestational age (in weeks)",
     ylab = "Mandible length (in mm)",
     xlim = c(10, 40),
     ylim = c(0, 50),
     las = 1,
     pch = 19)
abline(coef(lm(Length ~ Age, 
            data = mandible)), 
       col = "grey")
```



::: {.exercise #TwoQuantExercisesSoftdrink}
A study examined the time taken to deliver soft drinks to vending machines [@others:Montgomery:regressionanalysis].
Describe the relationship (Fig. \@ref(fig:SoftdrinkPlot)).
:::


```{r SoftdrinkPlot, echo=FALSE, fig.cap="The time taken to deliver soft drinks to vending machines", fig.align="center", fig.width=5, fig.height=3.5}
data(sdrink)

plot(Time ~ Cases, 
     data = sdrink,
     xlab = "Number of cases of product stocked",
     ylab = "Time to service\nmachine (mins)",
     xlim = c(0, 30),
     ylim = c(0, 80),
     las = 1,
     pch = 19)
abline(coef(lm(Time ~ Cases, 
               data = sdrink)), 
       col = "grey")
```




<!-- QUICK REVIEW ANSWERS -->
`r if (knitr::is_html_output()) '<!--'`
::: {.EOCanswerBox .EOCanswer data-latex="{iconmonstr-check-mark-14-240.png}"}
**Answers to in-chapter questions:**

- Sect. \ref{thinkBox:DescribeScatterNHANES}: *Form*: curved. *Direction*: not relevant (up, then down). *Variation*: large.
- \textbf{Answers to \textit{Quick Revision} questions:}
**1.** Planting density.
**2.** Curved.
**3.** Negative.
**4.** Small.
:::
`r if (knitr::is_html_output()) '-->'`

