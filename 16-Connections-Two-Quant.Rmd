
# Correlations between quantitative variables {#TwoQuant}
\index{Quantitative data!correlation}



<!-- Introductions; easier to separate by format -->
```{r, child = if (knitr::is_html_output())  {'./introductions/16-Connections-TwoQuant-HTML.Rmd'} else {'./introductions/16-Connections-TwoQuant-LaTeX.Rmd'}}
```


<!-- Define colours as appropriate -->
```{r, child = if (knitr::is_html_output()) {'./children/coloursHTML.Rmd'} else {'./children/coloursLaTeX.Rmd'}}
```



## Introduction {#TwoQuant-Intro}

So far, RQs about single variables and RQs for comparing two groups have been studied.
In this chapter, the relationship between two quantitative variables is studied; that is, correlational RQs.\index{Research question!correlational}


## Graphs {#Scatterplots}
\index{Quantitative data!correlation!graphs}\index{Scatterplot}\index{Graphs!scatterplot}


<div style="float:right; width: 222x; border: 1px; padding:10px">
<img src="Illustrations/diana-parkhouse-Qf4eZXC3t2Y-unsplash.jpg" width="200px"/>
</div>


Scatterplots display the relationship between *two quantitative variables*.
Conventionally, and when appropriate, the response variable is shown on the vertical axis (and denoted $y$), and the explanatory variable is shown on the horizontal axis (and denoted $x$).\index{Variables!response}\index{Variables!explanatory}
Two quantitative variables are measured on each individual, and a point is placed on the scatterplot for each individual at the values of the two variables.
In some cases, a relationship is explored, but which variable is denoted $x$ and which is $y$ is not important (e.g., see Exercise \@ref(exr:CorTestDogs).)

As with any graph, describing the message in the graph is important, because the purpose of a graph is to display the information in the clearest, simplest possible way.


:::{.example #RedDeer name="Red-deer data"}
@data:Holgate1965:StraightLine examined the relationship between the age of $n = 78$ male red deer and the weight of their molars.
The data 
`r if( knitr::is_latex_output() ) {
  '(Table\\ \\@ref(tab:RedDeerData))'
} else {
  '(below)'
}`
comprises two *quantitative* variables, and both measurements are made on the same individuals (i.e., male red deer).

The scatterplot (Fig.\ \@ref(fig:RedDeerScatter)) shows one dot for each deer (individual).
The response variable is the molar weight, which is on the vertical axis and denoted $y$.
The explanatory variable is the deer age, which is on the horizontal axis and denoted $x$.

For instance, one deer is just over $4$ years of age (so $x$ has a value a bit larger than $4$), and has a molar weight of $2.42$\ g (so that $y = 2.42$).
This is the first deer listed in 
`r if( knitr::is_latex_output() ) {
  'Table\\ \\@ref(tab:RedDeerData).'
} else {
  'the data above.'
}`
:::


```{r}
data(RedDeer)

RDhead <- as.matrix( head(RedDeer, 5) )
RDtail <- as.matrix( tail(RedDeer, 5) )

if( knitr::is_latex_output()){
T1 <- knitr::kable( pad(RDhead,
                  surroundMaths = TRUE,
                  targetLength = 4,
                  digits = c(1, 2)),
         format = "latex",
         booktabs = TRUE,
         longtable = FALSE,
         escape = FALSE,
         align = "c",
         linesep = "", # With the \vdots, spacing doesn't seem necessary
         col.names = c( "(in years)", 
	                      "(in g)")) %>%
   row_spec(0, bold = TRUE) %>%
  add_header_above( c("Age" = 1,
                      "Molar weight" = 1),
                    bold = TRUE,
                    line = FALSE)

T2 <- knitr::kable( pad(RDtail,
                  surroundMaths = TRUE,
                  targetLength = 4,
                  digits = c(1, 2)),
         format = "latex",
         booktabs = TRUE,
         longtable = FALSE,
         escape = FALSE,
         align = "c",
         row.names = FALSE,
         linesep = "", # With the \vdots, spacing doesn't seem necessary
         col.names = c( "(in years)", 
	                      "(in g)")) %>%
   row_spec(0, bold = TRUE) %>%
  add_header_above( c("Age" = 1,
                      "Molar weight" = 1),
                    bold = TRUE,
                    line = FALSE)

  out <- knitr::kables(list(T1, T2), 
                       format = "latex",
                       label = "RedDeerData",
                       caption = "Molar weight and age\nof male red deer: the first five and the last five observations are shown.") %>% 
    kable_styling(font_size = 8)
  prepareSideBySideTable(out,
                         gap = "\\qquad")
}
```

```{r deerDataDT, fig.cap="The male red deer data.", fig.align="center"}
data(RedDeer)

if( knitr::is_html_output() ) {
  DT::datatable(RedDeer,
              list(scrollX = TRUE, 
	            scrollY = TRUE, 
		          ordering = FALSE),
              caption = "The male red deer data.")
}
```


(ref:RedDeerPlotIndicate) `r if( knitr::is_latex_output() ) {'A plot of the red-deer data. The indicated point is the first observation in Table\\ \\@ref(tab:RedDeerData).'} else {  'A plot of the red-deer data. The indicated point is the first observation in Fig.\\ \\@ref(fig:deerDataDT).'}`


```{r RedDeerScatter, fig.width=6.5, out.width='70%', fig.height=4, fig.cap="(ref:RedDeerPlotIndicate)", fig.align="center"}
data(RedDeer)

plot(Weight ~ Age, 
     data = RedDeer,
     las = 1,
     pch = 19, 
     ylim = c(0, 5.5),
     xlim = c(4, 15),
     cex = 0.8,
     main = "Molar weight and age\nof male red deer",
     xlab = "Age (in years)",
     ylab = "Molar weight (in g)")

# Highlight point

arrows(x0 = RedDeer$Age[1],
       x1 = RedDeer$Age[1],
       y0 = RedDeer$Weight[1] - 0.2,
       y1 = 0,
       lwd = 2,
       angle = 15,
       length = 0.1,
       col = "grey")
arrows(x0 = RedDeer$Age[1] - 0.2,
       x1 = 3.65,
       y0 = RedDeer$Weight[1],
       y1 = RedDeer$Weight[1],
       lwd = 2,
       angle = 15,
       length = 0.1,
       col = "grey")
```


## Describing scatterplots {#UnderstandingScatterplots}
\index{Scatterplot}

The purpose of a graph is to facilitate *understanding* of the data.
For a scatterplot, the *form*, *direction*, and *variation in the relationship* (or the *strength of the relationship*) are described:

1. *Form*: The overall *form* or structure of the relationship (e.g., linear; curved upwards; etc.).\index{Scatterplot!form}
2. *Direction*: The *direction* of the relationship (sometimes not relevant if the relationship is non-linear):\index{Scatterplot!direction}
    - A *positive* association exists if *high* values of one variable accompany *high* values of the other variable, in general.
    - A *negative* association exists if *high* values of one variable accompany *low* values of the other variable, in general.
3. *Variation*: The amount of *variation* in the relationship.\index{Scatterplot!variation}\index{Scatterplot!strength}
   A small amount of variation in the response variable for given values of the explanatory variable means the relationship is strong; a lot of variation in the response variable for given values of the explanatory variable means the relationship is less strong.
   Describing the variation can be difficult; an objective, numerical way to do so is explained in Sect.\ \@ref(CorrelationR2).

Anything unusual or noteworthy should also be discussed.
These features explain the *type* of relationship (*form*; *direction*), and the *strength* of that relationship (*variation*).
Examples are shown in
`r if (knitr::is_html_output()) {
  'the carousel below (click to move through the scatterplots).'
} else {
  'Fig.\\ \\@ref(fig:ScatterplotDescriptionExamples).'
}`


```{r, child = if (knitr::is_html_output())  'children/ScatterExampleCarousel.Rmd'}
```

```{r, child = if (knitr::is_latex_output()) 'children/ScatterExampleImages.Rmd'} 
```


::: {.example #DescribeScatterplotsDeer name="Scatterplots"}
For the red deer data 
`r if (knitr::is_latex_output()) {
   '(Fig.\\ \\@ref(fig:RedDeerScatter)),'
} else {
   '(Fig\\. \\@ref(fig:RedDeerScatter)),'
}`
the relationship is approximately linear (form) with a negative direction (*older* deer generally have *lighter* teeth); the *variation* is... perhaps moderate.
:::



::: {.example #DescribeScatterplots name="Describing scatterplots"}
A study [@data:Tager:FEV; @BIB:data:FEV] measured the lung capacity of children in Boston (using forced expiratory volume, FEV, in litres).
The scatterplot (Fig.\ \@ref(fig:FEVscatter)) is curved (*form*), where older children have larger FEVs, in general (*direction*).
The *variation* in FEV gets larger for taller youth. 
:::


```{r FEVscatter, fig.cap="FEV plotted against height for children in Boston.", fig.align="center", fig.width=7.5, fig.height=3.25, out.width='100%'}
data(LungCap)

par(mfrow = c(1, 3))

# 

plot(FEV ~ Ht, 
     data = LungCap,
     las = 1,
     ylim = c(0, 6),
     cex = 0.7,
     main = "FEV and height",
     xlab = "Height (inches)",
     ylab = "FEV (litres)",
     pch = 19)

#

plot(FEV ~ Ht, 
     data = LungCap,
     las = 1,
     ylim = c(0, 6),
     cex = 0.7,
     main = "FEV and height: Linear\nrelationship inappropriate",
     xlab = "Height (inches)",
     ylab = "FEV (litres)",
     col = "grey",
     pch = 19)
abline( coef( lm( FEV ~ Ht,
                  data = LungCap)
              ),
        lwd = 2)

#

scatter.smooth( LungCap$Ht, LungCap$FEV,
     las = 1,
     ylim = c(0, 6),
     cex = 0.7,
     col = "grey",
     lwd = 2,
     main = "FEV and height: Non-linear\nand variation increasing",
     xlab = "Height (inches)",
     ylab = "FEV (litres)",
     pch = 19)

arrows(x0 = 50,
       x1 = 50,
       y0 = 0.8,
       y1 = 2.2,
       angle = 15,
       length = 0.11,
       lwd = 2,
       code = 3)
text(x = 50,
     y = 2.2,
     pos = 3,
     cex = 0.85,
     labels = "Smaller\nvariation")

arrows(x0 = 70,
       x1 = 70,
       y0 = 2,
       y1 = 5.8,
       angle = 15,
       length = 0.11,
       lwd = 2,
       code = 3)
text(x = 70,
     y = 1.8,
     pos = 1,
     cex = 0.85,
     labels = "Larger\nvariation")
```



## Summarising the relationship: correlation and $R^2$ {#CorrelationR2}

### Correlation coefficients {#CorrCoefficients}
\index{Scatterplot!form}\index{Correlation}\index{Correlation coefficient (Pearson)}

In general, summarising the relationship between two quantitative variables is difficult, because the possible relationships vary greatly
 (consider 
`r if (knitr::is_html_output()) {
  'the variety in the scatterplots shown in the carousel above).'
} else {
  'the variety in the scatterplots shown in Fig.\\ \\@ref(fig:ScatterplotDescriptionExamples)).'
}`
However, if we focus only on approximately *linear* relationships, the best way to numerically summarise the relationship between the variables is to use a *correlation coefficient*.
Each variable can also be numerically summarised individually.


::: {.definition #CorrelationCoefficient name="Correlation coefficient"}
The Pearson correlation coefficient measures the *strength* and *direction* of the *linear* relationship between two quantitative variables.
Its value is always between $-1$ and $1$.
:::


Pearson correlation coefficients only apply if the form is approximately *linear*, so checking the scatterplot first is important.
All correlations in this book are Pearson correlation coefficients.
Only the *Pearson* correlation coefficient is discussed here, but other correlation coefficients also exist (such as the *Spearman* correlation coefficient\index{Correlation coefficient!Spearman} or *Kendall* correlation coefficient\index{Correlation coefficient!Kendall}, which may be used for increasing-only or decreasing-only *non-linear* relationships).


::: {.importantBox .important data-latex="{iconmonstr-warning-8-240.png}"}
The Pearson correlation coefficient only makes sense if the relationship is approximately linear.
:::


In the *population*, the unknown value of the correlation coefficient is denoted $\rho$ ('rho'); in the *sample*, the value of the correlation coefficient is denoted $r$.
As usual, $r$ (the *statistic*) is an estimate of $\rho$ (the *parameter*), and the value of $r$ is likely to be different in every sample (that is, *sampling variation* exists).


:::: {.pronounceBox .pronounce data-latex="{iconmonstr-microphone-7-240.png}"}

::: {style="display: flex;"}
The symbol $\rho$ is the Greek letter 'rho', pronounced 'row', as in 'row your boat'.
:::

::: {}
```{r}
htmltools::tags$video(src = "./Movies/rho.mp4", 
                      width = "121", 
                      loop = "FALSE", 
                      controls = "controls", 
                      loop = "loop", 
                      style = "padding:5px; border: 2px solid gray;")
```
:::

::::


The values of $\rho$ and $r$ are *always* between $-1$ and $+1$.
The *sign* indicates whether the relationship has a positive or negative linear association, and the *value* of the correlation coefficient describes the *strength* of the relationship:

* $r = -1$ indicates a *perfect, negative* relationship:\index{Correlation coefficient (Pearson)!positive}
  by 'perfect', we mean that knowing the value of $x$ produces an exact prediction of the value of $y$; the negative value means *larger* values of $y$ are associated with *smaller* values of $x$.
* Values of $r$ between $-1$ and $0$ indicates a *negative* relationship:\index{Correlation coefficient (Pearson)!negative}
  knowing the value of $x$ produces a prediction of the value of $y$, and *larger* values of $y$ are associated with *smaller* values of $x$ (in general).
* $r = 0$ indicates *no linear relationship* between the variables:\index{Correlation coefficient (Pearson)!zero}
  knowing how the value of $x$ changes tells us nothing about how the corresponding value of $y$ changes.
  The best prediction of $y$ for *any* value of $x$ is the mean of $y$; i.e., $\bar{y}$.
* Values of $r$ between $0$ and $+1$ indicates a *positive* relationship:
  knowing the value of $x$ produces a prediction of the value of $y$, and *larger* values of $y$ are associated with *larger* values of $x$ (in general).
* $r = +1$ indicates a *perfect, positive* relationship:
  by 'perfect', we mean that knowing the value of $x$ produces an exact prediction of the value of $y$; the positive value means *larger* values of $y$ are associated with *larger* values of $x$.

Almost all values of $r$ are between the extremes of $r = -1$ and $r = +1$.
`r if (knitr::is_html_output()) {
   'The animation below demonstrates how the values of the correlation coefficient work.'
}`


```{r, animation.hook="gifski", interval=0.5, dev=if (is_latex_output()){"pdf"}else{"png"}}
if (knitr::is_html_output()){
  set.seed(12345)

    num.obs <- 120
    
    rho.list <- seq(-1, 1, 
                    by = 0.1)
    num.plots <- length(rho.list)
    
    xx <- runif(num.obs, 0, 10)
    
    for (i in 1:num.plots){
      out <- MASS::mvrnorm(num.obs, 
                           mu = c(mean(xx), 10), 
                           Sigma = matrix(c(1, 
                                            rho.list[i] , 
                                            rho.list[i], 1), 
                                          ncol = 2), 
                           empirical = TRUE)
      
      plot(out[, 1], out[, 2], 
           pch = 19,
           las = 1, 
           xlim = c(2, 8),
           ylim = c(6, 14),
           xlab = expression(paste("Explanatory variable ", italic(x)) ),
           ylab = expression(paste("Response variable ", italic(y)) ),
           main = paste("Correlation:", format(round(rho.list[i], 2), nsmall = 2)))
      abline( coef(lm(out[, 2] ~ out[, 1]) ), 
              lwd = 2, 
              col = "grey")
    }
  }
```

Numerous example scatterplots were shown in Sect.\ \@ref(UnderstandingScatterplots).
A correlation coefficient is not relevant for 
`r if (knitr::is_html_output()) {
  'Plots C, D, E or H,'
} else {
  'Plots C, D or E,'
}`
as those relationships are not linear.
For the others:

* *Plot A*: the correlation coefficient is *positive*, and reasonably close to one.
* *Plot B*: the correlation coefficient is *negative*, but not near $-1$.
* *Plot F*: the correlation coefficient is close to zero.


::: {.example #Correlations name="Correlation coefficients"}
@leuchtenberger2022effects and @Nishizaki2022SanddollarData explored the relationship between water temperature and fertilization rates for sand dollars (Fig.\ \@ref(fig:SanddollarsPlot)).
The correlation coefficient is $r = -0.71$ (left panel), which might suggest that *higher* temperatures result in *lower* fertilization rates.
However, a *curved* relationship is apparent (right panel), and so the relationship is more complex: the fertilization rate increases up to about $18$^o^C, and then starts falling again.

A Pearson correlation coefficient is not suitable for describing the relationship.
:::


```{r SanddollarsPlot, fig.cap="Water temperature vs fertilization rates for sand dollars. Left: an inappropriate linear relationship. Right: the appropriate curved relationship.", fig.align="center", fig.width=8, fig.height=3.25, out.width='90%'}
par(mfrow = c(1, 2))

data(Sanddollars)

SDsub <- Sanddollars

plot( SDsub$SD.temperatures, SDsub$SD.fertilization,
      pch = 19,
      col = "grey",
      lwd = 2,
      las = 1,
      xlim = c(5, 40),
      ylim = c(0, 100),
      main = "Temperature vs fertilization\nrates for sand dollars",
      xlab = "Water temperature (degrees C)",
      ylab = "Fertilization rate (in %)")
text(x = 15,
     y = 40,
     labels = expression( atop(italic(r)==-0.71),
                          group("(", Not~appropriate,")")) )

abline( coef( lm( SD.fertilization ~ SD.temperatures,
                  data =  SDsub ) ),
        lwd = 2,
        lty = 1)

plot( SDsub$SD.temperatures, SDsub$SD.fertilization,
      pch = 19,
      col = "grey",
      lwd = 2,
      las = 1,
      xlim = c(5, 40),
      ylim = c(0, 100),
      main = "Temperature vs fertilization\nrates for sand dollars",
      xlab = "Water temperature (degrees C)",
      ylab = "Fertilization rate (in %)")

m2 <- lm( SD.fertilization ~ poly(SD.temperatures, 2),
            data =  SDsub )
newX <- seq(5, 40,
            length = 100)
newY <- predict( m2, newdata = data.frame(SD.temperatures = newX))
lines(newY ~ newX,
      lwd = 2)

```



Formulas exist to compute the value of $r$, but are tedious to use manually.
We will use software output to obtain values of $r$.


::: {.example #CorrelationsDeer name="Correlation coefficients"}
For the red-deer data 
`r if( knitr::is_latex_output() ) {
  '(Fig.\\ \\@ref(fig:RedDeerScatter)),'
} else {
  '(Fig.\\ \\@ref(fig:RedDeerScatter)),'
}
`
the relationship is approximately linear, and the software output shows that $r = -0.584$ (Fig.\ \@ref(fig:RedDeerCorrelationjamovi)).
The value of $r$ is *negative* because, in general, *older* deer ($x$) are associated with *smaller* weight molars ($y$).
The relationship may be described as 'moderately strong' perhaps.
:::


::: {.example #LungCapCor name="Correlation coefficients"}
@data:Tager:FEV studied the lung capacity (forced expiratory volume; FEV) of children in Boston [@BIB:data:FEV].
The scatterplot in Fig.\ \@ref(fig:FEVscatter) is not linear, so a correlation coefficient is inappropriate.
:::


::: {.tipBox .tip data-latex="{iconmonstr-info-6-240.png}"}
The web page [http://guessthecorrelation.com](http://guessthecorrelation.com) makes a game out of trying to guess the correlation coefficient from a scatterplot.
It's very difficult!
:::



<iframe src="https://learningapps.org/watch?v=psq8a3mfj22" style="border:0px;width:100%;height:500px" allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true"></iframe>


```{r RedDeerCorrelationjamovi, fig.cap=" Software output for correlation for the red deer data.", fig.align="center", out.width="50%", fig.show="hold"}
knitr::include_graphics("jamovi/RedDeer/RedDeer-Correlation.png")
#knitr::include_graphics("SPSS/RedDeer/RedDeer-Correlation.png")
```


### R-squared ($R^2$) {#Rsquared}
\index{R2@$R^2$}

While $r$ describes the strength and direction of the linear relationship, knowing exactly what the value *means* is tricky.
Interpretation is easier using $R^2$: the square of the value of $r$.
`r if (knitr::is_html_output()) {
   'The animation below shows some values of $R^2$.'
}`


::: {.definition #R2 name="$R^2$"}
The value of $R^2$ is how much the unexplained variation in the values of $y$ is reduced due to using the extra information in the values of $x$.
:::


::: {.pronounceBox .pronounce data-latex="{iconmonstr-microphone-7-240.png}"}
$R^2$ is pronounced as '$r$-squared'.
:::



The value of $R^2$ is *never* negative, and is usually multiplied by $100$ and expressed as a percentage.


<!-- need to watch! Unfortunate line breaks can happen! Need to avoid, e.g., breaking -0.25 across lines -->
::: {.softwareBox .software data-latex="{iconmonstr-laptop-4-240.png}"} 
The value of $R^2$ is never negative!
However, you need to be careful using your calculator.
On most calculators, entering `-0.5^2` returns an answer of `-0.25`.
The calculator interprets your input as meaning `-(0.5^2)`.

Use brackets; `(-0.5)^2` gives the correct answer of `0.25` (or $25$%).
:::


::: {.example #R2Deer name="Values of $R$-squared"}
For the red-deer data
`r if( knitr::is_latex_output() ) {
  '(Fig.\\ \\@ref(fig:RedDeerScatter)),'
} else {
  '(Fig.\\ \\@ref(fig:RedDeerScatter)),'
}`
the value of $R^2$ is $R^2 = (-0.584)^2 = 0.341$, usually written as a percentage: $34.1$%.
The value of $R^2$ is positive, even though the value of $r$ is negative.

This means a reduction of about $34.1$% in the unexplained variation of the molar weights, due to using the information in the age of the deer.
The rest of the variation in molar weights is due to chance, and to extraneous variables, such as weight, diet, amount of exercise, genetics, etc.
:::



$R^2$ measures the reduction in the unexplained variation in values of $y$ because the value of $x$ is known.
If the values of $x$ were unknown, the best summary of the $y$-values is the mean of the $y$-values.
However, a relationship between the values of $x$ and $y$ suggests (potentially) that better estimates of the value of $y$ could be made by knowing the value of $x$.
That means that less variation should be left unexplained.

When expressed as a percentage, $R^2$ measures how much the unexplained variation reduces due to our knowledge of the linear relationship.
If $R$-squared is zero, then the amount of unexplained variation has not reduced at all, and exploring the relationship between $x$ and $y$ has no value.


:::{.example #ReductionR2 name="Unknown variation in $y$"}
\index{R2@$R^2$!meaning}
For the red-deer data, the unexplained variation in the values of $y$ (molar weight), without knowing anything about the age of the deer, is the variation in the *distances from the mean* to each observation (Fig.\ \@ref(fig:RedDeerR2), left panels).
Effectively, the unexplained variation is the standard deviation of the molar weights ($s = 0.7263$).

If the age of the deer ($x$) is used, the unexplained variation in the values of $y$ is now the variation in the *distances from the line explaining the relationship* to each observation (Fig.\ \@ref(fig:RedDeerR2), right panel).
The distances are much shorter, in general, showing a decrease in the *unexplained* variation.
Effectively, the unexplained variation is the standard deviation of the distances from the line to the observations ($s = 0.5895$).

Hence, the reduction in the *square* of the standard deviations is $(0.7263^2 - 0.5895^2)/0.7263^2 = 0.341$, or $34.1$\%.
This is the value of $R^2$.
:::


```{r R2Plots, animation.hook="gifski", interval=0.5, dev=if (is_latex_output()){"pdf"}else{"png"}}
if (knitr::is_html_output()){
  set.seed(12345)

   num.obs <- 120
    
   rho2.list <- seq(0.1, 1, 
                    by = 0.1)
   rho.list <- c( -rev(sqrt(rho2.list)), 0, sqrt(rho2.list) )
   num.plots <- length(rho.list)
    
   xx <- runif(num.obs, 0, 10)
    
   for (i in 1:num.plots){
      out <- MASS::mvrnorm(num.obs, 
                           mu = c(mean(xx), 10), 
                           Sigma = matrix(c(1, 
                                            rho.list[i] , 
                                            rho.list[i], 
                                            1), 
                                          ncol = 2), 
                           empirical = TRUE)
      
      plot(out[, 1], 
           out[,2 ], 
           pch = 19,
           las = 1, 
           xlim = c(2, 8),
           ylim = c(6, 14),
           xlab = "Explanatory variable",
           ylab = "Response variable",
           sub = paste("(r: ", format(round(rho.list[i], 2), nsmall = 2),")", sep = ""),
           main = paste("R-squared: ", format(round(rho.list[i]^2 * 100, 0), nsmall = 0), "%", sep = "") )
      abline( coef(lm(out[, 2] ~ out[, 1]) ), 
              lwd = 2, 
              col = "grey")
    }
}
```


```{r RedDeerR2, message=FALSE, warning=FALSE, fig.height=5.25, fig.width=6.5, out.width='95%', fig.align="center", fig.cap="The unexplained variation for the red-deer data. Left panels: when no information about the age of the deer is used, the mean (the horizontal grey line in the top panel) is the best summary of the molar weight. Right panels: when information about the age of the deer is used (as shown the grey line in the top panel), the distances are shorter in general. $R^2$ is a measure of how much smaller."}
layout( matrix(c(1, 2, 3, 4), 
               nrow = 2, 
               byrow = TRUE) )

showResidualsAtThesePoints <- c(3, 22, 53, 65, 69, 75)


### TOP LEFT plot
par(mar = c(5.1, 4.5, 3.5, 3))

plot(Weight ~ Age, 
     data = RedDeer,
     las = 1,
     pch = 19, 
     col = "lightgrey",
     ylim = c(0, 5.5),
     xlim = c(4, 15),
     cex = 1,
     axes = FALSE,     
     main = expression( atop(Molar~weight~and~age,
                             of~male~red~deer)),
     xlab = "Age (in years)",
     ylab = "Molar weight (in g)")
axis(side = 2,
     las = 1)
axis(side = 1)
box()

abline( h = mean(RedDeer$Weight),
        lwd = 2,
        col = "grey")

# Draw residuals
yHat <- rep(mean(RedDeer$Weight),
            length = length(RedDeer$Weight) )

for (i in (1:length(showResidualsAtThesePoints))){
  arrows(x0 = RedDeer[ showResidualsAtThesePoints[i], 1],
         x1 = RedDeer[showResidualsAtThesePoints[i], 1],
         y0 = yHat[showResidualsAtThesePoints[i]],
         y1 = RedDeer[showResidualsAtThesePoints[i], 2],
         length = 0.075,
         angle = 15)
}

axis(side = 4,
     at = yHat[1],
     las = 1,
     labels = expression( bar(italic(y)) ) )


### TOP RIGHT plot
par(mar = c(5.1, 4.1, 3, 1))

plot(Weight ~ Age, 
     data = RedDeer,
     las = 1,
     pch = 19, 
     col = "lightgrey",
     ylim = c(0, 5.5),
     xlim = c(4, 15),
     cex = 1,
     main = expression( atop(Molar~weight~and~age,
                             of~male~red~deer)),
     xlab = "Age (in years)",
     ylab = "Molar weight (in g)")

mDeer <- lm(Weight ~ Age,
            data = RedDeer)

abline( mDeer,
        lwd = 2,
        col = "grey")

# Draw residuals
yHat <- predict(mDeer)


for (i in (1:length(showResidualsAtThesePoints))){
  arrows(x0 = RedDeer[ showResidualsAtThesePoints[i], 1],
         x1 = RedDeer[showResidualsAtThesePoints[i], 1],
         y0 = yHat[showResidualsAtThesePoints[i]],
         y1 = RedDeer[showResidualsAtThesePoints[i], 2],
         length = 0.075,
         angle = 15)
}




### BOTTOM LEFT plot
deerMeanResiduals <- summary( lm(Weight ~ 1, 
                                 data = RedDeer))$residuals
hist( deerMeanResiduals,
      las = 1,
      xlim = c(-2.5, 3),
      ylim = c(0, 30),
      border = grey(0.5),
      main = expression( atop(Unexplained~variation~"in",
                              italic(y)*"-"*values~"("*molar~weights*")")),
      sub = expression("("*Standard~deviation*":"~0.7263*")"),
      xlab = "Distances from mean to observations")

arrows(x0 = -2,
       x1 = 2.5,
       y0 = 15,
       y1 = 15,
       code = 3, # Arrow both ends
       lwd = 2,
       angle = 15,
       length = 0.1)

### BOTTOM RIGHT plot
deerResiduals <- summary(mDeer)$residuals
hist( deerResiduals,
      las = 1,
      xlim = c(-2.5, 3),
      ylim = c(0, 30),
      border = grey(0.5),
      main = expression(atop(Unexplained~variation~knowing,
                             the~values~of~italic(x)~"("*age*")") ),
      sub = expression("("*Standard~deviation*":"~0.5895*")"),
      xlab = "Distances from line to observations")

arrows(x0 = -1.5,
       x1 = 2,
       y0 = 15/25 * 30,
       y1 = 15/25 * 30,
       code = 3, # Arrow both ends
       lwd = 2,
       angle = 15,
       length = 0.1)

```





## Numerical summary tables {#ConnectionSummaryTables}
\index{Quantitative data!correlation!summary tables}

In general, numerically summarising the relationship between two quantitative variables is difficult because of the many types of possible relationships (Sect.\ \@ref(UnderstandingScatterplots)).
However, for *linear* relationships, both quantitative variables can be summarised, and the correlation coefficient can be given (Table\ \@ref(tab:RDSummaryTable)).


```{r RDSummaryTable}
RDTable <- array( dim = c(2, 4))

rownames(RDTable) <- c("Age (in years)",
                        "Molar weight (in g)")
colnames(RDTable) <- c("Mean",
                        "Standard deviation",
                        "Sample size",
                       "Correlation")


RDTable[, 1] <- round(colMeans(RedDeer), 1)
RDTable[, 2] <- round(apply(RedDeer, 2, "sd"), 2)
RDTable[, 3] <- round(apply(RedDeer, 2, "realLength"), 0)
RDTable[, 4] <- c( round(cor(RedDeer)[1, 2], 3),
                   NA)


if( knitr::is_latex_output() ) {

knitr::kable( pad(RDTable,
                  surroundMaths = TRUE,
                  targetLength = c(4, 5, 3, 6),
                  digits = c(1, 2, 0, 3)),
              format = "latex",
              longtable = FALSE,
              booktabs = TRUE,
              escape = FALSE,
              align = "c",
              caption = "A numerical summary of the red deer data.") %>%
  kable_styling(full_width = FALSE) %>%
  row_spec(row = 0,
           bold = TRUE) %>%
  kable_styling(font_size = 8)
}
if( knitr::is_html_output() ) {
knitr::kable( pad(RDTable,
                  surroundMaths = TRUE,
                  targetLength = c(4, 5, 3, 6),
                  digits = c(1, 2, 0, 3)),
              format = "html",
              longtable = FALSE,
              booktabs = TRUE,
              escape = FALSE,
              align = "c",
              caption = "A numerical summary of the red deer data.") %>%
  kable_styling(full_width = FALSE) %>%
  row_spec(row = 0,
           bold = TRUE)
}
```





## Example: removal efficiency {#ScatterplotsRemoval-Efficiency}


<div style="float:right; width: 222x; border: 1px; padding:10px">
<img src="Illustrations/pexels-lisa-fotios-3264779.jpg" width="200px"/>
</div>


In wastewater treatment facilities, air from biofiltration is passed through a membrane and dissolved in water, and is transformed into harmless byproducts.
The removal efficiency $y$ (in %) may depend on the inlet temperature (in ^o^C; $x$).
@chitwood2001treatment asked:

> In treating biofiltation wastewater, is the removal efficiency linearly associated with the inlet temperature?

A scatterplot of $n = 32$ observations (Fig.\ \@ref(fig:ScatterplotRemovalEfficiency), left panel) suggests an approximately linear relationship [@DevoreBerk2007].
The direction is positive: larger inlet temperatures are associated with a larger removal efficiency, in general.
The variation is always hard to describe, but is perhaps 'reasonably small'.

A more precise way to measure the strength of the linear association is to use the correlation coefficient.
Using software output (Fig.\ \@ref(fig:ScatterplotRemovalEfficiency), right panel), $r = 0.891$, and so $R^2 = (0.891)^2 = 79.4$%.
This means that about $79.4$% of the variation in removal efficiency can be explained by knowing the inlet temperature.


```{r ScatterplotRemovalEfficiency, fig.cap="The relationship between removal efficiency and inlet temperature. Left: scatterplot. Right: software output.", fig.align="center", fig.width=5, fig.height=3.25, out.width=c("52%", "2%", "41%"), fig.show="hold"}
data(Removal)

plot(Removal ~ Temp, 
     data = Removal,
     main = "Removal efficiency",
     xlab = "Temperature (degrees C)",
     ylab = "Removal efficiency (%)",
     pch = 19,
     ylim = c(97.5, 99.0),
     xlim = c(5, 18),
     las = 1
     )
knitr::include_graphics("OtherImages/SPACER.png")
knitr::include_graphics("jamovi/Removal/RemovalCorrelation.png")
```


## Chapter summary {#TwoQuant-Summary}

A *scatterplot* displays the relationship between two quantitative variables (the response denoted $y$; the explanatory denoted $x$).
The relationship is described by the *form* (linear, or otherwise), the *direction* of the relationship (sometimes not relevant if the graph is not linear), and the *variation* in the relationship (or the *strength* of the relationship).

Linear relationships are measured numerically using the correlation coefficient and $R^2$.
*Correlation coefficients* (denoted $r$ in the sample; $\rho$ in the population) are always between $-1$ and $+1$.
*Positive* values denote *positive* relationships between the two variables: as one values gets larger, the other tends to get larger too.
*Negative* values denote *negative* relationships between the two variables: as one values gets larger, the other tends to get *smaller*.
Values close to $-1$ or $+1$ are very strong relationships; values near zero shows very little linear relationship between the variables.

Sometimes, $R^2$ is used to describe the relationship: it indicates what percentage of the variation in the response variable can be explained by knowing the value of the explanatory variables.


## Quick review questions {#TwoQuant-QuickReview}

::: {.webex-check .webex-box}
A study of onion growth [@meadplant] produced the scatterplot shown in Fig.\ \@ref(fig:MeanScatter).


```{r MeanScatter, fig.cap="Onion yield plotted against planting density.", fig.align="center", fig.width=5, fig.height=3.5}
data(YieldDen)

plot(Yield ~ Dens,
	las = 1,
	main = "Planting density and yield per plant\nfor onions",
	xlab = "Planting density (plants/sq. ft)",
	ylab = "Yield/plant (g/plant)", 
  pch = 19,
	ylim = c(0, 140),
	data = YieldDen)
```

1. What is the $x$-variable? \tightlist
`r if( knitr::is_html_output() ) {longmcq( c(
  answer = "Planting density",
  "Yield per plant",
  "It doesn't matter"
) )}`

1. What is the best description for the  *form* of the relationship?
`r if( knitr::is_html_output() ) {longmcq( c(
  "Linear",
  answer = "Curved"
) )}`
1. What is the best description for the *direction* of the relationship?
`r if( knitr::is_html_output() ) {longmcq( c(
  answer = "Negative",
  "Positive"
) )}`
1. What is the best description for the *variation* in the relationship?
`r if( knitr::is_html_output() ) {longmcq( c(
  answer = "Small",
  "Large",
  "Strong"
) )}`
:::




## Exercises {#TwoQuant-Exercises}

Answers to odd-numbered exercises are available in App.\ \@ref(Answers).


`r if( knitr::is_latex_output() ) "\\captionsetup{font=small}"`


::: {.exercise #CorrelationExerciseDrawNegR}
Draw a scatterplot with:

1. a negative correlation coefficient, with $r$ very close to (but not equal to) $-1$. 
1. a positive correlation coefficient, with $r$ very close to (but not equal to) $+1$. 
1. a correlation coefficient very close to $0$. 
:::


::: {.exercise #MatchCorrelations}
Estimate the correlation coefficients from scatterplots in Fig.\ \@ref(fig:MatchScatter).
(You can only give very rough estimates!)

:::

```{r MatchScatter, fig.align="center", fig.cap="Four plots: estimate the correlation coefficients.", fig.height=2.75, fig.width=7, out.width="100%"}
par( mfrow = c(1, 4))

set.seed(140234)

Len <- 20

x <- runif(Len, 
           0, 10)
xMean <- mean(x)

y1 <- 1 + 1 * x + rnorm(Len, 0, 1)
y2 <- 4 - 1 * x + rnorm(Len, 0, 2)
y3 <- rep(1, Len) + rnorm(Len, 0, 1)
y4 <- 1 + 0.5 * (x - xMean)^2 + rnorm(Len, 0, 1)

plot(y1 ~ x,
     pch = 19,
     las = 1,
     xlab = expression(italic(x)),
     ylab = expression(italic(y)),
     main = "Plot A")
plot(y2 ~ x,
     pch = 19,
     las = 1,
     xlab = expression(italic(x)),
     ylab = expression(italic(y)),
     main = "Plot B")
plot(y3 ~ x,
     pch = 19,
     las = 1,
     xlab = expression(italic(x)),
     ylab = expression(italic(y)),
     main = "Plot C")
plot(y4 ~ x,
     pch = 19,
     las = 1,
     xlab = expression(italic(x)),
     ylab = expression(italic(y)),
     main = "Plot D")
```



::: {.exercise #TwoQuantExercisesPeas}
@hacisalihoglu2021characterization studied of the nutritional content of peas (*Pisum sativum*), and measured the quantities of various minerals.
In these plots, it does not matter which of the pair of variables is used on the horizontal axis and which is used on the vertical axis.

From Fig.\ \@ref(fig:PeasScatter) (*left* panel), estimate the value of $r$.
:::

::: {.exercise #TwoQuantExercisesPeas2}
@hacisalihoglu2021characterization studied of the nutritional content of peas (*Pisum sativum*), and measured the quantities of various minerals.
In these plots, it does not matter which of the pair of variables is used on the horizontal axis and which is used on the vertical axis.

From Fig.\ \@ref(fig:PeasScatter) (*right* panel), estimate the value of $r$.
:::


```{r PeasScatter, fig.cap="The relationship between some minerals in pea seeds.", fig.align="center", fig.width=8, fig.height=3.15, out.width='90%'}
data(Peas) ### Exercise

par( mfrow = c(1, 2))

plot( K ~ P,
      data = Peas,
      xlab = "Phosphorus (mg/g)",
      ylab = "Potassium (mg/g)",
      xlim = c(3, 8),
      ylim = c(10, 17),
      las = 1,
      pch = 19,
      col = "grey",
      main = "Nutritional elements in\npea seeds")
abline( coef( lm( K ~ P, data = Peas)),
        lwd = 2)

###

plot( Ca ~ Zn,
      data = Peas,
      xlab = "Zinc (mg/g)",
      ylab = "Calcium (mg/g)",
      xlim = c(25, 80),
      ylim = c(0, 2.5),
      las = 1,
      pch = 19,
      col = "grey",
      main = "Nutritional elements in\npea seeds")
abline( coef( lm( Ca ~ Zn, data = Peas)),
        lwd = 2)

```



::: {.exercise #TwoQuantExercisesLimeTrees}
@data:ForestBiomass2017 measured the diameter and the age of $385$ small-leaved lime trees (Fig.\ \@ref(fig:LimeTreesScatter)).

1. What does each point on the scatterplot represent?
1. Describe the scatterplot.
1. Would a correlation coefficient be appropriate?
   Explain.
:::


```{r LimeTreesScatter, fig.cap="The age and foliage biomass of small-leaved lime trees grown in Russia ($n = 385$). The solid line on the right panel displays the linear relationship.", fig.align="center", fig.show="hold", fig.width=8, fig.height=3.15, out.width='90%'}
data(Lime) ### Exercise

par( mfrow = c(1, 2))

plot(Foliage ~ Age,
	las = 1,
  main = "Foliage biomass of small-leaved\nlime trees against age",
	xlab = "Age (in years)",
	ylab = "Foliage biomass (in kg)", 
  cex = 0.8,
	pch = 19,
	xlim = c(0, 140),
	ylim = c(0, 14),
	data = Lime)

###


plot(Foliage ~ Age,
	las = 1,
  main = "Foliage biomass of small-leaved\nlime trees against age",
	xlab = "Age (in years)",
	ylab = "Foliage biomass (in kg)", 
  cex = 0.8,
	pch = 19,
	col = "grey",
	xlim = c(0, 140),
	ylim = c(0, 14),
	data = Lime)
abline( coef(lm(Foliage ~ Age, 
                data = Lime)),
        lwd = 2)
#m2 <- lm(log(DBH) ~ log(Age), 
#         data = lime)
#
#newAge <- seq( min(lime$Age), 
#               max(lime$Age),
#               length = 100)
#newDBH <- predict(m2, 
#                  newdata = data.frame(Age = newAge))
#lines( newDBH ~ newAge)
```





::: {.exercise #TwoQuantExercisesBoneQuality}
@kim2022similarities measured numerous data from $969$ South Korean subjects, including $517$ females.
A scatterplot of the height and age for females is shown in Fig.\ \@ref(fig:HeightAgeScatter).

1. What does each point on the scatterplot represent?
1. Describe the relationship.
1. Would a correlation coefficient be appropriate?
   Explain.
1. Does the scatterplot suggest than people become less tall as they age?
   Explain.
:::


```{r HeightAgeScatter, fig.cap="The age and height of South Korean females ($n = 517$). The solid line shows the linear relationship.", fig.align="center", fig.show="hold", fig.width=5, fig.height=3.15, out.width='60%'}
data(BoneQuality) ### Exercise

set.seed(7640)

plot(Height ~ jitter(Age),
	las = 1,
  main = "Height vs age for \nSouth Korean women",
	xlab = "Age (in years)",
	ylab = "Height (in cm)", 
  cex = 0.8,
	pch = 19,
	xlim = c(50, 90),
	ylim = c(134, 170),
	data = subset(BoneQuality, Sex=="Female"))

abline( coef( lm(Height ~ Age,
                 data = subset(BoneQuality, Sex=="Female")),
            ),
        lwd = 2,
        col = "grey")

                   



```




<!-- ::: {.exercise #TwoQuantExercisesSheepFood} -->
<!-- A study evaluated various food mixtures for sheep [@data:Moir1961:RuminantDiet]. -->
<!-- Describe the scatterplot (Fig.\ \@ref(fig:SheepScatter)) in terms of the *form*, *direction* and *variation* in the relationship. -->
<!-- ::: -->


<!-- ```{r SheepScatter, fig.cap="Scatterplots for the sheep-food data", fig.align="center", fig.width=5, fig.height=3.5} -->
<!-- data(ruminant) -->

<!-- plot(Energy ~ DryMatterDigest,  -->
<!--      data = ruminant, -->
<!--      las = 1, -->
<!--      xlim = c(30, 80), -->
<!--      ylim = c(1, 3.5), -->
<!--      main = "Sheep feed data", -->
<!--      xlab = "Dry matter digestibility (%)", -->
<!--      ylab = "Digestible energy (in Cal/gram)", -->
<!--      pch = 19) -->
<!-- abline( lm( Energy ~ DryMatterDigest,  -->
<!--             data = ruminant),  -->
<!--         lwd = 2,  -->
<!-- 	col = "grey") -->
<!-- ``` -->



::: {.exercise #TwoQuantExercisesSoftdrink}
@others:Montgomery:regressionanalysis examined the time taken to deliver soft drinks to vending machines.

1. Describe the relationship (Fig.\ \@ref(fig:MandibleGestationPlot), left panel).
1. What does each point represent?
1. Describe the relationship.
1. Would a correlation coefficient be appropriate?
   Explain.
:::



::: {.exercise #TwoQuantExercisesMandible}
@data:royston:mandible examined the mandible length and gestational age for $167$ foetuses from the $12$th week of gestation onward.
Describe the relationship (Fig.\ \@ref(fig:MandibleGestationPlot), right panel).
:::



```{r MandibleGestationPlot, fig.cap="Two scatterplots. Left: the time taken to deliver soft drinks to vending machines. Right: the relationship between gestational age and mandible length. In both plots, the solid grey line displays the linear relationship.", fig.align="center", fig.width=9, fig.height=3.5, out.width='100%'}
par(mfrow = c(1, 2), 
    mar = c(5.1, 5.1, 4.1, 2.1))

data(SDrink) ### Exercise

plot(Time ~ Cases, 
     data = SDrink,
     main = "Time to service vending machine\nand number of products stocked",
     xlab = "Number of cases of product stocked",
     ylab = "Time to service\nmachine (mins)",
     xlim = c(0, 30),
     ylim = c(0, 80),
     las = 1,
     pch = 19)
abline(coef(lm(Time ~ Cases, 
               data = SDrink)), 
       col = "grey")


### 

data(Mandible) ### Exercise

plot(Length ~ Age, 
     data = Mandible,
     main = "Gestational age and\nmandible length",
     xlab = "Gestational age (in weeks)",
     ylab = "Mandible length (in mm)",
     xlim = c(10, 40),
     ylim = c(0, 50),
     las = 1,
     pch = 19)
abline(coef(lm(Length ~ Age, 
            data = Mandible)), 
       col = "grey")
###


```


::: {.exercise #TwoQuantExercisesGorillas}
@wright2021chest recorded the chest-beating rate of $25$ gorillas, and the gorillas' size (measured by the breadth of the gorillas' backs).
Describe the relationship (Fig.\ \@ref(fig:GorillaWindmillPlot), left panel).
:::


```{r GorillaWindmillPlot, fig.cap="Two scatterplots. Left: chest beating in gorillas. Right: the relationship between DC output and wind speed.", fig.align="center", fig.width=9, fig.height=3.5, out.width='100%'}
par(mfrow = c(1, 2), 
    mar = c(5.1, 4.1, 4.1, 2.1))

data(Gorillas) ### Exercise

plot(NoChestBeats ~ BackBreadth, 
     data = Gorillas,
     main = "Chest beating in gorillas",
     xlab = "Back breadth (in cm)",
     ylab = "Number chest beats per minute",
     xlim = c(54, 66),
     ylim = c(0, 51),
     las = 1,
     pch = 19)


###

data(Windmill) ### Exercise

plot(DC ~ Wind, 
     data = Windmill,
     main = "DC output and wind speed",
     xlab = "Wind speed (in miles per hour)",
     ylab = "DC output",
     las = 1,
     xlim = c(2, 10),
     ylim = c(0, 2.5),
     pch = 19)
```




::: {.exercise #TwoQuantExercisesWindmill}
@data:joglekar:lackoffit examined the relationship between direct current (DC) generated by a windmill and wind speed [@data:hand:handbook].
Describe the relationship (Fig.\ \@ref(fig:GorillaWindmillPlot), right panel).
:::


:::{.exercise #SoilCN}
@lambie2021microbial recorded the percentage carbon (C) and the percentage nitrogen (N) in $28$ irrigated farming plots (Fig.\ \@ref(fig:IrrigatedCNStudents), left panel).

1. Describe the relationship.
1. Does it matter which variable is $x$ and which is $y$?
   Explain.
1. What does each point represent?

:::

```{r, IrrigatedCNStudents, fig.align="center", fig.cap="Left: the percentage N and percentage C in irrigated plots. Right: the weight of students in Week\\ 1 and Week\\ 12 of the university semester.", fig.width=9, fig.height=3.5, out.width='100%'}
par(mfrow = c(1, 2))

data(SoilCN) ### Exercise

plot(x = SoilCN$IrrigatedC, 
     y = SoilCN$IrrigatedN,
     pch = 19,
     las = 1,
     xlab = "Percentage C",
     ylab = "Percentage N",
     main = "Percentage soil carbon and\nnitrogen in 28 irrigated farm plots")

###
data("StudentWt")

plot(y = StudentWt$Week12,
     x = StudentWt$Week1,
     pch = 19,
     las = 1,
     ylab = "Weight (in kg) at 12 Weeks",
     xlab = "Weight (in kg) at 1 Week",
     main = "Weight of students after\nand 12 weeks at university")
```


:::{.exercise #StudentWts}
The weights of students starting at university (Week\ 1) and in Week\ 12 are shown in Fig\ \@ref(fig:IrrigatedCNStudents) (right panel).

1. Describe the relationship.
1. What does each point represent?
:::





::: {.exercise #TwoQuantExercisesONI}
The relationship [@mypapers:dunnsmyth:glms] between the number of cyclones $y$ in the Australian region each year from 1969 to 2005, and a climatological index called the *Ocean `r readr::parse_character( c("Ni√±o"), locale=locale(encoding="UTF-8"))` Index* (ONI, $x$), is shown in Fig.\ \@ref(fig:ONIcyclonesCI).

From software, $r = -0.682$.
What is the value of $R^2$?
What does it mean?
:::


```{r ONIcyclonesCI, fig.width=4, fig.align="center", fig.cap="The number of cyclones in the Australian region each year from 1969 to 2005, and the ONI for October, November, December", fig.width=5, fig.height=4}

data(Cyclones) ### Exercise

plot(Total ~ OND, 
     data = Cyclones,
     xlim = c(-2, 3),
     ylim = c(0, 20),
     pch = 19,
     ylab = "Total number of cyclones",
     xlab = "ONI averaged over Oct., Nov., Dec.",
     las = 1)

clm <- lm( Total ~ OND, 
           data = Cyclones)
abline( coef(clm), 
        lwd = 1, 
        col = "grey")
grid(lty = 2)
```


`r if( knitr::is_latex_output() ) "\\captionsetup{font=normalsize}"`





<!-- QUICK REVIEW ANSWERS -->
`r if (knitr::is_html_output()) '<!--'`
::: {.EOCanswerBox .EOCanswer data-latex="{iconmonstr-check-mark-14-240.png}"}
**Answers to *Quick Revision* questions:**
**1.** Planting density.
**2.** Curved.
**3.** Negative.
**4.** Small.
:::
`r if (knitr::is_html_output()) '-->'`

