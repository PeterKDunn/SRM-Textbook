# Estimating sample sizes {#EstimatingSampleSize}

```{block2, type="rmdobjectives"}
So far,
you have learnt, among many other things, how to compute confidence intervals.
**In this chapter**,
you will learn how to compute the size sample that is needed
to produce a CI with a certain coverage.
You will learn to:
* estimate the sample size for producing a CI of given width for a **proportion**.
* estimate the sample size for producing a CI of given width for a **mean**.

```




```{r echo=FALSE, fig.cap="", fig.align="center", fig.width=3, out.width="35%"}
SixSteps(5, "Estimating the sample size")
```


## Estimating sample size: General ideas {#SampleSizeIdeas}



```{block2, type="rmdimportant"}
Always **round up** the result of the sample size calculation.
```



## Estimating sample sizes: one proportion {#SampleSizeOneProportion}

For a given level of confidence,
the width of a CI depends on
the size of the sample.
In general,
larger samples produce 
more [precise](#PrecisionAccuracy) estimates of the parameter
(Sect.&nbsp;\@ref(PrecisionAccuracy)),
and hence narrower CIs.

Suppose we want our 95% CI for the proportion of smokers 
(Example \@ref(exm:NHANESSmokers))
to be
precise to give-or-take $0.01$ 
(rather than the $\pm 0.018$ found from the sample):
what size sample is needed?
Since we seek a *more* precise estimate, 
we'd expect to need a *larger* sample... 
but how much larger?

Conservatively,
the sample size for a 95% CI needed is *at least*

\[
   \frac{1}{(\text{Margin of error})^2}.
\]
That is,
a sample size of at least 
$\displaystyle \frac{1}{0.01^2} = 10\,000$ 
Americans is needed.


```{example SampleSizep, name="Sample size calculations"}
To estimate the population proportion of Australians that smoke, 
to within $0.07$ with 95% confidence,
a sample size of at least
   
\[
  \frac{1}{(\text{Margin of error})^2} { = \frac{1}{0.07^2}}
\]
is needed;
*at least* $n = 204.0816$ people.
In practice,
*at least* 205 people are needed
to achieve this desired level of precision
(that is, **always round up** in sample size calulations).
```



```{block2, type="rmdimportant"}
Always **round up** the result of the sample size calculation.
```




`r if (knitr::is_html_output()){
  'The following short video may help explain some of these concepts:'
}`

<iframe width="560" height="315" src="https://www.youtube.com/embed/-fflEggczG4" frameborder="0" allow="accelerometer; encrypted-media; gyroscope; picture-in-picture"></iframe>





## Estimating sample sizes: one mean  {#SampleSizeOneMean}

```{r echo=FALSE}
me <- 0.02
n.est <- ( 2 * sd.S / me )^2 
```

For a specified level of confidence,
the width of a CI depends on
the size of the sample.
In general,
larger samples produce more [precise](#PrecisionAccuracy) estimates of the parameter
(Sect.&nbsp;\@ref(PrecisionAccuracy)),
and hence narrower CIs.

To determine the sample size needed to
estimate a *sample mean* with a given [precision](#PrecisionAccuracy)
for a 95% CI is *at least*

\[
   \left( \frac{2 \times s}{\text{Margin of error}}\right)^2.
\]


```{block2, type="rmdimportant"}
Always **round up** the results of a sample size calculation.
```

<!-- Text wrap from: https://stackoverflow.com/questions/43551312/wrap-text-around-plots-in-markdown -->
<!-- Trick from: https://blog.earo.me/2019/10/26/reduce-frictions-rmd/ -->
`r if (knitr::is_latex_output()) '<!--'`
```{r, echo=FALSE, out.width= "30%", out.extra='style="float:right; padding:10px"'}
include_graphics("Illustrations/hamburger-2253349_640.jpg")
```
`r if (knitr::is_latex_output()) '-->'`


```{example SampleSizepNHANES, name="Sample size estimation"}
For the NHANES data,
What size sample is needed to estimate the direct HDL cholesterol levels
to within 0.02&nbsp;mmol/L, with 95% confidence?
  
Since we would like to estimate the population mean give-or-take 0.02&nbsp;mmol/L,
the 'margin of error' that we would like is 0.02.
So, using $s=0.39926$, the required sample size is *at least*
\[
   \left( \frac{2 \times 0.39926}{0.02}\right)^2 = 1594.085;
\] 
at least 1595 Americans are needed.
(Remember to always *round up* in sample size calculations.)
```






