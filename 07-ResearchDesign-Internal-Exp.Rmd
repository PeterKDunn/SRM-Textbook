
# Internal validity and experimental studies {#DesignExperiment}



<!-- Introductions; easier to separate by format -->

```{r, child = if (knitr::is_html_output()) {'./introductions/07-ResearchDesign-Internal-Exp-HTML.Rmd'} else {'./introductions/07-ResearchDesign-Internal-Exp-LaTeX.Rmd'}}
```


## Introduction {#Chap7-Intro}

To draw solid conclusions, a well-designed study is needed: a study with high [*internal validity*](#def:InternalValidity).
When studying the relationship between the response and explanatory variables, ideally other explanations for changes in the value of response variable can be ruled out, so any remaining changes we see can be attributed to just the value of the explanatory variable.
Many aspects of the design must be considered to achieve this goal, some of which are discussed in this chapter.


::: {.importantBox .important data-latex="{iconmonstr-warning-8-240.png}"}
One goal of study design is to maximise internal validity: to design a study to isolate the relationship of interest, by eliminating, as well as possible, all other possible explanations.
:::


::: {.example #InternalValidity name="Importance of internal validity"}
Researchers [@beaman2013profitability] describe an experiment where free fertilizer was provided to a sample of female farmers in Mali (at the recommended amount per hectare, or at half the recommended amount per hectare).

Since all the farmers knew they were in the study, the farmers changed their farm management: they employed more hired labour and used more herbicide.
Consequently, the yields for *all* farmers improved, so knowing whether the amount of fertilizer applied changed yield is difficult.
The study had poor *internal validity*.
:::


Specific design strategies for maximising [internally validity](#def:InternalValidity) include:

* Managing confounding (Sect. \@ref(ExpManagingConfounding)).
* Managing the carry-over effect using washout periods (Sect. \@ref(CarryOverEffectExperimental)).
* Managing the Hawthorne effect by blinding individuals (Sect. \@ref(HawthorneEffectExperimental)).
* Managing the placebo effect using controls (Sect. \@ref(PlaceboEffectExperimental)).
* Managing the observer-effect by blinding the researchers (Sect. \@ref(ObserverEffectExperimental)).
* Recording potential extraneous variables (Sect. \@ref(RecordExtraneous)).

Not all of these will be relevant to every study.
This chapter discusses experimental studies; the next chapter considers design issues for observational studies.



<div style="float:right; width: 222x; border: 1px; padding:10px">
<img src="Illustrations/pexels-gil-goldman-4268507.jpg" width="200px"/>
</div>


In this chapter, we will work with this RQ (based on @data:Bird2008:wholegrain):

> Among Australians, does eating provided food made from wholegrain *Himalaya 292* increase average faecal weight compared to eating provided food made from refined cereal?  


::: {.thinkBox .think data-latex="{iconmonstr-light-bulb-2-240.png}"}
For the *Himalaya 292* study:\label{thinkBox:HimalayaPOCI}

1. Determine P, O, C and I.
1. What are the variables?
1. What *type* of study is this?

`r if (!knitr::is_html_output()) '<!--'`
`r webexercises::hide()`
1. **P**: Australians. **O**: average faecal weight. **C**: Between those eating food made using refined cereal, and those eating food made from *Himalaya 292*.
2. The information that *must* be gathered from each individual: the faecal weight; the type of grain consumed (refined or *Himalaya 292*).
3. True experiment.
`r webexercises::unhide()`
`r if (!knitr::is_html_output()) '-->'`
:::


A study must be designed to collect the data to answer this RQ.
Careful thought must be given to this design.


## Managing confounding {#ExpManagingConfounding}

Confounding has the potential to compromise the [internal validity](#def:InternalValidity) of the study and hence the interpretation of the results, so managing the impact of confounding is important.
Suppose, for example, that the researchers created two groups:

* **Group A**:  Women recruited at a female-only gym.
* **Group B**:  Men recruited at a local nursing home.

The researchers then gave *Himalaya 292* to Group A, and the refined cereal to Group B.
If a difference in faecal weight was detected between the two groups, the difference may because:

* The *diet* (the explanatory variable) was different in each group;
* The *sex* of the participants was different in both groups (Group A was all women; Group B was all men);
* The *age* of the participants in each group was different (Group A is likely to be younger on average; Group B is likely to be older on average);
* The health and fitness levels in each group was different (Group A would generally be healthier than those in Group B).

That is, any difference detected between the two groups may not be because of the cereal (Table \@ref(tab:ConfoundingGroups)): the study has very poor internal validity due to poor study design.
For example, the age of the subject may be related to faecal weight (older people tend to eat less, and eat differently, than younger people), and the study design means that older people are more likely to consume the refined cereal.
This is an extreme case of *confounding*; usually, confounding is more subtle (and hence more difficult to detect) than in this example.


```{r ConfoundingGroups, echo=FALSE}

if( knitr::is_latex_output() ) {
	ConfoundTable <- array( dim = c(4, 3) )
   
	colnames(ConfoundTable) <- c("Variable", 
                             "Group A",
                             "Group B")

   ConfoundTable[1, ] <- c("Sex",
                           "Women",
                           "Men")
   ConfoundTable[2, ] <- c("Age",
                           "Younger (in general)",
                           "Older (in general)")
   ConfoundTable[3, ] <- c("Diet",
                           "*Himalaya 292*",
                           "Refined cereal")
   ConfoundTable[4, ] <- c("Fitness",
                           "Very fit",
                           "Less fit")
   
   ConfoundTable[3, 2] <- "\\textit{Himalaya 292}"

  	kable(ConfoundTable[, c(2, 1, 3)],
          format = "latex",
          longtable = FALSE,
          booktabs = TRUE,
          escape = FALSE, # For latex to work in \rightarrow
          caption = "Comparing Groups A and B: An extreme example of confounding",
          align = c("r", "c", "l"))   %>%
    kable_styling(full_width = FALSE, 
                  font_size = 10) %>%
    row_spec(row = 0, 
             bold = TRUE) %>% # Columns headings in bold
    column_spec(column = 2, 
                bold = TRUE)  
}

if( knitr::is_html_output()) {
   ConfoundTable <- array( dim = c(4, 3) )

   colnames(ConfoundTable)<- c( "",
	                              "Group A",
                                "Group B")
   ConfoundTable[1, ] <- c("*Sex*",
                           "Women",
                           "Men")
   ConfoundTable[2, ] <- c("*Age*",
                           "Younger (in general)",
                           "Older (in general)")
   ConfoundTable[3, ] <- c("*Diet*",
                           "*Himalaya 292*",
                           "Refined cereal")
   ConfoundTable[4, ] <- c("*Fitness*",
                           "Very fit",
                           "Less fit")
   
IMG1 <- array( NA, dim = c(1, 1))
IMG1[1, 1] <- "![](./Pics/iconmonstr-candy-5-240.png){#id .class height=60px}<br>
               ![](./Pics/iconmonstr-arrow-down-thin-240.png){#id .class height=50px} <br>
               ![](./Pics/iconmonstr-generation-4-240.png){#id .class height=60px}"
                 
IMG2 <- array( NA, dim = c(1, 1))
IMG2[1, 1] <- "![](./Pics/iconmonstr-candy-8-240.png){#id .class height=60px} <br>
               ![](./Pics/iconmonstr-arrow-down-thin-240.png){#id .class height=50px} <br>
               ![](./Pics/iconmonstr-generation-15-240.png){#id .class height=60px}"

  if ( knitr::is_html_output(excludes = "epub")) {

      kable( list( IMG1,
                    ConfoundTable[, c(2, 1, 3)],
                    IMG2),
              caption = "Comparing Groups A and B: An extreme example of confounding",
              format = "html",
              align = "c",
              escape = FALSE) %>%
      kable_styling(full_width = FALSE) #%>%
      #row_spec(row = 0, bold = TRUE)  
    } else {
      kable(  ConfoundTable[, c(2, 1, 3)],
              caption = "Comparing Groups A and B: An extreme example of confounding",
              format = "html",
              align = "c",
              escape = FALSE)
    }
}
```

::: {.importantBox .important data-latex="{iconmonstr-warning-8-240.png}"}
*The groups being compared should be as similar as possible*, apart from the difference being studied (in the *Himalaya 292* example, the diet that they are given).
:::


<div style="float:right; width: 222x; border: 1px; padding:10px">
<img src="Illustrations/pexels-andrea-piacquadio-3768131.jpg" width="200px"/>
</div>


::: {.example #GinkoGroups name="Comparing groups"}
An experiment to study the effect of using ginko to enhance memory [@data:Solomon2002:Ginko] compared two groups: one using ginko ($n = 111$), and one using a pretend, non-active supplement ($n = 108$).
The authors randomly allocated participants to each group, but also compared the two groups to ensure that no obvious differences initially existed between the two groups that might explain any differences in the response variable (Table \@ref(tab:GinkoDemographics)).

The table shows that the two groups are very similar in terms of age, education and gender distribution.
Hence, any difference between the groups can probably be attributed to the treatment.
:::

	
```{r echo=FALSE, GinkoDemographics}
Ginko <- array( dim = c(3, 3) )
colnames(Ginko) <- c("Characteristic", 
                     "Group A (Ginko)", 
		     "Group B (Pretend)")

Ginko[1, ] <- c("Average age (in years)", 
                "68.7", 
		"69.9")
Ginko[2, ] <- c("Men (number; percentage)", 
                "46 (41)", 
		"45 (42)")
Ginko[3, ] <- c("Average years of education", 
                "14.4", 
		"14.0")

if( knitr::is_latex_output() ) {
  kable(Ginko,
        format = "latex",
        longtable = FALSE,
        booktabs = TRUE,
        #escape = FALSE, # For latex to work in \rightarrow
        linesep  =  c("", "", "", "\\addlinespace", "", "", ""), # Otherwise addes a space after five lines... 
        caption = "Comparing the two groups in the ginko-memory study",
        align = c("r", "c", "c"))   %>%
   kable_styling(full_width = FALSE, font_size = 10) %>%
   row_spec(0,bold = TRUE) # Columns headings in bold
}

if( knitr::is_html_output() ) {
  kable(Ginko,
        format = "html",
        align = c("r", "r", "r"),
        longtable = FALSE,
        caption = "Comparing the two groups in the ginko-memory study",
        booktabs = TRUE) 
}
```


Potentially, many extraneous variables exist in the *Himalaya* study, but we will demonstrate by just considering age.
How can we make sure that the age of the participants does not cause confounding in the *Himalaya* study?
Confounding can be *managed* by:

* [**Restricting**](#ExpConfoundingRestricting) the study to a certain group, such as only people under 30 (Sect. \@ref(ExpConfoundingRestricting)).
* [**Blocking**](#ExpConfoundingBlocking):
  Analyse the data separately for different groups, such as for people under 30, and 30 and over (Sect. \@ref(ExpConfoundingBlocking)).
* [**Analysing**](#ExpManagingConfoundingAnalysis) using special methods, after recording the age of each subject (Sect. \@ref(ExpManagingConfoundingAnalysis)).
* [**Randomly allocating**](#ExpConfoundingRandomAllocating) people to groups:
  Older and younger people would be spread approximately evenly between the *Himalaya* and refined-cereal groups (Sect. \@ref(Random-sampling-allocation)).

Multiple approaches can be used, such as randomly allocating individuals to groups, *and* recording other variables that can be managed through analysis (Example \@ref(exm:GinkoGroups)).

The first two approaches (*restricting*; *blocking*) are useful if one or two variables are known, or thought likely, to cause confounding.
The third approach (*analysing*) requires recording all the variables suspected of being confounders.
The fourth approach (*randomly allocating*) is superior if it is possible, because it reduces the chance of confounding for variables not even suspected as being confounding variables.

Common to many of these methods is to ensure that any potential confounding variables are recorded (Sect. \@ref(RecordExtraneous)), to ensure no *lurking variables* exist that may compromise the results.


:::{.exampleExtra  data-latex=""}
Researchers explored the use of dominant and non-dominant hands for chest compression in student paramedics using an experimental study [@cross2019impact].
Students were randomly divided into two groups: DHOS (dominant hand on chest) and NDHOC (non-dominant hand on chest).
The two groups were then compared:

| Demographic                  | All participants ($n = 75$) | DHOC ($n = 37$) | NDHOC ($n = 38$) 
| ----------------------------:+:---------------------------:+:---------------:+:----------------:
| Average age (years)          | 23.4                        | 22.5            | 24.3
| Gender: percentage Female    | 51%                         | 53%             | 47%

The two groups appear to be very similar in terms of average age of participants, and the percentage of female participants.
If differences are observed in the study between the DHOC and NDHOC groups, it is probably due to the treatment.
The study should have reasonable internal validity.
:::


### Restrictions {#ExpConfoundingRestricting}

Sometimes the impact of confounding is managed by *restricting the study to some groups*, by keeping some variables constant.
These variables are called *control variables*.
If possible, a reason for this restriction should be given.


::: {.example #HimalayaRestricting name="Restricting"}
In the *Himalaya* study [@data:Bird2008:wholegrain], the study might be restricted to subjects aged under 30.
The control variable would be 'age'.
:::

   
### Blocking {#ExpConfoundingBlocking}

*Blocking* is sometimes useful for minimising the impacts of confounding.
Blocking refers to separating the units of analysis into a small number of groups of similar individuals, then studying those groups separately. 
The *Himalaya* study might be blocked on age (Fig. \@ref(fig:BlockingHimalaya)).


::: {.definition #Blocking name="Blocking"}
*Blocking* is when units of analysis are arranged in groups (called *blocks*) that are similar to one another, then those groups are studied separately.
:::

(ref:BlockingHimalaya) Blocking in the *Himalaya* study, based on age

```{r BlockingHimalaya, echo=FALSE, message=FALSE, fig.cap="(ref:BlockingHimalaya)", fig.align="center", fig.width=8, fig.height=4, out.width="90%"}
par( mar = c(0.5, 0.5, 0.5, 0.5))
openplotmat()

pos <- array(NA, 
            dim = c(11, 2))
pos[1, ] <- c(0.1, 0.5) # Units Of Analysis

pos[2, ] <- c(0.2, 0.75) # Block 1
pos[3, ] <- c(0.2, 0.25)   # Block 2

pos[4, ] <- c(0.5, 0.85)   # Block 1, Group 1
pos[5, ] <- c(0.5, 0.65)   # Block 1, Group 2

pos[6, ] <- c(0.5, 0.35)   # Block 2, Group 1
pos[7, ] <- c(0.5, 0.15)   # Block 2, Group 2

pos[8, ] <- c(0.85, 0.85)   # Block 1, Group 1
pos[9, ] <- c(0.85, 0.65)   # Block 1, Group 2

pos[10, ] <- c(0.85, 0.35)   # Block 2, Group 1
pos[11, ] <- c(0.85, 0.15)   # Block 2, Group 2

straightarrow(from = pos[1,], 
              to = pos[2,], 
              lty = 1, 
              lcol = "black",
              lwd = 2)
straightarrow(from = pos[1,], 
              to = pos[3,], 
              lwd = 2,
              lcol = "black",
              lty = 1)

straightarrow(from = pos[2,], 
              to = pos[4,], 
              lwd = 2,
              lcol = "black",
              lty = 1)
straightarrow(from = pos[2,], 
              to = pos[5,], 
              lwd = 2,
              lcol = "black",
              lty = 1)

straightarrow(from = pos[3,], 
              to = pos[6,], 
              lwd = 2,
              lcol = "black",
              lty = 1)
straightarrow(from = pos[3,], 
              to = pos[7,], 
              lwd = 2,
              lcol = "black",
              lty = 1)

straightarrow(from = pos[8,], 
              to = pos[4,], 
              lwd = 2,
              lcol = "black",
              lty = 1)
straightarrow(from = pos[9,], 
              to = pos[5,], 
              lwd = 2,
              lcol = "black",
              lty = 1)
straightarrow(from = pos[10,], 
              to = pos[6,], 
              lwd = 2,
              lcol = "black",
              lty = 1)
straightarrow(from = pos[11,], 
              to = pos[7,], 
              lwd = 2,
              lcol = "black",
              lty = 1)

textrect( pos[1,], 
           lab = "Units of\nanalysis", 
           radx = 0.075, 
           rady = 0.09, 
           shadow.size = 0,
           box.col = "antiquewhite",
           col = "black",
           lcol = "antiquewhite")

textrect( pos[2,], 
           lab = "Block 1\n(Under 30)", 
           radx = 0.075, 
           rady = 0.085, 
           shadow.size = 0,
           box.col = "antiquewhite",
           lcol = "antiquewhite")
textrect( pos[3,], 
          lab = "Block 2\n(30+)",
          col = "black",
          radx = 0.085,
          rady = 0.075,
          shadow.size = 0,
          lcol = "antiquewhite",
          box.col = "antiquewhite")

textrect( pos[4,], 
          lab = "Group 1", 
          col = "black",
          radx = 0.11,
          rady = 0.075,
          shadow.size = 0,
          lcol = "darkseagreen1",
          box.col = "darkseagreen1")
textrect( pos[5,],
          col = "black",
          box.col = "darkseagreen1",
          lcol = "darkseagreen1",
          shadow.size = 0,
          radx = 0.11,
          rady = 0.075,
          lab = "Group 2")
textrect( pos[6,], 
          lab = "Group 1", 
          col = "black",
          radx = 0.11,
          rady = 0.075,
          shadow.size = 0,
          lcol = "darkseagreen1",
          box.col = "darkseagreen1")
textrect( pos[7,], 
          col = "black",
          box.col = "darkseagreen1",
          lcol = "darkseagreen1",
          shadow.size = 0,
          radx = 0.11,
          rady = 0.075,
          lab = "Group 2")

textrect( pos[8,], 
          col = "black",
          box.col = "palegoldenrod",
          lcol = "palegoldenrod",
          shadow.size = 0,
          radx = 0.11,
          rady = 0.075,
          lab = "Himalaya")
textrect( pos[9,], 
          col = "black",
          box.col = "palegoldenrod",
          lcol = "palegoldenrod",
          shadow.size = 0,
          radx = 0.11,
          rady = 0.075,
          lab = "Refined")
textrect( pos[10,], 
          col = "black",
          box.col = "palegoldenrod",
          lcol = "palegoldenrod",
          shadow.size = 0,
          radx = 0.11,
          rady = 0.075,
          lab = "Himalaya")
textrect( pos[11,], 
          col = "black",
          box.col = "palegoldenrod",
          lcol = "palegoldenrod",
          shadow.size = 0,
          radx = 0.11,
          rady = 0.075,
          lab = "Refined")

lines( c(0.3, 0.95), c(0.5, 0.5), # Dividing the arms of the study
               col = "grey",
               lty = 2)

# Cereals
plotfunctions::plot_image(img = "./Pics/iconmonstr-candy-5-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.95, 1.00),
                           yrange = c(0.80, 0.90),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-candy-8-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.95, 1.00),
                           yrange = c(0.60, 0.70),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)

plotfunctions::plot_image(img = "./Pics/iconmonstr-candy-5-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.95, 1.00),
                           yrange = c(0.30, 0.40),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-candy-8-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.95, 1.00),
                           yrange = c(0.10, 0.20),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)


# Older people

plotfunctions::plot_image(img = "./Pics/iconmonstr-generation-16-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.14, 0.19),
                           yrange = c(0.05, 0.15),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-generation-15-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.21, 0.26),
                           yrange = c(0.05, 0.15),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)


# Younger people

plotfunctions::plot_image(img = "./Pics/iconmonstr-generation-4-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.14, 0.19),
                           yrange = c(0.85, 0.95),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-generation-7-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.21, 0.26),
                           yrange = c(0.85, 0.95),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
```


### Analysis {#ExpManagingConfoundingAnalysis}

Porential confounding variables---like other extraneous variables---can be accommodated in the analysis (using analyses beyond this book), *provided those variables have been recorded*.
Because of this, *recording all the extraneous variables likely to be important for understanding the data* is important.


::: {.importantBox .important data-latex="{iconmonstr-warning-8-240.png}"}
*Record* all the extraneous variables likely to be important for understanding the data.
This may include information about the *individuals* in the study, and the *circumstances* of the individuals in the study.
:::


For this reason, most studies involving people record the participants' age and sex, as these two variables are common confounders.
Once a sample is obtained, recording this extra information usually requires little extra effort.


::: {.example #HimalayaAnalysis name="Analysis"}
In the *Himalaya 292* study, the sex, age, pre-study weight and pre-study BMI were also recorded for each individual, and used in the subsequent analysis.
:::


::: {.example #Manure name="Analysis"}
An experimental study [@schroder2015maize] compared nitrogen (N) and phosphorus (P) concentrations in maize, for evenly-injected liquid manure and band-injected liquid manure.
As potential confounding variables, the researchers also recorded the average temperature and the precipitation (between May 1 and September 30) at each site.
:::


### Random allocation {#ExpConfoundingRandomAllocating}

One way to minimise confounding is to [randomly](#def:Random) allocate individuals in the study to the treatment groups.
The advantage of random allocation is that it should approximately evenly distribute potential confounding variables that have been identified (such as age) but also those variables that may *not* have even been considered as confounders, or are hard to measure or observe (such as genetic conditions).

In the *Himalaya* study, the units of analysis (the people) could be allocated to a group at random, and then the groups allocated a diet through a toss of a coin (Fig. \@ref(fig:RandomAllocationHimalaya)).


::: {.example #HimalayaRandomAllocation name="Random allocation"}
In the *Himalaya 292* study, the article reports that 'Subjects were allocated randomly to [...] dietary treatments...' (@data:Bird2008:wholegrain, p. 1033).
:::


```{r RandomAllocationHimalaya, echo=FALSE, fig.cap="Random allocation can occur in two places for the Himalaya study", fig.align="center", fig.height=3, out.width='75%'}
par( mar=c(0.5, 0.5, 0.5, 0.5))
openplotmat()

pos <- array(NA, 
             dim = c(5, 2))
pos[1, ] <- c(0.1, 0.5) # Units Of Analysis
pos[2, ] <- c(0.45, 0.75) # Group 1
pos[3, ] <- c(0.45, 0.25)   # Group 2
pos[4, ] <- c(0.75, 0.75)   # Diet H
pos[5, ] <- c(0.75, 0.25)   # Diet R


straightarrow(from = pos[1,], 
              to = pos[2,], 
              lty = 1, 
              lcol = "black",
              lwd = 2)
straightarrow(from = pos[1,], 
              to = pos[3,], 
              lwd = 2,
              lcol = "black",
              lty = 1)
straightarrow(from = pos[4,],
              to = pos[2,], 
              lwd = 2,
              lcol = "black",
              arr.pos = 0.6,
              lty = 1)
straightarrow(from = pos[5,], 
              to = pos[3,], 
              lwd = 2,
              lcol = "black",
              arr.pos = 0.6,
              lty = 1)


textrect( pos[1,], 
          lab = "Units of\nanalysis", 
          radx = 0.075, 
          rady = 0.09, 
          shadow.size = 0,
          box.col = "antiquewhite",
          col = "black",
          lcol = "antiquewhite")
textrect( pos[2,], 
          lab = "Group 1", 
          radx = 0.075, 
          rady = 0.075, 
          shadow.size = 0,
          box.col = "palegoldenrod",
          lcol = "palegoldenrod")
textrect( pos[3,], 
          lab = "Group 2",
          col = "black",
          radx = 0.075,
          rady = 0.075,
          shadow.size = 0,
          lcol = "palegoldenrod",
          box.col = "palegoldenrod")
textrect( pos[4,], 
          lab = "Himalaya diet", 
          col = "black",
          radx = 0.13,
          rady = 0.075,
          shadow.size = 0,
          lcol = "palegoldenrod",
          box.col = "palegoldenrod")
textrect( pos[5,], 
          col = "black",
          box.col = "palegoldenrod",
          lcol = "palegoldenrod",
          shadow.size = 0,
          radx = 0.13,
          rady = 0.075,
          lab = "Refined cereal diet")

textrect( c( mean( pos[1:2, 1] ), 0.5),
          radx = 0.001,
          rady  = 0.001,
          lcol = "white",
          box.col = "white",
          shadow.size = 0,
          cex = 1.5,
          lab = "Random allocation",
          col = "grey",
          srt = 90)


textrect( c( mean( pos[3:4, 1] ) - 0.033, 0.5),
          radx = 0.001,
          rady  = 0.001,
          lcol = "white",
          box.col = "white",
          shadow.size = 0,
          cex = 1.5,
          lab = "Random allocation",
          col = "grey",
          srt = 90)

# Cereals
plotfunctions::plot_image(img = "./Pics/iconmonstr-candy-5-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.90, 0.95),
                           yrange = c(0.70, 0.82),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-candy-8-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.90, 0.95),
                           yrange = c(0.20, 0.32),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
```


Individuals may be randomly allocated to groups (true experiment), and/or groups may be randomly allocated treatments (true or quasi-experiment).
Random allocation can be shown, in general, as in Fig. \@ref(fig:RandomAllocationGeneral2).


```{r RandomAllocationGeneral2, echo=FALSE, fig.cap="Random allocation in general", fig.align="center", fig.height=3, out.width='75%'}
par( mar = c(0.5, 0.5, 0.5, 0.5))
openplotmat()

pos <- array(NA, dim=c(7, 2))
pos[1, ] <- c(0.1, 0.5) # Units Of Analysis
pos[2, ] <- c(0.45, 0.75) # Group 1
pos[3, ] <- c(0.45, 0.25)   # Group 3
pos[4, ] <- c(0.85, 0.75)   # Diet H
pos[5, ] <- c(0.85, 0.25)   # Diet R

pos[6, ] <- c(0.45, 0.5) # Group 2
pos[7, ] <- c(0.85, 0.5)

straightarrow(from = pos[1,], to = pos[2,], 
            lty = 1, 
            lcol = "black",
            lwd = 2)
straightarrow(from = pos[1,], to = pos[3,], 
              lwd = 2,
            lcol = "black",
            lty = 1)
straightarrow(from = pos[1,], to = pos[6,], 
              lwd = 2,
            lcol = "black",
            lty = 1)
straightarrow(from = pos[4,], to = pos[2,], 
            lwd = 2,
            lcol = "black",
            lty = 1)
straightarrow(from = pos[5,], to = pos[3,], 
            lwd = 2,
            lcol = "black",
            lty = 1)
straightarrow(from = pos[7,], to = pos[6,], 
            lwd = 2,
            lcol = "black",
            lty = 1)


textrect( pos[1,], 
           lab = "Units of\nanalysis", 
           radx = 0.075, 
           rady = 0.09, 
           shadow.size = 0,
           box.col = "antiquewhite",
           col = "black",
           lcol = "antiquewhite")
textrect( pos[2,], 
           lab = "Group 1", 
           radx = 0.075, 
           rady = 0.075, 
           shadow.size = 0,
           box.col = "darkseagreen1",
           lcol = "darkseagreen1")
textrect( pos[6,], 
           lab = "Group 2", 
           radx = 0.075, 
           rady = 0.075, 
           shadow.size = 0,
           box.col = "darkseagreen1",
           lcol = "darkseagreen1")

textrect( pos[3,], 
          lab = "Group 3",
          col = "black",
          radx = 0.075,
          rady = 0.075,
          shadow.size = 0,
          lcol = "darkseagreen1",
          box.col = "darkseagreen1")
textrect( pos[4,], 
          lab = "Treatment 1", 
          col = "black",
          radx = 0.11,
          rady = 0.075,
          shadow.size = 0,
          lcol = "palegoldenrod",
          box.col = "palegoldenrod")
textrect( pos[5,], 
          col = "black",
          box.col = "palegoldenrod",
          lcol = "palegoldenrod",
          shadow.size = 0,
          radx = 0.11,
          rady = 0.075,
          lab = "Treatment 3")

textrect( pos[7,], 
          col = "black",
          box.col = "palegoldenrod",
          lcol = "palegoldenrod",
          shadow.size = 0,
          radx = 0.11,
          rady = 0.075,
          lab = "Treatment 2")



textrect( c( mean( pos[1:2, 1] ), 0.5),
          radx = 0.001,
          rady = 0.001,
          lcol = "white",
          box.col = "white",
          shadow.size = 0,
          cex = 1.5,
          lab = "Random allocation",
          col = "grey",
          srt = 90)


textrect( c( mean( pos[3:4, 1] ), 0.5),
          radx = 0.001,
          rady = 0.001,
          lcol = "white",
          box.col = "white",
          shadow.size = 0,
          cex = 1.5,
          lab = "Random allocation",
          col = "grey",
          srt = 90)
```
	

### Random allocation vs random sampling {#Random-sampling-allocation}

Random *sampling* and random *allocation* are different concepts (Fig. \@ref(fig:RandomAllocationSampling)), that serve different purposes, but are often confused:

* *Random sampling* impacts *external* validity, and concerns *how to find the sample* to study.
* *Random allocation* helps eliminate confounding issues, by evening-out possible confounders across treatment groups.
  *Random allocation* impacts *internal* validity, and concerns *how the members of the chosen sample get the treatments*.


```{r RandomAllocationSampling, echo=FALSE, fig.cap="Comparing random allocation and random sampling", fig.align="center", fig.height=3, out.width='75%'}
par( mar=c(0.5, 0.5, 0.5, 0.5))
openplotmat()

pos <- array(NA, 
             dim = c(6, 2))
pos[1, ] <- c(0.35, 0.5) # Units Of Analysis
pos[2, ] <- c(0.6, 0.75) # Group 1
pos[3, ] <- c(0.6, 0.25)   # Group 2
pos[4, ] <- c(0.85, 0.75)   # Diet H
pos[5, ] <- c(0.85, 0.25)   # Diet R
pos[6, ] <- c(0.1, 0.5) # POPULATION


# Text for internal, external validity
polygon( x = c(0.00, 0.00, 0.45, 0.45),
         y = c(0.00, 1.00, 1.00, 0.00),
         lwd = 2,
         border = "grey")
text( x = 0.225,
      y =  0.05,
      labels = "External validity")

polygon( x = c(0.45, 0.45, 1.00, 1.00),
         y = c(0.00, 1.00, 1.00, 0.00),
         lwd = 2,
         border = "grey")
text( x = 0.725,
      y =  0.05,
      labels = "Internal validity")




textrect( c( mean( pos[3:4, 1] ), 0.5),
          radx = 0.001,
          rady  = 0.001,
          lcol = "white",
          box.col = "white",
          shadow.size = 0,
          cex = 1.5,
          lab = "Random allocation",
          col = "grey",
          srt = 90)

textrect( c( mean( pos[ c(1, 6), 1] ), 0.5),
          radx = 0.001,
          rady  = 0.001,
          lcol = "white",
          box.col = "white",
          shadow.size = 0,
          cex = 1.5,
          lab = "Random sampling",
          col = "grey",
          srt = 90)

straightarrow(from = pos[1,], 
              to = pos[2,], 
              lty = 1, 
              lcol = "black",
              lwd = 2)
straightarrow(from = pos[1,], 
              to = pos[3,], 
              lwd = 2,
              lcol = "black",
              lty = 1)
straightarrow(from = pos[4,], 
              to = pos[2,], 
              lwd = 2,
              lcol = "black",
              lty = 1)
straightarrow(from = pos[5,], 
              to = pos[3,], 
              lwd = 2,
              lcol = "black",
              lty = 1)


textrect( pos[6,], 
           lab = "Population\nunits of\nanalysis", 
           radx = 0.075, 
           rady = 0.40, 
           shadow.size = 0,
           box.col = "grey",
           col = "black",
           lcol = "grey")


# Taking the sample
straightarrow(from = c(0.1, 0.7), 
              to = pos[1,], 
              lwd = 2,
              lcol = "black",
              lty = 1)
straightarrow(from = c(0.15, 0.6), 
              to = pos[1,], 
              lwd = 2,
              lcol = "black",
              lty = 1)
straightarrow(from = c(0.09, 0.18), 
              to = pos[1,], 
              lwd = 2,
              lcol = "black",
              lty = 1)
straightarrow(from = c(0.12, 0.33), 
              to = pos[1,], 
              lwd = 2,
              lcol = "black",
              lty = 1)
straightarrow(from = c(0.06, 0.36), 
              to = pos[1,], 
              lwd = 2,
              lcol = "black",
              lty = 1)
######


textrect( pos[1,], 
           lab = "Sample\nunits of\nanalysis", 
           radx = 0.075, 
           rady = 0.18, 
           shadow.size = 0,
           box.col = "antiquewhite",
           col = "black",
           lcol = "antiquewhite")
textrect( pos[2,], 
           lab = "Group 1", 
           radx = 0.07, 
           rady = 0.075, 
           shadow.size = 0,
           box.col = "darkseagreen1",
           lcol = "darkseagreen1")

textrect( pos[3,], 
           lab = "Group 2",
          col = "black",
          radx = 0.07,
          rady = 0.075,
          shadow.size = 0,
          lcol = "darkseagreen1",
          box.col = "darkseagreen1")
textrect( pos[4,], 
          lab = "Treatment 1", 
          col = "black",
          radx = 0.09,
          rady = 0.075,
          shadow.size = 0,
          lcol = "palegoldenrod",
          box.col = "palegoldenrod")
textrect( pos[5,], 
          col = "black",
          box.col = "palegoldenrod",
          lcol = "palegoldenrod",
          shadow.size = 0,
          radx = 0.09,
          rady = 0.075,
          lab = "Treatment 2")

textrect( c( mean( pos[1:2, 1] ), 0.5),
          radx = 0.001,
          rady  = 0.001,
          lcol = "white",
          box.col = "white",
          shadow.size = 0,
          cex = 1.5,
          lab = "Random allocation",
          col = "grey",
          srt = 90)
```


<iframe src="https://learningapps.org/watch?v=poh7e35e222" style="border:0px;width:100%;height:500px" allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true"></iframe>
 
 
## Carry-over effect and washout periods {#CarryOverEffectExperimental}

In the *Himalaya* study, suppose patients spent two weeks on the *Himalaya 292* diet, then the next two weeks on the refined cereal diet.
Potentially, the influence of the first diet could still be impacting the subjects' faecal weight for a little while after stopping the first diet.
This could compromise the [internally validity](#def:InternalValidity) of the study.
This is an example of the *carry-over effect*.
This may mean that the influence of one treatment carries over into the influence of the next treatment.


<div style="float:right; width: 75px; padding:10px">
<img src="Pics/iconmonstr-chart-21-240.png" width="50px"/>
</div>


::: {.definition #CarryoverEffect name="Carryover effect"}
The carry-over effect occurs when the influence of past experience(s) of the individuals carry over to influence future experience(s) of the individuals.
:::

The impact of the carry-over effect may be minimized by using a *washout* or similar.
For example, after tasting a food sample, participants may rinse their mouth with water before tasting another food sample.
For the *Himalaya* study, the participants could spend four weeks between the two special diets on their usual (before-study) diet, called a *washout period*.


<div style="float:right; width: 222x; border: 1px; padding:10px">
<img src="Illustrations/pexels-gil-goldman-4268507.jpg" width="200px"/>
</div>


::: {.example #HimalayaCarryOver name="Carry-over effect"}
In the *Himalaya 292* study, the authors report that 'there was no washout period' (@data:Bird2008:wholegrain, p. 1033) since the response variable was only recorded after individuals spent four weeks on the diets.
Since faecal weight was not measured until the end of thos four weeks, the effect of the diet change would be minimal.
:::


::: {.example #HimalayaWashout name="Washout"}
An engineering study [@miller2019behavioral] examined drivers' exposure to lane-keeping systems on their driving performance.
Subjects were exposed to a driving simulation that used a lane-keeping system, and then to a driving simulation without using a lane-keeping system.
The researchers found that there was a carry-over effect when drivers moved from a simulation with a lane-keeping system to one without a lane-keeping system.
:::


```{r, Washout, echo=FALSE, fig.align="center", fig.cap="Using a 'washout' period to minimize the carry-over effect", fig.width=8.5, out.width='85%'}
par( mar = c(0.5, 0.5, 0.5, 0.5))
openplotmat(asp = 1)
#openplotmat()

textrect( c(0.50, 0.80),
          lab = "Without a washout period, treatments are applied straight after each other",
          box.col = "white",
          lcol = "white",
          radx = 0.1, 
          rady = 0.1,
          shadow.size = 0)


# No washout
plotfunctions::plot_image(img = "./Pics/iconmonstr-candy-5-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.12, 0.22),
                           yrange = c(0.66, 0.76),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-arrow-17-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.27, 0.37),
                           yrange = c(0.66, 0.76),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-ruler-26-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.42, 0.52),
                           yrange = c(0.66, 0.76),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)

plotfunctions::plot_image(img = "./Pics/iconmonstr-candy-8-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.58, 0.68),
                           yrange = c(0.66, 0.76),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-arrow-17-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.73, 0.83),
                           yrange = c(0.66, 0.76),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-ruler-26-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.88, 0.98),
                           yrange = c(0.66, 0.76),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)

# With washout
plotfunctions::plot_image(img = "./Pics/iconmonstr-candy-5-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.00, 0.10),
                           yrange = c(0.33, 0.43),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-arrow-17-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.14, 0.24),
                           yrange = c(0.33, 0.43),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-ruler-26-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.28, 0.38),
                           yrange = c(0.33, 0.43),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
textrect( c(0.5, 0.38),
          lab = "Washout\nperiod",
          box.col = "aliceblue",
          lcol = "aliceblue",
          radx = 0.09, 
          rady = 0.07, 
          shadow.size = 0)
plotfunctions::plot_image(img = "./Pics/iconmonstr-candy-8-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.62, 0.72),
                           yrange = c(0.33, 0.43),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-arrow-17-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.76, 0.86),
                           yrange = c(0.33, 0.43),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-ruler-26-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.90, 01.00),
                           yrange = c(0.33, 0.43),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
textrect( c(0.50, 0.20),
          lab = "Using a  washout period, a break occurs between treatments",
          box.col = "white",
          lcol = "white",
          radx = 0.1, 
          rady = 0.1, 
          shadow.size = 0)
```


Sometimes, researchers can *randomly allocate* the *order* in which the treatments (i.e., the diets) are used (a *cross-over study*).
That is, some participants start by spending four weeks on the *Himalaya 292* diet, then four weeks on the refined cereal diet; meanwhile, other participants start by spending four weeks on the refined cereal diet, then four weeks on the *Himalaya 292* diet.

::: {.example #HimalayaCarryOver2 name="Carry-over effect"}
In the *Himalaya 292* study, the authors report that "subjects were allocated randomly to [...] dietary treatments" (@data:Bird2008:wholegrain, p. 1033).
Subjects were randomly allocated to begin the study on the *Himalaya 292* diet, while others started on the refined cereal diet.
:::

::: {.example #ParamedOrder name="Washout periods"}
A study of paramedics [@data:MacDonald:Resuscitation] required paramedics to conduct eight different tasks (such as electrical defibrillation and intravenous cannulation).
The *order* in which each of the 16 paramedics performed the eight tasks was arranged so that not every paramedic started with Task 1, followed by Task 2, etc. to "control for possible effects of practice" (p.&nbsp; 255); that is, to mitigate the carry-over effect.
A washout period between tasks was also used.
:::


## Hawthorne effect and blinding individuals {#HawthorneEffectExperimental}

Suppose patients in the *Himalaya 292* study were being watched (or waited for) while defecating.
Could this lead to a misleading conclusion?
People often behave differently (either positively or negatively) if they know (or think) they are in a study, or are being watched, which could compromise the [internal validity](#def:InternalValidity) of the study.
This is called the *Hawthorne effect*.


<div style="float:right; width: 75px; padding:10px">
<img src="Pics/iconmonstr-binoculars-8-240.png" width="50px"/>
</div>


::: {.definition #HawthorneEffect name="Hawthorne effect"}
The Hawthorne effect is the tendency of individuals to change their behaviour if they know (or think) they are being observed.
:::


<div style="float:right; width: 222x; border: 1px; padding:10px">
<img src="Illustrations/pexels-gil-goldman-4268507.jpg" width="200px"/>
</div>


::: {.example #HawthorneFruitVege name="Hawthorne effect"}
People are more health-conscious if they know they will be followed-up on a regular basis.
For example, a study aiming to increase fruit and vegetable intake in young adults [@clark2019educational] noted that the changes recorded "could be explained by the Hawthorne effect", since being in the study "can inherently cause participants to change behavior because they know they are being observed..." [@clark2019educational].
:::


The impact of the Hawthorne effect can be minimized by [blinding](#Blinding) the individuals in the experiment so that the individuals do not know:

* that they are in a study;
* the aims of the study; and/or 
* which treatment they are receiving in the study. 

If individuals do not know which treatment they receiving, they cannot behave differently according to the treatment they receive, but their behaviour may still chance if they know they are in a study.
Blinding *people* to knowing they are involved in a study is often difficult, as ethics usually requires individuals' informed consent.


::: {.example #HawthorneHimalaya name="Hawthorne effect"}
In the *Himalaya 292* study, the authors report:

> The study was explained fully to the subjects, both verbally and in writing, and each gave their written, informed consent before participating. 
> 
> --- @data:Bird2008:wholegrain, p. 1033

That is, the subjects knew they were in a study, which was an ethics requirement, so the Hawthorne effect may influence the results in this study.
However, the subjects did not know which diet they were on (@data:Bird2008:wholegrain, p. 1033).
:::


<div style="float:right; width: 222x; border: 1px; padding:10px">
<img src="Illustrations/pexels-photomix-company-216729.jpg" width="200px"/>
</div>


::: {.example #HawthorneTeeth name="Hawthorne effect"}
In an experimental study [@lorenz2019effect] to compare the efficacy of a new type of toothpaste, participants were given two types of toothpaste to use (new type; existing type), and evaluations of plaque remaining on the teeth were taken.
Both groups recorded a reduced amount of plaque.
The authors state that the reason was the Hawthorne effect since all participants knew they were being assessed after brushing their teeth, so brushed differently the usual.
:::


## Placebo effect and using controls {#PlaceboEffectExperimental}

Suppose people *thought* they were on the wholegrain diet, but they weren't.
Perhaps surprisingly, individuals in a study may report effects of a treatment (either positive or negative), even if they have not received an active treatment.
This could compromise the [internally validity](#def:InternalValidity) of the study.
This is called the *placebo effect*, which generally only impacts people as individuals.


<div style="float:right; width: 75px; padding:10px">
<img src="Pics/iconmonstr-help-3-240.png" width="50px"/>
</div>


::: {.definition #PlaceboEffect name="Placebo effect"}
The placebo effect is when individuals report perceived or actual effects without having received the treatment.
:::

Managing the placebo effect is difficult! 
However, the impact of the placebo effect can be minimized using a *control group*: units of analysis without the treatment applied, but *as similar as possible* in every other way to those units of analysis receiving the treatment.
This allows the effect of the treatment to be assessed, *over and above* the placebo effect.
In addition, recording objective data (rather than patient-reported outcomes) may reduce the placebo effect [@enck2013placebo].


::: {.definition #Control name="Control"}
A *control* is a unit of analysis without the treatment applied, but as similar as possible in *every other way* to other units of analysis.
:::


Sometimes the control group receives a *placebo*: a non-effective treatment.
Those who receive the placebo should be selected through random allocation when possible.
Sometimes, using a placebo is unethical.
The
`r if (knitr::is_latex_output()) {
   'Wikipedia entry about placebos'
} else {
   '[Wikipedia entry about placebos](http://en.wikipedia.org/wiki/Placebo)'
}`
is intriguing.


::: {.definition #Placebo name="Placebo"}
A *placebo* is a treatment with no intended effect or active ingredient.
:::


::: {.example #HimalayaPlacebo name="Placebo effect"}
In the *Himalaya 292* study, the authors report that the individuals "were not told the identity of the test cereal in the foods provided" (@data:Bird2008:wholegrain, p. 1033).
The subjects were [blinded](#Blinding) to the diet they were exposed to.
However, some may *think* they are on the refined cereal or *Himalaya* diet, and respond accordingly (perhaps unconsciously).
:::


::: {.thinkBox .think data-latex="{iconmonstr-light-bulb-2-240.png}"}
To test the effectiveness of a new drug, patients are to report to a GP to receive injections of a new drug.
We wish to compare to people who do not get the injection.
Describe how the control group is 'treated'.\label{thinkBox:Control}

`r if (!knitr::is_html_output()) '<!--'`
`r webexercises::hide()`
The controls are **not** just people who don't get the injections. 
Ideally, controls would be people who, like the treatment group, report to a GP and receive an injection... however, they just receive an injection that will do nothing.
`r webexercises::unhide()`
`r if (!knitr::is_html_output()) '-->'`
:::


::: {.example #PlaceboColours name="Placebo effect"}
Three active analgesics (pain relievers) were compared to a placebo [@data:Huskisson1974:placebo].
Four different coloured placebos were used.
The most pain relief was experienced by those taking *red* placebos (Fig. \@ref(fig:Placebos)), who experienced even more pain relief than those given true pain relievers.
Note that 'pain relief' is subjective.
:::


```{r Placebos, echo=FALSE, fig.align="center", out.width='70%', fig.width=5.75, fig.height=4, fig.cap="Pain relief, for various pain relief medicine and placebos"}
pe <- read.csv("./Data/Placebos.csv")

### dput(pe) from the file  "placeboeffect.R:
### pe <- read.csv("placeboeffect.csv", header=TRUE)

par( xpd = TRUE,   # Allows plotting outside plot area
     mar = c(4, 3, 4, 4) + 0.1 )  # DEFAULT: c(5, 4, 4, 2) + 0.1
	 
plot( c(0, 2.75) ~ range(Time), 
      data = pe,
      las = 1, 
      type = "n", 
      axes = FALSE,
      main = "Pain relief for various medications",
      xlab = "Time (hours)", 
      ylab = "Pain relief score")
axis(side = 1)
axis(side = 2,
     las = 1,
     at = seq(0, 2, by = 0.5))
box()

# abline seems to go outside margins...? Because of xpd?
lines( x = c(0, 4),
       y = c(1, 1), 
       lty = 2,
       col = "grey")
lines( x = c(0, 4),
       y = c(2, 2), 
       lty = 2,
       col = "grey")
mtext(" Moderate\n relief",
      side = 4,
      at = c(5.75, 2),
      las = 1,
      adj = 0,
      cex = 0.9)
mtext(" Slight\n relief",
      side = 4,
      at = c(5.5, 1),
      las = 1,
      adj = 0,
      cex = 0.9)

lines( Asp ~ Time, 
       data = pe,
       col = "black", 
       lty = 1,
       lwd = 3)

lines( Placebo ~ Time, 
       data = pe,
       col = "orange", 
       lty = 2,
       lwd = 3)

lines( PlaceboRed ~ Time, 
       data = pe,
       lty = 3,
	     col = "red", 
       lwd = 2)

legend("top", 
	col = c("red", 
	        "black", 
	        "orange"), 
	lwd = 2, 
	lty = c(3, 1, 2),
	bty = "n",
	ncol = 2,
	#horiz = TRUE,
	legend = c("Red placebos", 
	           "Aspirin", 
	           "All Placebos"))
```


::: {.example #PlaceboPrice name="Placebo effect"}
A study of placebos [@data:Waber2008:Placebo] gave half the subjects a placebo, but told them that the pill was an expensive (implying 'very effective') pain killer (\$2.50 per tablet).
The other half were also given a placebo, but were told that the pill was a discount (implying 'less effective')  pain killer (\$0.10 per tablet).
About 85% of participants in the first group reported a pain reduction, yet only 61% in the second group reported a pain reduction.
Remember: *both* groups actually received a placebo!
Again, 'pain relief' is subjective.
:::


## Observer effect and blinding researchers {#ObserverEffectExperimental}

Suppose the *researchers* assessing the outcomes *knew the diet* allocated to each patient, and were hoping that the new diet performed better than the refined cereal diet.
Could this lead to a misleading conclusion?

Perhaps surprisingly, researchers' expectations or hopes for how the new diet will perform may unconsciously influence how the researchers interact with the individuals, and perhaps (unconsciously) influence the behaviour of the individuals in the study.
This is called *observer effect*.
(In experiments, it is sometimes called the *experimenter effect*.)
This could compromise the [internally validity](#def:InternalValidity) of the study.


<div style="float:right; width: 75px; padding:10px">
<img src="Pics/iconmonstr-idea-10-240.png" width="50px"/>
</div>


::: {.definition #ObserverEffect name="Observer effect"}
The observer effect occurs when the researchers unconsciously change their behaviour to conform to expectations because they know what values of the explanatory variable apply to the individuals.
This may cause the *individuals* to change their behaviour or reporting also.
:::


The impact of the observer effect can be minimized by blinding the researchers so that they do not know which treatments the individuals are receiving.
The researchers *giving* the treatment and the researchers *evaluating* the treatment can both be blinded, by using a third party.  
For example, the researchers may give an assistant two drugs, labelled A and B.
The assistant administers the drug and evaluates the participants' response to the treatments.
Later, the assistant tells the researchers whether Drug A or Drug B performed better, but only the researchers know which drugs the labels A and B refer to.


```{r, BlindingThirdParty, echo=FALSE, fig.align="center", fig.cap="Using a third party to avoid the observer effect", fig.width=8.5, out.width='85%'}
par( mar = c(0.5, 0.5, 0.5, 0.5))

openplotmat()

textrect( c(0.50, 0.80),
          lab = "Without a washout period, treatments are applied straight after each other",
          box.col = "white",
          lcol = "white",
          radx = 0.1, 
          rady = 0.1,
          shadow.size = 0)


# No washout
plotfunctions::plot_image(img = "./Pics/iconmonstr-candy-5-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.12, 0.22),
                           yrange = c(0.66, 0.76),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-arrow-17-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.27, 0.37),
                           yrange = c(0.66, 0.76),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-ruler-26-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.42, 0.52),
                           yrange = c(0.66, 0.76),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)

plotfunctions::plot_image(img = "./Pics/iconmonstr-candy-8-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.58, 0.68),
                           yrange = c(0.66, 0.76),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-arrow-17-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.73, 0.83),
                           yrange = c(0.66, 0.76),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-ruler-26-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.88, 0.98),
                           yrange = c(0.66, 0.76),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)

# With washout
plotfunctions::plot_image(img = "./Pics/iconmonstr-candy-5-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.00, 0.10),
                           yrange = c(0.33, 0.43),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-arrow-17-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.14, 0.24),
                           yrange = c(0.33, 0.43),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-ruler-26-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.28, 0.38),
                           yrange = c(0.33, 0.43),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
textrect( c(0.5, 0.38),
          lab = "Washout\nperiod",
          box.col = "aliceblue",
          lcol = "aliceblue",
          radx = 0.09, 
          rady = 0.07, 
          shadow.size = 0)
plotfunctions::plot_image(img = "./Pics/iconmonstr-candy-8-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.62, 0.72),
                           yrange = c(0.33, 0.43),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-arrow-17-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.76, 0.86),
                           yrange = c(0.33, 0.43),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(img = "./Pics/iconmonstr-ruler-26-240.png",
                           type = "png",
                           keep.ratio = TRUE,
                           xrange = c(0.90, 01.00),
                           yrange = c(0.33, 0.43),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
textrect( c(0.50, 0.20),
          lab = "Using a  washout period, a break occurs between treatments",
          box.col = "white",
          lcol = "white",
          radx = 0.1, 
          rady = 0.1, 
          shadow.size = 0)
```



::: {.example #ObsEffectyPain name="Observer effect"}
In an experimental study [@seo2020role] that examined the impact of an injection to alleviate post-operative umbilical pain, the authors stated:

> ...the postoperative pain scores were gathered by a nurse practitioner who was blinded to the usage of bupivacaine to avoid observer-expectancy bias [i.e., the observer effect].
>
> --- @seo2020role, p. 392
:::


The observer effect does not just apply to situations where *people* are used as participants.


::: {.example #CleverHans name="Observer effect"}
`r if (knitr::is_latex_output()) {
   'Clever Hans'
} else {
   '['Clever Hans'](https://en.wikipedia.org/wiki/Clever_Hans)'
}`
was a horse that seemed to perform simple mental arithmetic.
After much study, Carl Stumpf realised that the horse was responding to involuntary (and unconscious) cues from the trainer, after using an experiment where the people interacting with the horse were blinded.

The same effect has been observed in narcotic sniffer dogs [@bambauer2012defending], who may respond to their handlers' unconscious cues.
:::


::: {.importantBox .important data-latex="{iconmonstr-warning-8-240.png}"}
The *observer effect* is when the researcher *unconsciously* influences the individuals, and are not aware it is occurring.
*Intentionally* influencing the individuals is called [fraud](#Fraud).
:::


<iframe src="https://learningapps.org/watch?v=puedghp1c22" style="border:0px;width:100%;height:500px" allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true"></iframe>


## Describing blinding {#DescribingBlinding}

*Blinding* is when those involved in the study do not know information about the study.
Those involved in the study may not know:

* that they are in a study at all;
* the purpose of the study; and/or 
* which comparison or connection value(s) apply to them.

Different individuals involved in the study can be blinded:

* A study can blind the **participants** to knowing what comparison group they are in.
* A study can blind the **researcher** to knowing what comparison group the study individuals are in.
* A study can blind the **analysts** to knowing what comparison group the individuals are in during analysis.

When as many participants are blinded as possible, the internal validity of the study is increased and bias reduced.
However, when people are the individuals, ethics requirements often mean that they need to know they are in a study, and the purpose of the study.

If *only* the participants are blinded, the study is called *single blind*.
If *both* the researchers and participants are blinded, the study is called *double blind*.
If the researchers, participants *and* the analyst are blinded, the study is called *triple blind*.
For clarity, we recommend explicitly stating who or what is blinded.
Blinding should be considered in all studies, when possible (and it is *not* always possible).
*Blinding of participants does not just apply to people*; it is applies to animals (Example \@ref(exm:CleverHans) about Clever Hans).


::: {.thinkBox .think data-latex="{iconmonstr-light-bulb-2-240.png}"}
Why might it be necessary to blind the *analyst* to the treatments being used?
:::


::: {.example #BlindingParamedic  name="Blinding"}
In a study comparing chest compressions with dominant and non-dominant hands of student paramedics [@cross2019impact], the article states that the individuals "were blinded to the specific research question at any stage to reduce the chance of performance bias..." (@cross2019impact, p. 2).
Participants could not, however, be blinded to which group they were in (dominant hand on chest; non-dominant hand on chest).
In this case, participants were only *partially* blinded.

Later, the article reports that "Data were analysed by a biostatistician blinded to group allocation" (@cross2019impact, p. 3).
This means that the analyst was blinded to the treatments.
:::


::: {.example #BlindingCowpea name="Double-blinding"}
In a cropping study comparing yields from modern and traditional cowpea crops in Tanzania, the researchers wanted to use a double-blind study, so:

> ...it was important that the traditional and modern seed looked exactly the same---the seed types must be indistinguishable in terms of size and color.
> 
> While information about seed type may be gradually revealed as the crop matures in the field, this does not invalidate our design because key inputs were already provided. \smallskip
>
> Since the modern seed was treated with purple powder, we also dusted the traditional type, and clearly communicated this to the farmers---they knew that seed type could not be inferred from the color.
>
> @bulte2014behavioral, p. 817--818; line breaks added
:::


## Extraneous variables {#RecordExtraneous}

One way to design a quality study is to record information about many extraneous variables.
Various reasons for this have been given for recording the values of potential explanatory variables:

* To compare the sample to the population, to see if the sample is representative (Sect. \@ref(Representative-samples)).
* To explain some variation in the response variable, so that the relationship between the response and explanatory variable can be revealed. (Sect. \@ref(ExtraneousVariables)).
* To manage confounding:
  * To avoid lurking variables (Sect. \@ref(ExtraneousVariables)).
  * To determine if the groups being compared are similar (Sect. \@ref(ExpManagingConfounding)).
  * To use the information in analysis (Sect. \@ref(ExpManagingConfoundingAnalysis)).


## Design issues: Overview {#DesignIssuesSolutions}

In summary, issues to consider when designing a study, when possible, include:

* Minimising confounding (and *lurking variables*);
* Minimising the *carry-over* effect;
* Minimising the *Hawthorne* effect;
* Minimising the *placebo* effect;
* Minimising the *observer* effect.
* Recording potential explanatory variables.

These issues are important to understand, so studies can be properly designed to maximise internal validity.
This ensures that the results and conclusions from our studies are correctly interpreted.

Often, however, some (or all) of these issues cannot always managed (Table \@ref(tab:BiasesStudied)).
For instance, individuals often know they are involved in an experimental study (Hawthorne effect).
In these cases, the impacts should be minimized as far as possible, and then the likely impact on the conclusions discussed.
The impact of these issues are often reported as *limitations* in a journal article (Chap. \@ref(Interpretation)), perhaps part of the Discussion section.



```{r BiasesStudied, echo=FALSE}
Biases <- array(NA, 
                dim = c(5, 3) )


if( knitr::is_latex_output() ) {
  Biases[1, ] <-  c("Hawthorne effect",
                    "\\textbullet\\enskip\\textbf{Individuals} are aware of being in a study",
                    "Behaviour of, or reporting by, \\textbf{individuals}")
  Biases[2, ] <- c("",
                   "\\textbullet\\enskip\\textbf{Individuals} are aware of explanatory variable value", 
                   "")
  Biases[3, ] <-  c("Placebo effect",
                    "\\textbullet\\enskip\\textbf{Individuals} \\emph{think} they are in a study",
                    "Behaviour of, or reporting by, \\textbf{individuals}")
  Biases[4, ] <- c("  ",
                   "\\textbullet\\enskip\\textbf{Individuals} \\emph{think} they have a specific value for explanatory variable",
                   "")
  Biases[5, ] <-  c("Observer effect",
                    "\\textbullet\\enskip\\textbf{Researcher} is aware of explanatory variable value",
                    "Behaviour of \\textbf{researchers} changes (unconsciously) to \\emph{conform} to expectations, and perhaps communicated to \\textbf{individuals} who may also act or report differently")
  
  
  knitr::kable(Biases,
               format = "latex",
               longtable = FALSE,
               booktabs = TRUE,
               escape = FALSE,
               caption = "Different design biases studied in this book related to the researchers and the individuals",
               col.names = c("Name", 
                             "Who/what is aware of", 
                             "What changes or is compromised")) %>%
    kable_styling(font_size = 10) %>%
    row_spec(0, bold = TRUE)%>%
    column_spec(column = 1, width = "28mm") %>%
    column_spec(column = 2, width = "55mm") %>%
    column_spec(column = 3, width = "65mm")
}
if( knitr::is_html_output() ) {
  Biases[1, ] <-  c("[Hawthorne effect](#HawthorneEffectExperimental)",
                    "**Individuals** are aware of being in a study",
                    "Behaviour of, or reporting by, **individuals**")
  Biases[2, ] <- c("",
                   "**Individuals** are aware of explanatory variable value", 
                   " . ")
  Biases[3, ] <-  c("[Placebo effect](#PlaceboEffectExperimental)",
                    "**Individuals** *think* they are in a study",
                    "Behaviour of, or reporting by, **individuals**")
  Biases[4, ] <- c("  ",
                   "**Individuals** *think* they have a specific value for explanatory variable",
                   "")
  Biases[5, ] <-  c("[Observer effect](#ObserverEffectExperimental)",
                    "**Researcher** is aware of explanatory variable value",
                    "Behaviour of **researchers** changes (unconsciously) to *conform* to expectations, and perhaps communicated to **individuals** who may also act or report differently")
  
  
  knitr::kable(Biases,
               format = "html",
               longtable = FALSE,
               booktabs = TRUE,
               caption = "Different design biases studied in this book related to the researchers and the individuals",
               col.names = c("Name", 
                             "Who/what is aware of what", 
                             "What changes or is compromised"))
}
```



(ref:DesignConsiderations-Caption) Design considerations. Note: Lurking variables become confounding variables when measured, observed, assessed or recorded in the study, and then they can be managed. The arrows mean that the design issue can be **partially** managed by the indicated means

```{r DesignConsiderations, echo=FALSE, fig.cap='(ref:DesignConsiderations-Caption)', out.width='90%', fig.align="center", fig.height=6, fig.width=7.25}
par( mar = c(0.5, 0.5, 0.5, 0.5))
openplotmat()

pos <- array(NA, dim = c(14, 2))

# Biases
pos[1, ] <- c(0.45, 0.90) # Confounding
pos[2, ] <- c(0.45, 0.70) # Carryover
pos[3, ] <- c(0.45, 0.50) # Hawthorne
pos[4, ] <- c(0.45, 0.30) # Placebo
pos[5, ] <- c(0.45, 0.10) # Obs-exp

pos[6, ] <- c(0.45, 0.10) # Obs bias--REMOVED AND DOES NOT APPEAR

# Solutions
pos[7, ] <- c(0.8, 0.90) # Extraneous vars
pos[8, ] <- c(0.8, 0.74) # Random allocation
pos[9, ] <- c(0.8, 0.58) # Washout
pos[10, ] <- c(0.8, 0.42) # Blinding individuals
pos[11, ] <- c(0.8, 0.26) # Controls
pos[12, ] <- c(0.8, 0.10) # Blinding researchers

pos[13, ] <- c(0.1, 0.90) # Blocking
pos[14, ] <- c(0.1, 0.74) # Restrictions


# Confounding, to...
curvedarrow(from = pos[1, ], # Confounding
            to = pos[13, ],  # Blocking 
            curve = 0, 
            lty = 1, 
            lwd = 2)
curvedarrow(from = pos[1, ], # Confounding
            to = pos[14, ],   # Restriction 
            curve = 0, 
            lty = 1, 
            lwd = 2)
curvedarrow(from = pos[1, ], # Confounding 
            to = pos[7, ],   # Extraneous vars
            curve = 0, 
            lty = 1, 
            lwd = 2)
curvedarrow(from = pos[1, ], # Confounding
            to = pos[8, ],   # Random allocation
            curve = 0, 
            lty = 1, 
            lwd = 2)

# Biases effect to...
curvedarrow(from = pos[2, ], # Carryover
            to = pos[8, ],   # Random allocation
            curve = 0, 
            lty = 1, 
            lwd = 2)
curvedarrow(from = pos[2, ], # Carryover
            to = pos[9, ],   # Washout
            curve = 0, 
            lty = 1, 
            lwd = 2)
curvedarrow(from = pos[3, ], # Hawthorne 
            to = pos[10, ],   # Blind individuals
            curve = 0, 
            lty = 1, 
            lwd = 2)
curvedarrow(from = pos[4, ], # Placebo
            to = pos[10, ],  # Blind individuals
            curve = 0, 
            lty = 1, 
            lwd = 2)
curvedarrow(from = pos[4, ], # Placebo
            to = pos[11, ],  # Controls
            curve = 0, 
            lty = 1, 
            lwd = 2)
curvedarrow(from = pos[5, ], # Observer effect
            to = pos[12, ],  # Blind researchers
            curve = 0, 
            lty = 1, 
            lwd = 2)


### TEXT
textrect( pos[1, ], 
           lab = "Confounding", 
           radx = 0.12, 
           rady = 0.050, 
           shadow.size = 0,
           box.col = "mistyrose",
           lcol = "mistyrose")
textrect( pos[2, ], 
           lab = c("Carry-over",
                   "effect"), 
           radx = 0.12, 
           rady = 0.050, 
           shadow.size = 0,
           box.col = "beige",
           lcol = "beige")
textrect( pos[3, ], 
           lab = c("Hawthorne",
                   "effect"), 
           radx = 0.12, 
           rady = 0.050, 
           shadow.size = 0,
           box.col = "beige",
           lcol = "beige")
textrect( pos[4, ], 
           lab = c("Placebo",
                   "effect"), 
           radx = 0.12, 
           rady = 0.050, 
           shadow.size = 0,
           box.col = "beige",
           lcol = "beige")
textrect( pos[5, ], 
           lab = c("Observer",
                   "effect"), 
           radx = 0.12, 
           rady = 0.050, 
           shadow.size = 0,
           box.col = "lightsteelblue3",
           lcol = "lightsteelblue3")
#textrect( pos[6, ], 
#           lab = c("Observer",
#                   "bias"), 
#           radx = 0.12, 
#           rady = 0.050, 
#           shadow.size = 0,
#           box.col = "lightsteelblue3",
#           lcol = "lightsteelblue3")



textrect( pos[7, ], 
           lab = c("Extraneous",
                   "variables"), 
           radx = 0.10, 
           rady = 0.050, 
           shadow.size = 0,
           box.col = "darkseagreen1",
           lcol = "darkseagreen1")
textrect( pos[8, ], 
           lab = c("Random",
                   "allocation"), 
           radx = 0.10, 
           rady = 0.050, 
           shadow.size = 0,
           box.col = "darkseagreen1",
           lcol = "darkseagreen1")
textrect( pos[9, ], 
           lab = c("Washout",
                   "Period"),
           radx = 0.10, 
           rady = 0.050, 
           shadow.size = 0,
           box.col = "darkseagreen1",
           lcol = "darkseagreen1")
textrect( pos[10, ], 
           lab = c("Blind",
                   "individuals"), 
           radx = 0.10, 
           rady = 0.050, 
           shadow.size = 0,
           box.col = "darkseagreen1",
           lcol = "darkseagreen1")
textrect( pos[11, ], 
           lab = "Controls", 
           radx = 0.10, 
           rady = 0.050, 
           shadow.size = 0,
           box.col = "darkseagreen1",
           lcol = "darkseagreen1")
textrect( pos[12, ], 
           lab = c("Blinding",
                   "researchers"), 
           radx = 0.10, 
           rady = 0.050, 
           shadow.size = 0,
           box.col = "darkseagreen1",
           lcol = "darkseagreen1")
	   
textrect( pos[13, ], 
           lab = "Blocking", 
           radx = 0.10, 
           rady = 0.050, 
           shadow.size = 0,
           box.col = "darkseagreen1",
           lcol = "darkseagreen1")
textrect( pos[14, ], 
           lab = "Restrictions", 
           radx = 0.10, 
           rady = 0.050, 
           shadow.size = 0,
           box.col = "darkseagreen1",
           lcol = "darkseagreen1")

# Images
plotfunctions::plot_image(
                           img = "./Pics/iconmonstr-resize-4-240.png", # Confounding
                           type = "png",
                           keep.ratio = TRUE,
                           yrange = c(0.88, 0.92),
                           xrange = c(0.53, 0.57),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)

plotfunctions::plot_image(
                           img = "./Pics/iconmonstr-chart-21-240.png", # Carryover
                           type = "png",
                           keep.ratio = TRUE,
                           yrange = c(0.68, 0.72),
                           xrange = c(0.52, 0.56),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)

plotfunctions::plot_image(
                           img = "./Pics/iconmonstr-binoculars-8-240.png", # Hawthorne
                           type = "png",
                           keep.ratio = TRUE,
                           yrange = c(0.48, 0.52),
                           xrange = c(0.52, 0.56),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image(
                           img = "./Pics/iconmonstr-help-3-240.png", # Placebo
                           type = "png",
                           keep.ratio = TRUE,
                           yrange = c(0.28, 0.32),
                           xrange = c(0.52, 0.56),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
plotfunctions::plot_image( 
                           img = "./Pics/iconmonstr-idea-10-240.png", # Observer
                           type = "png",
                           keep.ratio = TRUE,
                           yrange = c(0.08, 0.12),
                           xrange = c(0.52, 0.56),
                           bty = "n", # Removes box from around the plot 
                           add = TRUE)
#plotfunctions::plot_image(
#                           img = "./Pics/iconmonstr-eye-6-240.png", # Observer
#                           type = "png",
#                           keep.ratio = TRUE,
#                           yrange = c(0.08, 0.12),
#                           xrange = c(0.52, 0.56),
#                           bty = "n", # Removes box from around the plot 
#                           add = TRUE)

```




::: {.example #DesignExample name="Study design"}
In a study of student paramedics comparing chest compressions using dominant and non-dominant hands [@cross2019impact] (Example \@ref(exm:BlindingParamedic)),
the participants were partially blinded: they were blinded to the *purpose* of the study, but not to which group they were allocated.
The analyst was also blinded to the group allocations.
The article reports that:

> ...participants were allocated randomly to one of two groups: 'dominant hand on chest' or 'non-dominant hand on chest'. 
> Group allocation was determined by a computer-generated randomisation schedule...
>
> --- @cross2019impact, p. 3

This study used a number of good design features.
:::


## Summary {#Chap7-Summary}

Designing effective *experimental* studies requires researchers to **manage or minimise confounding** where possible, by:

* *restricting* the study to certain groups;
* *blocking*;
* through special *analysis* methods; and/or 
* through *random allocation*.

Well-designed experimental studies also try to manage:

* the *carry-over effect* (for example, using a washout period, or randomly allocating the order of treatments);
* the *Hawthorne effect* (for example, by blinding participants to the treatment);
* the *placebo effect* (for example, by blinding participants to the treatments and by using *controls*); and
* the *observer effect* (for example, by blinding the researchers to the treatments being applied).

`r if (knitr::is_html_output()){
  'The following short video may help explain some of these concepts:'
}`

<div style="text-align:center;">
<iframe width="560" height="315" src="https://www.youtube.com/embed/eic_LjXT4qc" frameborder="0" allow="accelerometer; encrypted-media; gyroscope; picture-in-picture"></iframe>
</div>




## Quick review questions {#Chap7-QuickReview}

A study on the bruising of apples [@doosti2016development] aimed to determine the relationship between the recorded surface temperature of the apple, and the depth of bruising.
The researchers purposefully hit apples with three different **forces** (200, 700 and 1200&nbsp;mJ) to inflict bruises.
The researchers then recorded the **depth** of the bruising, and recorded the **surface temperature** at each bruise location.

The study was conducted separately for three different **regions** of the apple (lower; middle; upper), and each apple was only used once.

1. The *response variable* is
`r if( knitr::is_html_output(exclude = "epub") ) {longmcq( c(
	"The force used on the apples",
	"The depth of the bruising",
	"The location of the bruising",
	answer = "The surface temperature at the bruise"))} else {"________________"}`
1. The *explanatory variable* is
`r if( knitr::is_html_output(exclude = "epub") ) {longmcq( c(
	"The force used on the apples",
	answer = "The depth of the bruising",
	"The location of the bruising",
	"The surface temperature at the bruise"))} else {"________________"}`
1. What is the *best* description for the variable 'The location of the bruising'?  
`r if( knitr::is_html_output(exclude = "epub") ) {longmcq( c(
	"A confounding variable, since it may be related to the explanatory variable only",
	"A confounding variable, since it may be related to the response variable and explanatory variables",
	answer = "An extraneous variable, because it is likely to be related to the response variable only",
	"A lurking variable, since we don't know how it might be related to the response and explanatory variables"))}`
1. True or false: The researchers could minimise the effects of confounding by incorporating potential confounding variables in the analysis.  
`r if( knitr::is_html_output(exclude = "epub") ) {torf( TRUE)}`
1. True or false: The researchers could use random allocation of the treatments to the apples to minimise confounding.  
`r if( knitr::is_html_output(exclude = "epub") ) {torf( TRUE)}`
1. True or false: The *carry-over* effect is likely to be a big problem in this study.  
`r if( knitr::is_html_output(exclude = "epub") ) {torf( FALSE)}`
1. True or false: The *Hawthorne* effect is likely to be a big problem in this study. 
`r if( knitr::is_html_output(exclude = "epub") ) {torf( FALSE)}`
1. True or false: The *placebo* effect is likely to be a big problem in this study.  
`r if( knitr::is_html_output(exclude = "epub") ) {torf( FALSE)}`
1. True or false: *Observer* bias is likely to be a big problem in this study.  
`r if( knitr::is_html_output(exclude = "epub") ) {torf( FALSE )}`

`r if (!knitr::is_html_output()) '<!--'`
::: {.progressBox .progress}
**Progress:**  `r webexercises::total_correct()`
:::
`r if (!knitr::is_html_output()) '-->'`


## Exercises {#DesigningExperimentsExercises}

Selected answers are available in Sect. \@ref(DesigningExperimentsAnswer).



::: {.exercise #DesignExpTrueFalse}
Are the following statements true of false?

1. Experimental studies **must** use random samples.  
`r if( knitr::is_html_output(exclude = "epub") ) {torf(answer = FALSE)}` 
2. An experimental study **must** blind the researchers.  
`r if( knitr::is_html_output(exclude = "epub") ) {torf(answer = FALSE)}` 
3. An experimental study **must** blind the participants.  
`r if( knitr::is_html_output(exclude = "epub") ) {torf(answer = FALSE)}` 
4. Experimental studies **must** use a control group.  
`r if( knitr::is_html_output(exclude = "epub") ) {torf(answer = FALSE)}` 
5. In experimental studies, the treatments **must** be allocated by the researchers.  
`r if( knitr::is_html_output(exclude = "epub") ) {torf(answer = TRUE)}` 
:::


::: {.exercise #DesignExpExtraneous}
Extraneous variables are variables that are related to the response variable.  
Which of the following types of variables are special types of extraneous variables?

1. Lurking variables.
`r if( knitr::is_html_output(exclude = "epub") ) {mcq( c(answer = "Extraneous", "Not extraneous") )}` 
2. Explanatory variables.
`r if( knitr::is_html_output(exclude = "epub") ) {mcq( c("Extraneous", answer = "Not extraneous") )}` 
3. Confounding variables.
`r if( knitr::is_html_output(exclude = "epub") ) {mcq( c(answer = "Extraneous", "Not extraneous") )}` 
:::


::: {.exercise #DesignExpWeightLoss}
Consider a study comparing the average weight loss for patients who do at least 30 minutes of exercise a day (Group A), to patients who do less than 30 minutes of exercise a day (Group B).  
Which of the following statements are true?

1. The extraneous variable is the amount of exercise per day (in hours)
`r if( knitr::is_html_output(exclude = "epub") ) {torf(answer = FALSE)}` 
2. The response variable is the weight loss for each person
`r if( knitr::is_html_output(exclude = "epub") ) {torf(answer = TRUE)}` 
3. The explanatory variable is whether or not the patient performs at least 30 minutes of exercise per day
`r if( knitr::is_html_output(exclude = "epub") ) {torf(answer = TRUE)}` 
4. The response variable is the **average** weight loss
`r if( knitr::is_html_output(exclude = "epub") ) {torf(answer = FALSE)}` 
5. The explanatory variable is the amount of exercise the patient does per day (in hours)
`r if( knitr::is_html_output(exclude = "epub") ) {torf(answer = FALSE)}` 
6. Age is likely to be a lurking variable.
`r if( knitr::is_html_output(exclude = "epub") ) {torf(answer = FALSE)}` 
7. Age is an extraneous variable.
`r if( knitr::is_html_output(exclude = "epub") ) {torf(answer = TRUE)}` 
8. Age is likely to be a confounding variable.
`r if( knitr::is_html_output(exclude = "epub") ) {torf(answer = TRUE)}` 

Which of the following are possible **confounding** variables?

9. The sex of the patients.
`r if( knitr::is_html_output(exclude = "epub") ) {torf(answer = TRUE)}` 
10. The initial weight of the patients.
`r if( knitr::is_html_output(exclude = "epub") ) {torf(answer = TRUE)}` 
11. The names of the patients
`r if( knitr::is_html_output(exclude = "epub") ) {torf(answer = FALSE)}` 
:::


::: {.exercise #DesignExpParamedicsPills}
Paramedics were involved in a study to compare two new pills (Treatment A, and Treatment B) to treat Post Traumatic Stress Disorder (PTSD).  

1. What would be the control group?
`r if( knitr::is_html_output(exclude = "epub") ) {
   longmcq( c("The group receiving Treatment A",
              "A group of paramedics who do not have PTSD",
              "The group receiving Treatment B",
              "A group of paramedics not involved in the study",
              "A group of people with PTSD who are not paramedics",
              answer = "A group receiving a pill that looks just like Treatment A and B, but has no effective ingredient"))}`

2. In the study, the patients did not know which treatment they received.  
What is this called?
`r if( knitr::is_html_output(exclude = "epub") ) {
   longmcq( c("Blinding the researchers",
              "Double blinding",
              "Managing confounding",
              answer = "Blinding the participants"))}`

3. What is the purpose of blinding the participants?
`r if( knitr::is_html_output(exclude = "epub") ) {
   longmcq( c("To ensure that researchers did not unintentionally influence the results",
              answer = "To ensure that participants did not change their behaviour because of the treatment they were receiving",
              "To manage confounding"))}`
:::


::: {.exercise #DesignExpFillBlanks}
In experiments, confounding can be managed by restricting the study group, blocking, 
`r if( knitr::is_html_output(exclude = "epub") ) {mcq( c("sampling", answer = "random allocation"))} else {"________________"}`, or special methods of 
`r if( knitr::is_html_output(exclude = "epub") ) {mcq( c(answer = "analysis", "sampling"))} else {"________________"}`.

The Carry-over Effect can be managed by using a
`r if( knitr::is_html_output(exclude = "epub") ) {mcq( c(answer = "washout", "control group"))} else {"________________"}`.

The Placebo Effect can be managed by using a
`r if( knitr::is_html_output(exclude = "epub") ) {mcq( c("washout", answer = "control group"))} else {"________________"}`.

The Observer Effect can be managed by blinding the
`r if( knitr::is_html_output(exclude = "epub") ) {mcq( c("participants", answer = "researchers"))} else {"________________"}`

The Hawthorne effect can be managed by blinding the 
`r if( knitr::is_html_output(exclude = "epub") ) {mcq( c(answer = "participants", "researchers"))} else {"________________"}`.
:::


::: {.exercise #ResearchDesignFertilizer}
A scientist is comparing the effects of two types of fertiliser on the yield of tomatoes (based on @klanian2018integrated).
He plants tomato seedlings, and fertilises with Fertiliser I, and later measures the yield of tomatoes.
He then immediately plants more tomato seedlings in the same field, and fertilises with Fertilizer II, and measures the yield of tomatoes.

What potential problems can you identify with the study design?
:::


::: {.exercise #ResearchTasteOfWater2}
A scientist is expecting that tap water will taste the same as bottled water in a taste test (based on @teillet2010consumer).
The scientist provides people with a plastic cup of either bottled or tap water, and she asks them to give a rating of the taste on a scale of 1 (terrible) to 5 (fantastic).

What potential problems can you identify with the study design?
:::


::: {.exercise #ResearchDesignTasteOfWater3}
Consider this RQ (based on @teillet2010consumer)):

> Among university students, is the taste of tap water different than the taste of bottled water?

This RQ needs some clarification, but you decide to answer this question using an *experiment*.
How would you manage:

1. Random allocation?
1. Blinding?
1. Double blinding?
1. Finding a control?
1. Finding a random sample?
:::


::: {.exercise #ResearchDesignSunscreen}
In a study of time spent applying sunscreen [@data:Heerfordt2018:sunscreen] the Aim was to 'determine whether time spent on sunscreen application is related to the amount of sunscreen used' (@data:Heerfordt2018:sunscreen, p. 117).
The authors state this about the study design:

> The volunteers were asked to apply the provided sunscreen [...] the way they would normally do on a sunny day at the beach in Denmark [...]
> The volunteers wore swimwear during the whole session. 
> No other information was given. 
> Participants applied sunscreen behind a curtain and were not observed during application. 
> Measurements of time and sunscreen weight were made without the subjects' being aware of this.
>
> --- @data:Heerfordt2018:sunscreen, p. 118
 
1. What are the response and explanatory variables?
1. The researchers also recorded age, height, weight and body surface area of each participant. 
   Why would they have done this?
1. The researchers also compared the mean values of the response variable for males and females, 
   and the mean values of the explanatory variable for males and females. 
   Why would they have done this? 
1. What design features are being used in the second quote?
:::


<!-- https://bmcoralhealth.biomedcentral.com/articles/10.1186/s12903-018-0588-1  About tooth brushing -->


<!-- QUICK REVIEW ANSWERS -->
`r if (knitr::is_html_output()) '<!--'`
::: {.EOCanswerBox .EOCanswer data-latex="{iconmonstr-check-mark-14-240.png}"}
**Answers to in-chapter questions:**

- Sect. \ref{thinkBox:HimalayaPOCI}: 1. **P**: Australians. **O**: average faecal weight. **C**: Between those eating food made using refined cereal, and those eating food made from *Himalaya 292*. 2. The information that *must* be gathered from each individual: the faecal weight; the type of grain consumed (refined or *Himalaya 292*). 3. True experiment.
- Sect. \ref{thinkBox:Control}: The controls are **not** just people who don't get the injections. 
Ideally, controls would be people who, like the treatment group, report to a GP and receive an injection... however, they just receive an injection that will do nothing.

- \textbf{\textit{Quick Revision} questions:}
**1.** The surface temperature at the bruise.
**2.** The depth of the bruising.
**3.** An extraneous variable, because it is likely to be related to the response variable only.
**4.** True.
**5.** True.
**6.** False.
**7.** False.
**8.** False.
**9.** False.
:::
`r if (knitr::is_html_output()) '-->'`
