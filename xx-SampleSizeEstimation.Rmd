# Estimating sample sizes {#EstimatingSampleSize}


```{block2, type="rmdobjectives"}
So far,
you have learnt, among many other things, how to compute confidence intervals.
**In this chapter**,
you will learn how to compute the size sample that is needed
to produce a CI with a certain coverage.
You will learn to:
* estimate the sample size for producing a CI of given width for a **proportion**.
* estimate the sample size for producing a CI of given width for a **mean**.

```




```{r echo=FALSE, fig.cap="", fig.align="center", fig.width=3, out.width="35%"}
SixSteps(5, "Estimating the sample size")
```


## Estimating sample size: General ideas {#SampleSizeIdeas}

A confidence interval is an interval which gives a range of values of the population parameter that could plausibly have given rise to our observed value of the statistic.

All other things being equal, it makes sense that a *larger* sample size would give a more precise estimate: Larger samples give better estimates.

In general, *larger* samples produce more [*precise*](#PrecisionAccuracy) estimates of the parameter (Sect.&nbsp;\@ref(PrecisionAccuracy)), and hence narrower CIs.

After all, if that was not the case, we could take the smallest possible sample of size one... which is clearly absurd.


```{block2, type="rmdimportant"}
Remember that the sample size is the number of *units of analysis*.
```

If larger samples give better estimates, then we should take the largest possible sample that we can.

But using large samples also have disadvantages: they take longer to conduct, and can also cost more money.
Furthermore, ethics\index{ethics} committees often wish to keep sample sizes as small as possible, so that as little (potential) harm as possible is done to the environment, as to as few animals and people as possible.

Determining what sample size to use is, therefore, a trade-off between cost, time, ethics and precision. 
If cost, time and ethics were not limiting factors, the largest possible sample could (and probably should) be used.

In addition, it sometimes is important to begin with a slightly larger sample than required to allow for drop-outs (for example, animals die, or people withdraw from the study).




```{example Biochar}
Consider a project studying the residual effect of organic biochar compound fertilizers (BCFs) two years after application [@farrar2021biochar].

This study requires planting tumeric in pots using soil previously treated with BCFs.

After the turmeric was grown, the concentration of potassium, phosphorus and nitrogen--as well as many trace minerals--was determined from the soil in *every* pot.

In addition, *every* turmeric plant was analysed for the number of shoots, the leaf mass fraction, and foliar nutrient information.

Clearly, every pot that is used comes with a substantial cost, both in terms of time and money.
```

In this chapter, we learn how to compute the (approximate) minimum sample size needed to obtain a given precision.




## Estimating sample sizes: one proportion {#SampleSizeOneProportion}

In Example \@ref(exm:NHANESSmokers),
we computed a 95% confidence interval for the proportion of smokers;
CI stated the precision as give-or-take $0.018$.

Suppose we wanted an even ore precise estaimte of $p$; say, to give-or-take $0.01$ 
what size sample is needed?

Since we seek a *more* precise estimate, 
we'd expect to need a *larger* sample... 
but how much larger?

Conservatively,
the size of the [*simple random sample*](#SRS) needed for a 95% CI needed is *at least*

\[
   \frac{1}{(\text{Margin of error})^2}.
\]
That is,
a sample size of at least 
$\displaystyle \frac{1}{0.01^2} = 10\,000$ 
Americans is needed.


```{example SampleSizep, name = "Sample size calculation (proportions)"}
To estimate the population proportion of Australians that own an iPad, 
to within $0.07$ with 95% confidence,
a sample size of at least
   
\[
  \frac{1}{(\text{Margin of error})^2} { = \frac{1}{0.07^2}}
\]
is needed;
*at least* $n = 204.0816$ Australians.

In practice,
*at least* 205 people are needed
to achieve this desired level of precision
(that is, **always round up** in sample size calulations).
```



```{block2, type="rmdimportant"}
Always **round up** the result of the sample size calculation.
```

Of course, this calculation is only one part of the information needed to make the final decision.
The cost of taking sample of this size has not been factored in.

In addition, this calculation assumes a [*simple random sample*](#SRS) will be used,
which is usually unreasonable.
(Other, far more complex, formulas are available for comouting sample sizes for other random-sampling schemes.)
However, 
the calculation does give an *estimate* of the sample size that would be required.


`r if (knitr::is_html_output()){
  'The following short video may help explain some of these concepts:'
}`



```{example SampleSizeNestingBoxes, name = "Sample sizse calculation (proportion)"}
@goldingay2018outcomes studied the state of human-made nesting boxes for native animals (such as possums, gliders and bees).
For example, they wished to determine the percentage of nesting boxes that were still functional 25 after being installed.

The minimum sample size needed to make this estimate, within 0.075, would be

\[
   n = \frac{1}{(\text{Margin of error})^2} = \frac{1}{0.03^2} = 177.8.
\]
At least 178 nesting boxes would be needed, which may be too large to be practical.
```



<iframe width="560" height="315" src="https://www.youtube.com/embed/-fflEggczG4" frameborder="0" allow="accelerometer; encrypted-media; gyroscope; picture-in-picture"></iframe>





## Estimating sample sizes: one mean {#SampleSizeOneMean}

As with proportions, estimate a population *mean* is more precise witha larger sample.

In general,
larger samples produce more [precise](#PrecisionAccuracy) estimates of the parameter (Sect.&nbsp;\@ref(PrecisionAccuracy)), and hence narrower CIs.

Conservatively,
the size of the [*simple random sample*](#SRS) needed for a 95% CI needed is *at least*

\[
   \left( \frac{2 \times s}{\text{Margin of error}}\right)^2.
\]


```{block2, type="rmdimportant"}
Always **round up** the results of a sample size calculation.
```

<!-- Text wrap from: https://stackoverflow.com/questions/43551312/wrap-text-around-plots-in-markdown -->
<!-- Trick from: https://blog.earo.me/2019/10/26/reduce-frictions-rmd/ -->
`r if (knitr::is_latex_output()) '<!--'`
```{r, echo=FALSE, out.width= "30%", out.extra='style="float:right; padding:10px"'}
include_graphics("Illustrations/hamburger-2253349_640.jpg")
```
`r if (knitr::is_latex_output()) '-->'`


```{example SampleSizepNHANES, name = "Sample size estimation (means)"}
For the NHANES data,
what size sample is needed to estimate the direct HDL cholesterol levels
to within 0.02&nbsp;mmol/L, with 95% confidence?
  
Since we would like to estimate the population mean give-or-take 0.02&nbsp;mmol/L,
the 'margin of error' that we would like is 0.02.
So, using $s=0.39926$, the required sample size is *at least*
\[
   \left( \frac{2 \times 0.39926}{0.02}\right)^2 = 1594.085;
\] 
at least 1595 Americans are needed.
(Remember to always *round up* in sample size calculations.)
```


```{block2, type="rmdimportant"}
Always **round up** the result of the sample size calculation.
```

Of course, this calculation is only one part of the information needed to make the final decision.
The cost of taking sample of this size has not been factored in.

In addition, this calculation assumes a [*simple random sample*](#SRS) will be used,
which is usually unreasonable.
(Other, far more complex, formulas are available for comouting sample sizes for other random-sampling schemes.)
However, 
the calculation does give an *estimate* of the sample size that would be required.


```{example SampleSizeParamed, name="Sample size estimation (means)"}

@data:MacDonald:Resuscitation studied the time taken for paramedics to perform certain tasks (such as intravenous cannulation and electrical defibrillation).

To compute the necessary sample size,
they used a standard deviation of 0.2 minutes (based on data from previous similar studies) with a margin of error of 0.1 minutes.
The necessary sample size is

\[
   n = \left( \frac{2 \times s}{\text{Margin of error}}\right)^2 = \frac{2 \times 0.2}{0.1}\right)^2 = 16.
\]
A sample size of 16 paramedics was required (and used).
```






## Quick review questions {#Chapxx-QuickReview}

1. True or false: A *larger* sample size produces a *more* precise estimate of the parameter, all other things being equal.  
`r if( knitr::is_html_output() ) {torf(answer = TRUE )}`
1. True or false: A *larger* sample size produces a *more random* sample.  
`r if( knitr::is_html_output() ) {torf(answer = FALSE )}`



```{block2, type="fold"}
1. **TRUE**. The reason why larger sample are "better" is that they estimate the unknown population parameter with greater precision.
1. **FALSE**. The *size* of the sample, and *how* the sample was obtained, are two different issues.

```






## Exercises {#SampleSizesExercises}



Selected answers are available in
Sect.&nbsp;\@ref(SampleSizesAnswer).


```{exercise SampleSize}
Suppose we have a situation where we need to estimate a population *proportion*.

1. What size sample is needed to estimate the population proportion within 0.04?
1. What size sample is needed to estimate the population proportion within 0.02 (that is, the confidence interval will be *half* as wide as in the first calculation)?
1. What size sample is needed to estimate the population proportion within 0.01 (that is, the confidence interval will be *a quarter* as wide as in the first calculation)?
1. To get an estimate *half* as wide, how many *times* more units of analysis are needed?
1. To get an estimate *a quarter* as wide, how many *times* more units of analysis are needed?

```

```{exercise SampleSize}

Carpal tunnel syndrome (CTS) is pain experienced in the wrists.
One study
[@data:Schmid2012:splinting]
compared two different treatments:
night splinting, or gliding exercises.
Participants were *randomly allocated* to
one of the two groups.
Pain intensity (measured using a quantitative visual analog scale; *larger* values mean *greater* pain)
were recorded after one week of treatment.
The data are summarised in 
Table \@ref(tab:CarpalTunnel).
1. Compute the standard error for the mean pain intensity for each group.
1. In which direction is the difference computed? What does it *mean* when the difference is calculated in this way?
1. Compute an approximate 95% CI for the *difference* in the mean pain intensity for the treatments.
1. Compute an approximate 95% CI for the population mean pain intensity for those treated with splinting.
1. Are the CIs likely to be statistically valid?
```







```{exercise MeansIndSamplesExercisesCarpalTunnelSyndrome}
Carpal tunnel syndrome (CTS) is pain experienced in the wrists.
One study
[@data:Schmid2012:splinting]
compared two different treatments:
night splinting, or gliding exercises.
Participants were *randomly allocated* to
one of the two groups.
Pain intensity (measured using a quantitative visual analog scale; *larger* values mean *greater* pain)
were recorded after one week of treatment.
The data are summarised in 
Table \@ref(tab:CarpalTunnel).
1. Compute the standard error for the mean pain intensity for each group.
1. In which direction is the difference computed? What does it *mean* when the difference is calculated in this way?
1. Compute an approximate 95% CI for the *difference* in the mean pain intensity for the treatments.
1. Compute an approximate 95% CI for the population mean pain intensity for those treated with splinting.
1. Are the CIs likely to be statistically valid?
```



