
# Tests for means of two independent groups {#TestTwoMeans}


<!-- Introductions; easier to separate by format -->
```{r, child = if (knitr::is_html_output()) {'./introductions/33-Testing-TwoMeans-HTML.Rmd'} else {'./introductions/33-Testing-TwoMeans-LaTeX.Rmd'}}
```


## Introduction: garter snakes {#TwoMeansHT-intro}

Some Mexican garter snakes (*Thamnophis melanogaster*) live in habitats with no crayfish, while some live in habitats with crayfish and hence use crayfish as a food source.
Researchers [@manjarrez2017morphological] were interested in whether the snakes in these two regions were different:

> For female Mexican garter snakes, is the mean snout--vent length (SVL) different for those in regions with crayfish and without crayfish?

Two different groups of snakes are studied, so the data are *not paired*.
The data are shown 
`r if (knitr::is_latex_output()) {
   'in Table\\ \\@ref(tab:SnakesDataTableTest).'
} else {
   'below.'
}`



```{r SnakesDataTableTest}
data("Snakes")

# Extract just the female snakes, for example; n \approx 50
SNF <- subset(Snakes, 
              Sex == "female")

SNF$Crayfish <- ordered(SNF$Crayfish, 
                        levels = c("Y", "N"),
                        labels = c("Yes",
                                   "No"))

if( knitr::is_latex_output() ) {

tb1 <- c( na.omit( SNF$SVL[ SNF$Crayfish == "No" ] ) )
tb1 <- cbind (tb1[1:5],
              tb1[6:10],
              tb1[11:15],
              tb1[16:20],
              tb1[21:25],
              tb1[26:30],
              tb1[31:35],
              tb1[36:34],
              c( tb1[41], NA, NA, NA, NA) )

tb2 <- c( na.omit( SNF$SVL[ SNF$Crayfish == "Yes" ] ) )
tb2 <- cbind (tb2[1:5],
              tb2[6:10],
              tb2[11:15],
              tb2[16:20],
              tb2[21:25],
              tb2[26:30],
              tb2[31:35] )


  T1 <- knitr::kable( pad(tb1,
                          surroundMaths = TRUE,
                          targetLength = rep(2, 9),
                          digits = 0),
                      format = "latex",
                      valign = 't',
                      align = "c",
                      #table.env = "@empty",
                      linesep = "",
                      row.names = FALSE,
                      escape = FALSE,
                      booktabs = TRUE) %>%
    row_spec(0, bold = TRUE) %>%
    add_header_above( c("Non-crayfish region" = 9),
                      bold = TRUE)

  T2 <- knitr::kable( pad(tb2,
                          surroundMaths = TRUE,
                          targetLength = rep(2, 9),
                          digits = 0),
                      format = "latex",
                      align = "c",
                      valign = 't',
                      #table.env = "@empty",
                      linesep = "",
                      row.names = FALSE,
                      escape = FALSE,
                      booktabs = TRUE) %>%
    row_spec(0, bold = TRUE) %>%
    add_header_above( c("Crayfish region" = 7),
                      bold = TRUE)
  
  out <- knitr::kables(list(T2, T1), # Notice order swapped!
                       format = "latex",
                       label = "SnakesDataTableTest",
                       caption = "Snout--vent length (in cm) for female Mexican garter snakes living in crayfish and non-crayfish regions") %>% 
    kable_styling(font_size = 8)
  out2 <- prepareSideBySideTable(out)
  out2
}
if( knitr::is_html_output() ) {
  DT::datatable( SNF,
                 colnames = c("Crayfish region", 
                              "Not-crayfish region"),
         caption = "Snout--vent length (in cm) for female Mexican garter snakes living in crayfish and non-crayfish regions",
         fillContainer = FALSE, # Make more room, so we don't just have ten values
                 #filter="top", 
                 #selection="multiple", 
                 #escape=FALSE,
                 options = list(searching = FALSE) # Remove searching: See: https://stackoverflow.com/questions/35624413/remove-search-option-but-leave-search-columns-option
  )
}
```



Since the data are available
`r if( knitr::is_latex_output() ) {
  '(Table\\ \\@ref(tab:SnakesDataTableTest)),'
} else {
  '(see above),'
}`
a numerical summary *must* summarise the difference between the means, as the RQ is about the difference.
Each group can be summarised too.
The information is found using software (Fig.\ \@ref(fig:SnakesSummaryTestjamovi)), and can be compiled into a table (Table\ \@ref(tab:SnakesNumericalTest)).
The appropriate summary for graphically summarising the *data* is (for example) a boxplot (Fig.\ \@ref(fig:SnakesErrorbar), left panel).
An error bar chart (Fig.\ \@ref(fig:SnakesErrorbar), right panel), which compares the *sample means*, should also be produced.


```{r SnakesSummaryTestjamovi, fig.cap="jamovi output for the snakes data", fig.align="center", out.width=c("60%","100%"), fig.show='hold'}
knitr::include_graphics("jamovi/Snakes/Snakes-Summary.png")
knitr::include_graphics("jamovi/Snakes/Snakes-Test.png")
```



## Hypotheses and notation

Since two groups are being compared, using subscripts to distinguish between the statistics for the two groups.
Calling these groups\ $A$ and\ $B$ in general, the notation is shown in Table\ \@ref(tab:IndSampleNotationHT).
Using this notation, the *parameter* in the RQ is the difference between population means: $\mu_A - \mu_B$.
As usual, the population values are unknown, so this is estimated using the statistic $\bar{x}_A - \bar{x}_B$.


```{r IndSampleNotationHT}
Diff2Notation <- array(dim = c(5, 2))
colnames(Diff2Notation) <- c("Group A", 
                             "Group B")
rownames(Diff2Notation) <- c("Population means:",
                             "Sample means:",
                             "Standard deviations:",
                             "Standard errors:",
                             "Sample sizes:")

if( knitr::is_latex_output() ) {
  Diff2Notation[1, ] <- c(	"$\\mu_A$", 	
                           "$\\mu_B$")
  Diff2Notation[2, ] <- c(	"$\\bar{x}_A$",		
                           "$\\bar{x}_B$")
  Diff2Notation[3, ] <- c(	"$s_A$", 			
                           "$s_B$")
  Diff2Notation[4, ] <- c(	"$\\displaystyle\\text{s.e.}(\\bar{x}_A) = \\frac{s_A}{\\sqrt{n_A}}$",
                           "$\\displaystyle\\text{s.e.}(\\bar{x}_B) = \\frac{s_B}{\\sqrt{n_B}}$")
  Diff2Notation[5, ] <- c(	"$n_A$",
                           "$n_B$")
  
  kable( Diff2Notation,
         format = "latex",
         booktabs = TRUE,
         align = c("c", "c"),
         longtable = FALSE,
         escape = FALSE,
         col.names = colnames(Diff2Notation),
         caption = "Notation used to distinguish between the two independent groups") %>%
    row_spec(0, bold = TRUE) %>%
    kable_styling(font_size = 8)
}
if( knitr::is_html_output() ) {
  
  Diff2Notation[1, ] <- c(	"$\\mu_A$", 	
                           "$\\mu_B$")
  Diff2Notation[2, ] <- c(	"$\\bar{x}_A$",		
                           "$\\bar{x}_B$")
  Diff2Notation[3, ] <- c(	"$s_A$", 			
                           "$s_B$")
  Diff2Notation[4, ] <- c(	"$\\displaystyle\\text{s.e.}(\\bar{x}_A) = \\frac{s_A}{\\sqrt{n_A}}$",
                           "$\\displaystyle\\text{s.e.}(\\bar{x}_B) = \\frac{s_B}{\\sqrt{n_B}}$")
  Diff2Notation[5, ] <- c(	"$n_A$",
                           "$n_B$")
  
  kable( Diff2Notation,
         format = "html",
         booktabs = TRUE,
         longtable = FALSE,
         align = c("c", "c"),
         col.names = colnames(Diff2Notation),
         caption = "Notation used to distinguish between the two independent groups") %>%
    row_spec(0, bold = TRUE) 
}
```

For these data, we will use the differences defined as the mean for females snakes living in non-crayfish regions ($N$), *minus* the mean for female snakes in crayfish regions ($C$): $\mu_N - \mu_C$.
This is the *parameter*.
By this definition, the differences refer to how much larger (on average) the SVL is for snakes living in non-crayfish regions.


::: {.importantBox .important data-latex="{iconmonstr-warning-8-240.png}"}
Here the difference is computed as the mean SVL for snakes living in non-crayfish regions, *minus* the mean SVL for snakes living in crayfish regions.
Computing the difference in the reverse direction (i.e., crayfish regions, *minus* non-crayfish regions) is also correct.
You need to be clear about how the difference is computed, and be consistent throughout.
:::


As always, the null hypothesis is the default 'no difference, no change, no relationship' position; any difference between the parameter and statistic is due to sampling variation (Sect.\ \@ref(AboutHypotheses)).
Hence, the null hypothesis is 'no difference' between the population means SVL of the two groups:

* $H_0$: $\mu_N - \mu_C = 0$ (or $\mu_N = \mu_C$).

From the RQ, the alternative hypothesis is *two*-tailed:

* $H_1$: $\mu_N - \mu_C\ne 0$ (or $\mu_N \ne \mu_C$).

This hypothesis proposes that any difference between the *sample* means is because a difference really exists between the *population means*. 



## Describing the sampling distribution {#sampling-distribution-expectation-twosampleHT}

The *sample* mean difference between the SVL depends on which one of the many possible samples is randomly obtained, *even if* the difference between the means in the population is zero.
The difference between the sample means is $8.394$\ cm... but this value will vary from sample to sample; that is, there is *sampling variation*.


::: {.definition #DEFSamplingDistributionDiffMeans name="Sampling distribution for the difference between two sample means"}
The *sampling distribution of the difference between two sample means* $\bar{x}_A$ and $\bar{x}_B$ is, when the appropriate conditions are met (Sect.\ \@ref(ValidityTwoMeans)), described by:

* an approximate normal distribution,
* centred around a sampling mean whose value is ${\mu_{A}} - {\mu_{B}} = 0$, the difference between the *population* means (from $H_0$),,
* with a standard deviation of $\displaystyle\text{s.e.}(\bar{x}_A - \bar{x}_B)$.

The standard error for the difference between the means is found using  
\[
  \text{s.e.}(\bar{x}_A - \bar{x}_B) = \sqrt{ \text{s.e.}(\bar{x}_A)^2 + \text{s.e.}(\bar{x}_B)^2},
\]
though this value will usually be *given* (e.g., on computer output).
:::


The sampling variation for the values of $\bar{x}_N - \bar{x}_C$ can be described as having:

* an approximate normal distribution,
* centred around a sampling mean whose value is ${\mu_{N}} - {\mu_{C}} = 0$, the difference between the means (from $H_0$),
* with a standard deviation of $\displaystyle\text{s.e.}(\bar{x}_N - \bar{x}_C)$, called the *standard error for the difference between the means*.


::: {.softwareBox .software data-latex="{iconmonstr-laptop-4-240.png}"}
jamovi gives results from *two* similar hypothesis tests.
In this book, we will always use the second row of information: the "Welch's $t$" row in jamovi.

This row of information *does not* assume that the population standard deviation are equal.
The first row of information *does* assume the population standard deviation are equal.
In most cases, the information in both rows are similar anyway.
:::


```{r SnakesNumericalTest}
SN.summary <- array(NA,                  
                    dim = c(3, 4) )

SN.summary[1:2, 1] <- aggregate(SVL ~ Crayfish, 
                                data = SNF, 
                                FUN = "mean")[, 2]
SN.summary[1:2, 2] <- aggregate(SVL ~ Crayfish, 
                                data = SNF, 
                                FUN = "sd")[, 2]
SN.summary[1:2, 3] <- aggregate(SVL ~ Crayfish, 
                                data = SNF, 
                                FUN = "realLength")[, 2]
SN.summary[1:2, 4] <- aggregate(SVL ~ Crayfish, 
                                data = SNF, 
                                FUN = "findStdError")[, 2]

SN.summary[3, 1] <- SN.summary[2, 1] - SN.summary[1, 1]
SN.summary[3, 4] <- sqrt( SN.summary[1, 2]^2/SN.summary[1, 3] +
                            SN.summary[2, 2]^2/SN.summary[2, 3]  )

rownames(SN.summary) <- c("Crayfish region", 
                          "Not-crayfish region", 
                          "Difference")

if( knitr::is_latex_output() ) {
  kable(pad(SN.summary,
            surroundMaths = TRUE,
            targetLength = c(5, 5, 2, 5),
            digits = c(2, 2, 0, 3)),
        format = "latex",
        booktabs = TRUE,
        longtable = FALSE,
        escape = FALSE,
        align = "c",
        col.names = c("Mean", 
                      "Standard deviation", 
                      "Sample size", 
                      "Standard error"),
        caption = "Numerical summaries of SVL (in cm) for female snakes in two regions") %>%
    row_spec(0, bold = TRUE) %>%
    row_spec(3, italic = TRUE) %>%
    kable_styling(font_size = 8) 
}
if( knitr::is_html_output() ) {
  kable(pad(SN.summary,
            surroundMaths = TRUE,
            targetLength = c(5, 5, 2, 5),
            digits = c(2, 2, 0, 3)),
        format = "html",
        booktabs = TRUE,
        longtable = FALSE,
        align = "c",
        col.names = c("Mean", 
                      "Sample size", 
                      "Standard deviation", 
                      "Standard error"),
        caption = "Numerical summaries of SVL (in cm) for female snakes in two regions")  
}
```



```{r, SnakesErrorbar, fig.width=8.75, fig.height=3, fig.cap="Bar chart (left) and error bar chart (right) of SVL for female snakes in two regions", fig.align="center", out.width='95%'}
ci.lo <- SN.summary[, 1] - 2 * SN.summary[, 4] 
ci.hi <- SN.summary[, 1] + 2 * SN.summary[, 4] 

par(mfrow = c(1, 2))
boxplot(SVL ~ Crayfish,
        data = SNF,
        las = 1,
        ylim = c(15, 60),
        xlab = "Crayfish region?",
        main = "Boxplot: Snout--vent length ",
        ylab = "SVL (in cm)")

###

plot( range( c( ci.lo, ci.hi) ) ~ c(0.9, 2.1), 
      data = SNF,
      type = "n",
      xlim = c(0.5, 2.5),
      ylim = c(29, 46),
      pch = 19,
      axes = FALSE,
      main = "Error bars chart:\nSnout--vent length ",
      xlab = "Crayfish region?", 
      ylab = "SVL (in cm)",
      sub = "(Error bars are 95% confidence intervals)",
      las = 1)
axis(side = 1, 
     at = 1:2, 
     labels = c("Yes", 
                "No"),
     las = 1) 
axis(side = 2, 
     las = 1)
box()

mns <- SN.summary[1:2, 1]

points( mns ~ c(1:2), 
        pch = 19)

arrows(x0 = 1:2, 
       y0 = ci.lo[1:2], 
       x1 = 1:2, 
       y1 = ci.hi[1:2], 
  length = 0.05, 
  angle = 90, 
  code = 3)
```



## Computing the test statistic

The observed difference between sample means, relative to what was expected, is found by computing the test statistic; in this case, a $t$-score.
The jamovi output (Fig.\ \@ref(fig:SnakesSummaryTestjamovi)) gives the $t$-score, but the $t$-score can also be computed using the information in Table\ \@ref(tab:SnakesNumericalTest):  
\begin{align*}
   t
  &= 
   \frac{\text{sample statistic} - \text{assumed population parameter, from $H_0$}}
        {\text{standard error for sample statistic}}\\
   &= 
   \frac{ (\bar{x}_P - \bar{x}_C) - (\mu_P - \mu_C)}
        {\text{s.e.}(\bar{x}_P - \bar{x}_C)}
  = \frac{8.39 - 0}{2.437} = 3.44,
\end{align*}
as in the software output.


## Determining $P$-values

A $P$-value determines if the sample statistic is consistent with the assumption (i.e., $H_0$).
Since the $t$-score is large, the $P$-value will be small using the [68--95--99.7 rule](#def:EmpiricalRule).
This is confirmed by the software (Fig.\ \@ref(fig:SnakesSummaryTestjamovi)): the two-tailed $P$-value is $0.0011$.

A small $P$-value suggests the observations are *inconsistent* with the assumption (Table\ \@ref(tab:PvaluesInterpretation)), and the difference between the sample means could *not* be reasonably explained by sampling variation.


`r if (knitr::is_latex_output()) '<!--'`
::: {.thinkBox .think data-latex="{iconmonstr-light-bulb-2-240.png}"}
`r if (knitr::is_html_output()){
  'Click on the pins in the following image, and describe what the jamovi output tells us.' 
}`

<iframe src="https://learningapps.org/watch?v=pd365s6bj22" style="border:0px;width:100%;height:500px" allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true"></iframe>
:::
`r if (knitr::is_latex_output()) '-->'`


## Writing conclusions

In conclusion, write:

> Strong evidence exists in the sample (two independent samples $t = 3.445$; two-tailed $P = 0.0011$) that the population mean SVL is different for female snakes living in crayfish regions (mean: $34.17$\ cm; $n = 35$) and non-crayfish regions (mean: $542.57$\ cm; $n = 41$; $95$% CI for the difference: $3.51$ to $13.28$\ cm longer for those in non-crayfish regions).

The conclusion contains an *answer to the RQ*, the *evidence* leading to this conclusion ($t = 3.44$; two-tailed $P = 0.0011$), and *sample summary statistics*, including a CI.


## Statistical validity conditions {#Validity-Test-DiffMeans}

As usual, these results apply [under certain conditions](#exm:StatisticalValidityAnalogy), which are the same as those for forming a CI for the *difference* between two means.
The test above is statistically valid if *one* of these conditions is true:

1. *Both* sample sizes are at least $25$; *or*
1. Either sample size is smaller than $25$, *and* both *populations* have an approximate normal distribution.
  
The sample size of $25$ is a rough figure here, and some books give other values (such as $30$).
This condition ensures that the *distribution of the difference between sample means has an approximate normal distribution* (so that, for example, the [68--95--99.7 rule](#def:EmpiricalRule) can be used).
The histograms of the *sample data* can be used to determine if normality of the *populations* seems reasonable.


::: {.example #StatisticalValidityReactionHT name="Statistical validity"}
For the snake data, the samples sizes exceed $25$ ($41$ and $35$), so the results will be statistically valid.
The data in each group do not need be normally distributed, since both sample sizes are larger than $25$.
:::



<!-- One example using data; one just based on summary data -->

## Example: speed signage {#SpeedSignageHT}


<div style="float:right; width: 222x; border: 1px; padding:10px">
<img src="Illustrations/pexels-pixabay-315939.jpg" width="200px"/>
</div>


(This study was seen in Sect.\ \@ref(SpeedSignageCI).)
In an attempt to reduce vehicle speeds on freeway exit ramps, a Chinese study added signage [@ma2019impacts].
At one site studied (Ningxuan Freeway), speeds were recorded for $38$ vehicles before ($B$) the extra signage was added, and then for $41$ vehicles after ($A$) the extra signage was added (data in Sect.\ \@ref(SpeedSignageCI)).
The researchers are hoping the addition of extra signage will *reduce* the mean speed of the vehicles.
The RQ is:

> At this freeway exit, does the mean vehicle speed *reduce* after extra signage is added?


```{r}
data(Speed)

Speed$When <- factor(Speed$When,
                     levels = c("Before", "After"),
                     ordered = TRUE)
Speed2 <- data.frame( Before = Speed$Speed[ Speed$When == "Before" ][1:10],
                      After = Speed$Speed[ Speed$When == "After" ][1:10])
```



The data are *not* paired: different vehicles are measured before and after the extra signage is added.
The data are summarised in Table\ \@ref(tab:SignageSummaryHT).
A graphical summary of the data is a boxplot (Fig.\ \@ref(fig:SignageErrorBar), left panel); an error bar chart compares the means, with a CI for each group (Fig.\ \@ref(fig:SignageErrorBar), right panel).


```{r SignageSummaryHT}
SignageSummary <- array(dim = c(3, 4))
rownames(SignageSummary) <- c("Before", 
                            "After",
                            "Speed reduction")
colnames(SignageSummary) <- c("Mean",
                              "Std deviation",
                            "Sample size",
                            "Std error")

Speed.n <- tapply(Speed$Speed, 
                  list(Speed$When), 
                  "length") 
Speed.sd <- tapply(Speed$Speed, 
                   list(Speed$When), 
                   "sd") 

SignageSummary[1:2, 1] <- round( tapply(Speed$Speed, 
                                        list(Speed$When), 
                                        "mean"),
                                 2)
SignageSummary[1:2, 2] <- round( Speed.sd, 2)
SignageSummary[1:2, 3] <- round( Speed.sd / sqrt(Speed.n), 3)
SignageSummary[1:2, 4] <- Speed.n 

SignageSummary[3, 1] <- SignageSummary[1, 1] -  
                        SignageSummary[2, 1] 

sdB <- round( Speed.sd[1], 2)
sdA <- round( Speed.sd[2], 2)
SignageSummary[3, 3] <- round( sqrt( sdB^2/Speed.n[1] + 
                                     sdA^2/Speed.n[2] ), 
                               3)

SignageSummary[3, 4] <- NA 
SignageSummary[3, 2] <- NA
                          


if( knitr::is_latex_output() ) {
  kable(pad(SignageSummary,
            surroundMaths = TRUE,
            targetLength = c(6, 5, 5, 0),
            digits = c(2, 2, 3, 0)),
        format = "latex",
        longtable = FALSE,
        booktabs = TRUE,
        escape = FALSE,
        align = c("c"),
        col.names = c("Mean", 
                      "Std deviation",
                      "Std error",
                      "Sample size"),
        caption = "The signage data summary (in km/h)"
  ) %>%
  row_spec(0, bold = TRUE) %>%
  row_spec(3, italic = TRUE) %>%
  kable_styling(font_size = 8)
}
if( knitr::is_html_output() ) {
  kable(pad(SignageSummary,
            surroundMaths = TRUE,
            targetLength = c(6, 5, 5, 0),
            digits = c(2, 2, 3, 0)),
               format = "html",
               longtable = FALSE,
               booktabs = TRUE,
               align = "c",
               col.names = c("Mean", 
                            "Std deviation", 
                            "Std error",
                            "Sample size"),
    caption = "The signage data summary (in km/h)") %>%
  kable_styling(full_width = FALSE)
}
```


Define $\mu$ at the mean speed (in km.h^-1^) on the exit ramp.
Then, the parameter is $\mu_B - \mu_A$, the *reduction* in the population mean speed after signage is added.
The hypotheses are:

* $H_0$: $\mu_B - \mu_A = 0$: There is no change in the population mean speeds.
* $H_1$: $\mu_B - \mu_A > 0$: The population mean speed has *reduced*.

The best estimate of the difference in *population* means is the difference between the *sample* means: $(\bar{x}_B - \bar{x}_A) = 5.68$.
Table\ \@ref(tab:SignageSummaryHT) gives the standard error for estimating this *difference* as $\text{s.e.}(\bar{x}_B - \bar{x}_A) = 2.964$.
Using the summary information in Table\ \@ref(tab:SignageSummaryHT), the $t$-score (using Eq.\ \@ref(eq:tscore)) is  
\[
  t
  = \frac{(\bar{x}_B - \bar{x}_A) - (\mu_B - \mu_A)}{\text{s.e.}(\bar{x}_B - \bar{x}_{A})}
  = \frac{5.68 - 0}{2.964} = 1.92.
\]
(Recall that $\mu_B - \mu_A = 0$ from the null hypothesis.)

Remembering that the alternative hypothesis is *one-tailed*, the $P$-value (using the [68--95--99.7 rule](#def:EmpiricalRule)) is larger than $0.025$, but smaller than $0.32$... so making a clear decision is difficult without using software.
However, since the $t$-score is *just* less than 2, we suspect that the $P$-value is likely to be closer to $0.025$ than $0.32$.

From software, $P = 0.02968$ (you cannot be this precise just using the 68--95--99.7 rule).
Using Table\ \@ref(tab:PvaluesInterpretation), this $P$-value provides moderate evidence of a reduction in mean speeds.
We conclude:

> Moderate evidence exists in the sample ($t = 1.92$; one-tailed $P = 0.030$) that mean speeds have reduced after the addition of extra signage (Before: mean speed: $98.02$\ km.h^-1^; $n = 38$; standard deviation: $13.18$\ km.h^-1^; After:  mean speed: $92.34$\ km.h^-1^; $n = 41$; standard deviation: $13.13$\ km.h^-1^; 95% CI for the difference: $-0.24$ to $11.6$\ km.h^-1^).

Whether the mean speed reduction of $5.68$ has [*practical importance*](#PracticalSignificance) is a different issue.
Using the [validity conditions](#ValidityTwoMeans), the CI is statistically valid.

::: {.tipBox .tip data-latex="{iconmonstr-info-6-240.png}"}
Remember: *which* mean is larger must be clear!
:::




## Example: chamomile tea {#ChamomileTea-TwoMeans-HT}

(This study was seen in Sects.\ \@ref(ChamomileTea-Paired-CI), \@ref(ChamomileTea-TwoMeans-CI) and\ \@ref(ChamomileTea-Paired-HT).)
A study of patients with Type\ 2 diabetes mellitus (T2DM) randomly allocated $32$ patients into a control group (who drank hot water), and $32$ to receive chamomile tea (@rafraf2015effectiveness, p.\ 164).

The total glucose (TG) was measured for each individual, in both groups, both before the intervention and after eight weeks on the intervention.
Summary data are given in Table\ \@ref(tab:TGsummaryTable).
Evidence suggests that the chamomile tea group shows a mean reduction in TG (Sect.\ \@ref(ChamomileTea-Paired-HT)), while the hot-water group shows no evidence of a reduction.
However, the differences between the chamomile-tea and the hot-water groups may be due to the samples selected (i.e., sampling variation), so comparing the changes in the two groups is helpful.

The following relational RQ can be asked:

> For patients with T2DM, is the mean reduction in TG *greater* for the chamomile tea group compared to the hot water group?

Notice the RQ is one-tailed; the aim of the study is to determine if the chamomile-tea drinking group performs *better* (i.e., greater change in TG) than the control group.

This RQ is comparing two separate groups, specifically comparing the *differences* between the two groups.
This study contains both *within*-individuals comparisons (see Sect.\ \@ref(ChamomileTea-Paired-HT)) and a *between*-individuals comparison (this section); see Fig.\ \@ref(fig:TeaSummaryAnnotated).


```{r TeaSummaryAnnotated, fig.cap="The chamomile-tea study has two within-individuals comparisons, and a between-individuals comparison", fig.align="center", out.width="100%"}
knitr::include_graphics("OtherImages/ChamomileTea/ChamomileSummary-BetweenWithinGroups.png")
```


The corresponding hypotheses are:  
\[
  \text{$H_0$: $\mu_T - \mu_W = 0$ \qquad and\qquad $H_1$: $\mu_T - \mu_W > 0$}
\]
where $\mu$ refers to the mean reduction in TG, $T$ refers to the tea-drinking group, and $W$ to the hot-water drinking group.

The parameter $\mu_T - \mu_W$ is estimated by the statistic $\bar{x}_T - \bar{x}_W = 45.74$\ mg.dl^-1^.
The standard error for the statistic was found in Sect.\ \@ref(ChamomileTea-TwoMeans-CI)) as $\text{s.e.}(\bar{x}_T - \bar{x}_W) = 8.42$.
Hence, the test statistic is:  
\[
   t 
   = \frac{(\mu_T - \mu_W) - (\bar{x}_T - \bar{x}_W)}{\text{s.e.}(\bar{x}_T - \bar{x}_W)}
   = \frac{45.75 - 0}{8.42} 
   = 5.43,
\]
which is very large, so the $P$ value will be very small (using the $68$--$95$--$99.7$ rule), and certainly smaller than $0.001$.

We write:

> There is very strong evidence ($t = 5.43$; one-tailed $P < 0.001$) that the mean reduction in TG for the chamomile-tea drinking group is greater than the mean reduction in TG for the hot-water drinking group (difference between means: $45.74$\ mg.dl^-1^; approx. $95$% CI: $28.64$ to $62.84$\ mg.dl^-1^).

Again, the sample sizes are larger than $25$, so the results are statistically valid.


## Chapter summary {#Chap30-Summary}

To test a hypothesis about a difference between two population means $\mu_1 - \mu_2$, based on the value of the difference between two sample mean $\bar{x}_1 - \bar{x}_2$, *assume* the value of $\mu_1 - \mu_2$ in the null hypothesis to be true (usually zero).
Then, the difference between the sample means varies from sample to sample and, under certain statistical validity conditions, varies with an approximate normal distribution centred around the hypothesised value of $\mu_1 - \mu_2$, with a standard deviation of $\text{s.e.}(\bar{x}_1 - \bar{x}_2)$.
This distribution describes what values of the sample mean could be *expected* in the sample if the value of $\mu$ in the null hypothesis was true.
The *test statistic* is  
\[
   t = \frac{ (\bar{x}_1 - \bar{x}_2) - (\mu_1 - \mu_2)}{\text{s.e.}(\bar{x}_1 - \bar{x}_2)},
\]
where $\mu_1 - \mu_2$ is the hypothesised value given in the null hypothesis (usually zero).
This describes the *observations*.
The $t$-value is like a $z$-score, and so an approximate *$P$-value* is estimated using the [68--95--99.7 rule](#def:EmpiricalRule) or normal-distribution tables, which is how we weigh the evidence to determine if it is *consistent* with the assumption.


`r if (knitr::is_html_output()){
  'The following short video may help explain some of these concepts:'
}`


<div style="text-align:center;">
```{r}
htmltools::tags$video(src = "./videos/TwoMeans.mp4", 
                      width = "550", 
                      controls = "controls", 
                      loop = "loop", 
                      style = "padding:5px; border: 2px solid gray;")
```
</div>


## Quick review questions {#Chap30-QuickReview}

::: {.webex-check .webex-box}
A study [@lee2016effect] compared using a vegan ($n = 46$) and a conventional ($n = 47$) diet for $12$\ weeks, for a group of Koreans with Type\ II diabetes.
A summary of the data for iron levels are shown in Table\ \@ref(tab:VeganDiet).


```{r VeganDiet}
VeganDiet <- array( dim = c(3, 3))

rownames(VeganDiet) <- c("Vegan diet",
                         "Conventional diet", 
                         "Difference")
colnames(VeganDiet) <- c("Mean", 
                         "Standard deviation", 
                         "$n$")

VeganDiet[1, ] <- c(13.9, 2.3, 46)
VeganDiet[2, ] <- c(15.0, 2.7, 47)
VeganDiet[3, ] <- c(1.1, NA, NA)


if( knitr::is_latex_output() ) {
  kable(pad(VeganDiet,
            surroundMaths = TRUE,
            targetLength = c(4, 3, 2),
            digits = c(1, 1, 0)),
        format = "latex",
        longtable = FALSE,
        booktabs = TRUE,
        align = "c",
        escape = FALSE,
        caption = "Comparing the iron levels (mg) for subjects using a vegan or conventional diet for 12 weeks") %>%
   kable_styling(font_size = 8) %>%
   row_spec(0, bold = TRUE) %>%
   row_spec(3, italic = TRUE)
}

if( knitr::is_html_output() ) {
  kable(pad(VeganDiet,
            surroundMaths = TRUE,
            targetLength = c(4, 3, 2),
            digits = c(1, 1, 0)),
        format = "html",
        align = "c",
        longtable = FALSE,
        booktabs = TRUE,
        caption = "Comparing the iron levels (mg) for subjects using a vegan or conventional diet for 12 weeks")
}
```

1. The sample size is missing from the 'Difference' row. \tightlist
   What should the sample size in this row be?
`r if( knitr::is_html_output() ) {longmcq( c(
  "46 + 47 = 93",
  "46 - 47 = -1",
  "47 - 46 = 1",
  answer = "A sample size makes no sense",
  "There is not enough information"
)  )}`

1. What is the *standard deviation* for the difference?
`r if( knitr::is_html_output() ) {mcq( c(
  "0.3391",
  "0.3928",
  answer = "A standard deviation makes no sense",
  "There is not enough information"
)  )}`

1. What is the *standard error* for the difference?
`r if( knitr::is_html_output() ) {mcq( c(
  "0.3391",
  "0.3928",
  "A standard error makes no sense",
  answer = "There is not enough information"
)  )}`

1. The two-tailed $P$-value for the comparison is given as $P = 0.046$.
   What does this mean?
`r if( knitr::is_html_output() ) {longmcq( c(
  "There is no evidence that the sample means are different",
  "There is some evidence that the sample means are different",
  "There is no evidence that the population means are different",
  answer = "There is some evidence that the population means are different",
  "There is not enough information"
)  )}`
:::



## Exercises {#TestTwoMeansExercises}

Selected answers are available in Sect.\ \@ref(TestTwoMeansAnswer).


::: {.exercise #TwoSampleHTWhalesHT}
(These data were also seen in Exercise\ \@ref(exr:MeansIndSamplesExercisesWhalesCI).)
A study of gray whales (*Eschrichtius robustus*) measured (among other things) the length of adult whales [@agbayani2020growth].
Are adult female gray whales longer than males, on average, in the population?
Summary information is shown in Table\ \@ref(tab:WhaleInfoHT).



```{r WhaleInfoHT}
WhaleInfo <- array( dim = c(2, 3))
colnames(WhaleInfo) <- c("Mean",
                         "Std deviation",
                         "Sample size")
rownames(WhaleInfo) <- c("Female",
                         "Male")

WhaleInfo[1, ] <- c(4.66, 
                    0.379, 
                    26)
WhaleInfo[2, ] <- c(4.60, 
                    0.305,
                    30)

if( knitr::is_latex_output() ) {
  kable( pad(WhaleInfo,
             surroundMaths = TRUE,
             targetLength = c(4, 4, 2),
             digits = c(2, 2, 0)), 
         format = "latex",
         longtable = FALSE,
         booktabs = TRUE,
         escape = FALSE,
         align = "c",
         col.names = colnames(WhaleInfo),
         caption = "Numerical summary of length of whales at birth (in m)") %>%
    row_spec(0, 
             bold = TRUE) %>%
    kable_styling(font_size = 8)
    
}
if( knitr::is_html_output() ) {
  kable( pad(WhaleInfo,
             surroundMaths = TRUE,
             targetLength = c(4, 4, 2),
             digits = c(2, 2, 0)), 
         format = "html",
         longtable = FALSE,
         booktabs = TRUE,
         align = "c",
         col.names = colnames(WhaleInfo),
         caption = "Numerical summary of length of whales at birth (in m)") %>%
    kable_styling(full_width = FALSE)
}
```

1. Define the *difference*.
1. Write the hypotheses to answer the RQ.
1. Compute the $t$-score, and approximate the $P$-value using the 68--95--99.7 rule.
1. Write a conclusion.
1. Is the test likely to be statistically valid?
:::


::: {.exercise #TestTwoMeansNHANES}
Earlier, the NHANES study (Exercise\ \@ref(exr:CompareQuantExercisesNHANES)) was used to answer this RQ:

> Among Americans, is the mean direct HDL cholesterol different for current smokers and non-smokers?

Use the jamovi output in Fig.\ \@ref(fig:NHANESTest) to perform a hypothesis test to answer the RQ.
:::

   
```{r NHANESTest, fig.cap="jamovi output for the NHANES data", fig.align="center", out.width="85%"}
knitr::include_graphics("jamovi/NHANES/NHANES-DirectHDL-Smoke-ALL.png")
```

::: {.exercise #TestTwoMeansFitnessOfParamedics}
A study of male paramedics in Western Australia compared conventional paramedics with special operations paramedics [@data:chapman2007:MaleParamedics].
Some information comparing their physical profiles is shown in Table\ \@ref(tab:ParamedicsTest).

1. Compute the missing standard errors.
1. Consider comparing the mean grip strength for the two groups of paramedics.
   a. Carefully write down the hypotheses.
   b. Compute the $t$-score for testing if a difference exists between the two types of paramedics.
   c. Approximate the $P$-value using the  [68--95--99.7 rule](#def:EmpiricalRule).
   d. Discuss the conditions required for statistical validity in this context.
   e. Make a conclusion.
1. Consider comparing the mean number of push-ups completed in one minute. 
   The *standard error for the difference between the means* is $4.0689$. 
   a. Carefully write down the hypotheses.
   b. Compute the $t$-score for testing if a difference exists between the two types of paramedics.
   c. Approximate the $P$-value using the  [68--95--99.7 rule](#def:EmpiricalRule).
   d. Discuss the conditions required for statistical validity in this context.
   e. Make a conclusion.
:::


```{r ParamedicsTest}
ParaSummary <- array(dim = c(6, 2))
rownames(ParaSummary) <- c("Mean", 
                            "Std deviation",
                            "Std error",
                            "Mean", 
                            "Std deviation",
                            "Std error")
colnames(ParaSummary) <- c("Conventional", 
                            "Special Operations")
ParaSummary[1, ] <- c(51, 56)
ParaSummary[2, ] <- c(8, 9)
ParaSummary[3, ] <- c(NA, NA)
ParaSummary[4, ] <- c(36, 47)
ParaSummary[5, ] <- c(10, 11)
ParaSummary[6, ] <- c(NA, NA)
  

if( knitr::is_latex_output() ) {
  kable(pad(ParaSummary,
            surroundMaths = TRUE,
            targetLength = c(2, 2),
            digits = 0),
        format = "latex",
        longtable = FALSE,
        booktabs = TRUE,
        escape = FALSE,
	 #linesep = c("", "", "", "\\addlinespace", "", "", "", "\\addlinespace", "", "", "", ""), # Otherwise addes a space after five lines... 
        align = "c",
        caption = "The physical profile of conventional ($n=18$) and special operation ($n = 11$) paramedics in Western Australia"
  ) %>%
    row_spec(0, bold = TRUE) %>%
  kable_styling("striped", 
                full_width = F, 
                font_size=10) %>%
  pack_rows("Grip strength (in kg)", 1, 3) %>%
  pack_rows("Push-ups (per minutes)", 4, 6)
}
if( knitr::is_html_output() ) {
  kable(pad(ParaSummary,
            surroundMaths = TRUE,
            targetLength = c(2, 2),
            digits = 0),
        format = "html",
        longtable = FALSE,
        booktabs = TRUE,  
        align = "c",
        caption = "The physical profile of conventional ($n=18$) and special operation ($n = 11$) paramedics in Western Australia") %>%
    kable_styling(full_width = FALSE) %>%
    pack_rows("Grip strength (in kg)", 1, 3) %>%
    pack_rows("Push-ups (per minutes)", 4, 6)
}
```



::: {.exercise #TestTwoMeansBodyTemperature}
Consider again the body temperature data from Sect.\ \@ref(BodyTemperature).
The researchers also recorded the gender of the patients, as they also wanted to compare the mean internal body temperatures  for males and females.

Use the jamovi output in Fig.\ \@ref(fig:BodyTempGenderjamovi) to perform this test and make a conclusion.
Also comment on the practical significance of your results.
:::

```{r BodyTempGenderjamovi, fig.cap="jamovi output for the body-temperature data", fig.align="center", out.width="85%"}
knitr::include_graphics("jamovi/BodyTemp/BodyTempTestGender.png")
```


::: {.exercise #TestTwoMeansDental}
(These data were also seen in Exercise\ \@ref(exr:TestTwoMeansDentalCI).)
A study [@data:woodward:dental] examined the sugar consumption in industrialised (mean: $41.8$ kg/person/year) and non-industrialised (mean: $24.6$ kg/person/year) countries.
The jamovi output is shown in Fig.\ \@ref(fig:Dentaljamovi).

1. Write the hypotheses.
2. Write down and interpret the CI.
3. Write a conclusion for the hypothesis test.
:::


```{r Dentaljamovi, fig.cap="jamovi output for the sugar-consumption data", fig.align="center", out.width="85%"}
knitr::include_graphics("jamovi/Dental/WoodwardWalker1994-ttest.png")
```




::: {.exercise #DecelerationHT}
(These data were also seen in Exercise\ \@ref(exr:DecelerationCI).)
In an attempt to reduce vehicle speeds on freeway exit ramps, a Chinese study tried using additional signage [@ma2019impacts].
At one site studied (Ningxuan Freeway), speeds were recorded at various points on the freeway exit for vehicles *before* the extra signage was added, and then for different vehicles *after* the extra signage was added.

From this data, the *deceleration* of each vehicle was determined (data with Exercise\ \@ref(exr:DecelerationCI)) as the vehicle left the 120 km/h speed zone and approached the 80 km/hr speed zone. 
Use the data, and the summary in Table\ \@ref(tab:SignageSummaryDecHT), to test the RQ:

> At this freeway exit, is the mean vehicle deceleration the same before extra signage is added and after extra signage is added?
:::


```{r SignageDecHT}
data(Deceleration)

Deceleration$When <- factor(Deceleration$When,
                     levels = c("Before", 
                                "After"),
                     ordered = TRUE)
Decel2 <- data.frame( "Before" = head(Deceleration$Deceleration[Deceleration$When == "Before"], 
                                      n = 5),
                      "After" = head(Deceleration$Deceleration[Deceleration$When == "After"],
                                     n = 5) )
```


```{r SignageSummaryDecHT}
SignageSummaryDec <- array(dim = c(3, 4))
rownames(SignageSummaryDec) <- c("Before", 
                            "After",
                            "Change")
colnames(SignageSummaryDec) <- c("Mean",
                              "Std deviation",
                              "Std error",
                              "Sample size")

Speed.n <- tapply(Deceleration$Deceleration, 
                  list(Deceleration$When), 
                  "length") 
Speed.sd <- tapply(Deceleration$Deceleration, 
                   list(Deceleration$When), 
                   "sd") 

SignageSummaryDec[1:2, 1] <- round( tapply(Deceleration$Deceleration, 
                                        list(Deceleration$When), 
                                        "mean"),
                                 4)
SignageSummaryDec[1:2, 2] <- round( Speed.sd, 4)
SignageSummaryDec[1:2, 3] <- round( Speed.sd / sqrt(Speed.n), 5)
SignageSummaryDec[1:2, 4] <- Speed.n 

SignageSummaryDec[3, 1] <- SignageSummaryDec[1, 1] -  
                           SignageSummaryDec[2, 1] 

sdB <- round( SignageSummaryDec[1, 3], 4)
sdA <- round( SignageSummaryDec[2, 3], 4)
SignageSummaryDec[3, 3] <- round( sqrt( sdB^2/Speed.n[1] + 
                                     sdA^2/Speed.n[2] ), 
                               5)

SignageSummaryDec[3, 4] <- NA 
SignageSummaryDec[3, 2] <- NA
                          


if( knitr::is_latex_output() ) {
  kable(pad(SignageSummaryDec,
            surroundMaths = TRUE,
            targetLength = c(7, 6, 7, 2),
            digits = c(4, 4, 5, 0)),
        format = "latex",
        longtable = FALSE,
        booktabs = TRUE,
        escape = FALSE,
        align = "c",
        col.names = c("Mean", 
                      "Std deviation", 
                      "Sample size", 
                      "Std error"),
        caption = "The signage data summary (in m/s-squared)"
  ) %>%
  row_spec(0, bold = TRUE) %>%
  row_spec(3, italic = TRUE) %>%
  kable_styling(font_size = 8)
}
if( knitr::is_html_output() ) {
  kable(pad(SignageSummaryDec,
            surroundMaths = TRUE,
            targetLength = c(7, 6, 7, 2),
            digits = c(4, 4, 5, 0)),
               format = "html",
               longtable = FALSE,
               booktabs = TRUE,
               align ="c",
               col.names = c("Mean", 
                            "Std deviation", 
                            "Sample size", 
                            "Std error"),
    caption = "The signage data summary (in m/s-squared)") %>%
    kable_styling(full_width = FALSE)
}
```


::: {.exercise #FacePlantHT}
(This study was seen in Exercise\ \@ref(exr:FacePlantCI).)
A study [@data:Wojcik:ForwardFall] compared the lean-forward angle in younger and older women.
An elaborate set-up was constructed to measure this lean-forward angle, using harnesses.
Consider this RQ:

> Among healthy women, is the mean lean-forward angle *greater* for younger women compared to older women?

Use the software output (Fig.\ \@ref(fig:FallFowardTTestTestjamovi)) to answer these questions:

1. What is the parameter?
   Carefully describe what it means.
2. Is the test one- or two-tailed?
3. Write the statistical hypothesis.
4. Use the jamovi output to conduct the hypothesis test.
5. Write a conclusion.
:::

  
```{r FallFowardTTestTestjamovi, fig.cap="jamovi output for the face-plant data", fig.align="center", out.width="95%"}
knitr::include_graphics("jamovi/FallForward/FallForwardTTestOutput-All.png")
```



::: {.exercise #BHADPHT}
(This study was seen in Exercise\ \@ref(exr:BHADPCI).)
A study [@data:Becker1991:BHADP] compared the access to health promotion (HP) services for people with and without a disability in southwestern of the USA.
'Access' was measured using the quantitative
`r if (knitr::is_latex_output()) {
   '*Barriers to Health Promoting Activities for Disabled Persons*  (BHADP) scale.'
} else {
   '*Barriers to Health Promoting Activities for Disabled Persons*  [(BHADP) scale](http://www.utexas.edu/nursing/chpr/resources/bhadp.html).'
}`
*Higher* scores mean *greater* barriers to health promotion services.
The RQ is:

> What is the difference between the mean BHADP scores, for people with and without a disability, in southwestern USA?

1. Write down the hypotheses.
2. Compute the $t$-score.
3. Determine the $P$-value.
4. Write a conclusion.
:::




<!-- QUICK REVIEW ANSWERS -->
`r if (knitr::is_html_output()) '<!--'`
::: {.EOCanswerBox .EOCanswer data-latex="{iconmonstr-check-mark-14-240.png}"}
**Answers to in-chapter questions:**

\textbf{\textit{Quick Revision} questions:}
**1.** A sample size makes no sense.
**2.** A standard deviation makes no sense
**3.** There is not enough information.
**4.** There is some evidence that the population means are different.
:::
`r if (knitr::is_html_output()) '-->'`

